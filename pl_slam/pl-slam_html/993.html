<html><head><title>nanoflann.hpp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link rel="stylesheet" type="text/css" href="sourcestyles.css" />
</head><body link="blue" vlink="blue">
<h3>File: /media/zhijian/Document/grow/slam/PL_SLAM/pl_slam/include/mrpt/otherlibs/nanoflann/nanoflann.hpp</h3>
<SCRIPT>
defaultStatus = "File: /media/zhijian/Document/grow/slam/PL_SLAM/pl_slam/include/mrpt/otherlibs/nanoflann/nanoflann.hpp";
top.document.title  = "nanoflann.hpp";
</SCRIPT>
<pre><span class="default"></span><a name="1"><font size=-1>1     </font></a><span class="default"></span><span class="comment">/***********************************************************************</span>
<a name="2"><font size=-1>2     </font></a><span class="comment"> * Software License Agreement (BSD License)</span>
<a name="3"><font size=-1>3     </font></a><span class="comment"> *</span>
<a name="4"><font size=-1>4     </font></a><span class="comment"> * Copyright 2008-2009  Marius Muja (mariusm@cs.ubc.ca). All rights reserved.</span>
<a name="5"><font size=-1>5     </font></a><span class="comment"> * Copyright 2008-2009  David G. Lowe (lowe@cs.ubc.ca). All rights reserved.</span>
<a name="6"><font size=-1>6     </font></a><span class="comment"> * Copyright 2011-2016  Jose Luis Blanco (joseluisblancoc@gmail.com).</span>
<a name="7"><font size=-1>7     </font></a><span class="comment"> *   All rights reserved.</span>
<a name="8"><font size=-1>8     </font></a><span class="comment"> *</span>
<a name="9"><font size=-1>9     </font></a><span class="comment"> * THE BSD LICENSE</span>
<a name="10"><font size=-1>10     </font></a><span class="comment"> *</span>
<a name="11"><font size=-1>11     </font></a><span class="comment"> * Redistribution and use in source and binary forms, with or without</span>
<a name="12"><font size=-1>12     </font></a><span class="comment"> * modification, are permitted provided that the following conditions</span>
<a name="13"><font size=-1>13     </font></a><span class="comment"> * are met:</span>
<a name="14"><font size=-1>14     </font></a><span class="comment"> *</span>
<a name="15"><font size=-1>15     </font></a><span class="comment"> * 1. Redistributions of source code must retain the above copyright</span>
<a name="16"><font size=-1>16     </font></a><span class="comment"> *    notice, this list of conditions and the following disclaimer.</span>
<a name="17"><font size=-1>17     </font></a><span class="comment"> * 2. Redistributions in binary form must reproduce the above copyright</span>
<a name="18"><font size=-1>18     </font></a><span class="comment"> *    notice, this list of conditions and the following disclaimer in the</span>
<a name="19"><font size=-1>19     </font></a><span class="comment"> *    documentation and/or other materials provided with the distribution.</span>
<a name="20"><font size=-1>20     </font></a><span class="comment"> *</span>
<a name="21"><font size=-1>21     </font></a><span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR</span>
<a name="22"><font size=-1>22     </font></a><span class="comment"> * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES</span>
<a name="23"><font size=-1>23     </font></a><span class="comment"> * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="24"><font size=-1>24     </font></a><span class="comment"> * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,</span>
<a name="25"><font size=-1>25     </font></a><span class="comment"> * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT</span>
<a name="26"><font size=-1>26     </font></a><span class="comment"> * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span>
<a name="27"><font size=-1>27     </font></a><span class="comment"> * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span>
<a name="28"><font size=-1>28     </font></a><span class="comment"> * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<a name="29"><font size=-1>29     </font></a><span class="comment"> * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF</span>
<a name="30"><font size=-1>30     </font></a><span class="comment"> * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="31"><font size=-1>31     </font></a><span class="comment"> *************************************************************************/</span>
<a name="32"><font size=-1>32     </font></a><span class="comment"></span>
<a name="33"><font size=-1>33     </font></a><span class="comment">/** \mainpage nanoflann C++ API documentation</span>
<a name="34"><font size=-1>34     </font></a><span class="comment">  *  nanoflann is a C++ header-only library for building KD-Trees, mostly</span>
<a name="35"><font size=-1>35     </font></a><span class="comment">  *  optimized for 2D or 3D point clouds.</span>
<a name="36"><font size=-1>36     </font></a><span class="comment">  *</span>
<a name="37"><font size=-1>37     </font></a><span class="comment">  *  nanoflann does not require compiling or installing, just an</span>
<a name="38"><font size=-1>38     </font></a><span class="comment">  *  #include &lt;nanoflann.hpp&gt; in your code.</span>
<a name="39"><font size=-1>39     </font></a><span class="comment">  *</span>
<a name="40"><font size=-1>40     </font></a><span class="comment">  *  See:</span>
<a name="41"><font size=-1>41     </font></a><span class="comment">  *   - &lt;a href=&quot;modules.html&quot; &gt;C++ API organized by modules&lt;/a&gt;</span>
<a name="42"><font size=-1>42     </font></a><span class="comment">  *   - &lt;a href=&quot;https://github.com/jlblancoc/nanoflann&quot; &gt;Online README&lt;/a&gt;</span>
<a name="43"><font size=-1>43     </font></a><span class="comment">  *   - &lt;a href=&quot;http://jlblancoc.github.io/nanoflann/&quot; &gt;Doxygen documentation&lt;/a&gt;</span>
<a name="44"><font size=-1>44     </font></a><span class="comment">  */</span>
<a name="45"><font size=-1>45     </font></a><span class="comment"></span>
<a name="46"><font size=-1>46     </font></a><span class="comment"></span><span class="preproc">#ifndef  <a href="dictionary_N.html#17554">NANOFLANN_HPP_</a></span>
<a name="47"><font size=-1>47     </font></a><span class="preproc">#define  <a href="dictionary_N.html#17554">NANOFLANN_HPP_</a></span>
<a name="48"><font size=-1>48     </font></a><span class="preproc"></span>
<a name="49"><font size=-1>49     </font></a><span class="preproc">#include </span><span class="string">&lt;vector&gt;</span>
<a name="50"><font size=-1>50     </font></a><span class="string"></span><span class="preproc">#include </span><span class="string">&lt;cassert&gt;</span>
<a name="51"><font size=-1>51     </font></a><span class="string"></span><span class="preproc">#include </span><span class="string">&lt;algorithm&gt;</span>
<a name="52"><font size=-1>52     </font></a><span class="string"></span><span class="preproc">#include </span><span class="string">&lt;stdexcept&gt;</span>
<a name="53"><font size=-1>53     </font></a><span class="string"></span><span class="preproc">#include </span><span class="string">&lt;cstdio&gt;  </span><span class="comment">// for fwrite()</span>
<a name="54"><font size=-1>54     </font></a><span class="comment"></span><span class="preproc">#include </span><span class="string">&lt;cmath&gt;   </span><span class="comment">// for abs()</span>
<a name="55"><font size=-1>55     </font></a><span class="comment"></span><span class="preproc">#include </span><span class="string">&lt;cstdlib&gt; </span><span class="comment">// for abs()</span>
<a name="56"><font size=-1>56     </font></a><span class="comment"></span><span class="preproc">#include </span><span class="string">&lt;limits&gt;</span>
<a name="57"><font size=-1>57     </font></a><span class="string"></span>
<a name="58"><font size=-1>58     </font></a><span class="string"></span><span class="comment">// Avoid conflicting declaration of min/max macros in windows headers</span>
<a name="59"><font size=-1>59     </font></a><span class="comment"></span><span class="preproc">#if </span><span class="default">!</span><span class="preproc">defined</span><span class="default">(<a href="dictionary_N.html#6695">NOMINMAX</a>) &amp;&amp; (</span><span class="preproc">defined</span><span class="default">(<a href="dictionary_Non-Alpha.html#995">_WIN32</a>) || </span><span class="preproc">defined</span><span class="default">(<a href="dictionary_Non-Alpha.html#17555">_WIN32_</a>)  || </span><span class="preproc">defined</span><span class="default">(<a href="dictionary_W.html#994">WIN32</a>) || </span><span class="preproc">defined</span><span class="default">(<a href="dictionary_Non-Alpha.html#998">_WIN64</a>))</span>
<a name="60"><font size=-1>60     </font></a><span class="default"></span><span class="preproc"># define <a href="dictionary_N.html#6695">NOMINMAX</a></span>
<a name="61"><font size=-1>61     </font></a><span class="preproc"># ifdef <a href="dictionary_M.html#6697">max</a></span>
<a name="62"><font size=-1>62     </font></a><span class="preproc">#  undef   <a href="dictionary_M.html#6697">max</a></span>
<a name="63"><font size=-1>63     </font></a><span class="preproc">#  undef   <a href="dictionary_M.html#6698">min</a></span>
<a name="64"><font size=-1>64     </font></a><span class="preproc"># endif</span>
<a name="65"><font size=-1>65     </font></a><span class="preproc">#endif</span>
<a name="66"><font size=-1>66     </font></a><span class="preproc"></span>
<a name="67"><font size=-1>67     </font></a><span class="preproc"></span><span class="keyword">namespace </span><span class="default">nanoflann</span>
<a name="68"><font size=-1>68     </font></a><span class="default">{</span>
<a name="69"><font size=-1>69     </font></a><span class="default"></span><span class="comment">/** @addtogroup nanoflann_grp nanoflann C++ library for ANN</span>
<a name="70"><font size=-1>70     </font></a><span class="comment">  *  @{ */</span>
<a name="71"><font size=-1>71     </font></a><span class="comment"></span>
<a name="72"><font size=-1>72     </font></a><span class="comment">  	/** Library version: 0xMmP (M=Major,m=minor,P=patch) */</span>
<a name="73"><font size=-1>73     </font></a><span class="comment">	</span><span class="preproc">#define <a href="dictionary_N.html#17557">NANOFLANN_VERSION</a> </span><span class="number">0x121</span>
<a name="74"><font size=-1>74     </font></a><span class="number"></span>
<a name="75"><font size=-1>75     </font></a><span class="number">	</span><span class="comment">/** @addtogroup result_sets_grp Result set classes</span>
<a name="76"><font size=-1>76     </font></a><span class="comment">	  *  @{ */</span>
<a name="77"><font size=-1>77     </font></a><span class="comment">	</span><span class="keyword">template </span><span class="default">&lt;</span><span class="keyword">typename <a href="dictionary_N.html#17559">DistanceType</a></span><span class="default">, </span><span class="keyword">typename <a href="dictionary_N.html#17560">IndexType</a> </span><span class="default">= size_t, </span><span class="keyword">typename <a href="dictionary_N.html#17561">CountType</a> </span><span class="default">= size_t&gt;</span>
<a name="78"><font size=-1>78     </font></a><span class="default">	</span><span class="keyword">class <a href="dictionary_N.html#17558">KNNResultSet</a></span>
<a name="79"><font size=-1>79     </font></a><span class="keyword">	</span><span class="default">{</span>
<a name="80"><font size=-1>80     </font></a><span class="default">		<a href="dictionary_N.html#17560">IndexType</a> * <a href="dictionary_N.html#17562">indices</a>;</span>
<a name="81"><font size=-1>81     </font></a><span class="default">		<a href="dictionary_N.html#17559">DistanceType</a>* <a href="dictionary_N.html#17563">dists</a>;</span>
<a name="82"><font size=-1>82     </font></a><span class="default">		<a href="dictionary_N.html#17561">CountType</a> <a href="dictionary_N.html#17564">capacity</a>;</span>
<a name="83"><font size=-1>83     </font></a><span class="default">		<a href="dictionary_N.html#17561">CountType</a> <a href="dictionary_N.html#17565">count</a>;</span>
<a name="84"><font size=-1>84     </font></a><span class="default"></span>
<a name="85"><font size=-1>85     </font></a><span class="default">	</span><span class="keyword">public</span><span class="default">:</span>
<a name="86"><font size=-1>86     </font></a><span class="default">		</span><span class="keyword">inline <a href="dictionary_N.html#17566">KNNResultSet</a></span><span class="default">(<a href="dictionary_N.html#17561">CountType</a> <a href="dictionary_C.html#17567">capacity_</a>) : <a href="dictionary_N.html#17562">indices</a>(</span><span class="number">0</span><span class="default">), <a href="dictionary_N.html#17563">dists</a>(</span><span class="number">0</span><span class="default">), <a href="dictionary_N.html#17564">capacity</a>(<a href="dictionary_C.html#17567">capacity_</a>), <a href="dictionary_N.html#17565">count</a>(</span><span class="number">0</span><span class="default">)</span>
<a name="87"><font size=-1>87     </font></a><span class="default">		{</span>
<a name="88"><font size=-1>88     </font></a><span class="default">		}</span>
<a name="89"><font size=-1>89     </font></a><span class="default"></span>
<a name="90"><font size=-1>90     </font></a><span class="default">		</span><span class="keyword">inline void <a href="dictionary_N.html#17568">init</a></span><span class="default">(<a href="dictionary_N.html#17560">IndexType</a>* <a href="dictionary_I.html#17569">indices_</a>, <a href="dictionary_N.html#17559">DistanceType</a>* <a href="dictionary_D.html#17570">dists_</a>)</span>
<a name="91"><font size=-1>91     </font></a><span class="default">		{</span>
<a name="92"><font size=-1>92     </font></a><span class="default">			<a href="dictionary_N.html#17562">indices</a> = <a href="dictionary_I.html#17569">indices_</a>;</span>
<a name="93"><font size=-1>93     </font></a><span class="default">			<a href="dictionary_N.html#17563">dists</a> = <a href="dictionary_D.html#17570">dists_</a>;</span>
<a name="94"><font size=-1>94     </font></a><span class="default">			<a href="dictionary_N.html#17565">count</a> = </span><span class="number">0</span><span class="default">;</span>
<a name="95"><font size=-1>95     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_N.html#17564">capacity</a>)</span>
<a name="96"><font size=-1>96     </font></a><span class="default">                <a href="dictionary_N.html#17563">dists</a>[<a href="dictionary_N.html#17564">capacity</a>-</span><span class="number">1</span><span class="default">] = (std::<a href="dictionary_N.html#6017">numeric_limits</a>&lt;DistanceType&gt;::<a href="dictionary_N.html#17578">max</a>)();</span>
<a name="97"><font size=-1>97     </font></a><span class="default">		}</span>
<a name="98"><font size=-1>98     </font></a><span class="default"></span>
<a name="99"><font size=-1>99     </font></a><span class="default">		</span><span class="keyword">inline <a href="dictionary_N.html#17561">CountType</a> <a href="dictionary_N.html#17571">size</a></span><span class="default">() </span><span class="keyword">const</span>
<a name="100"><font size=-1>100     </font></a><span class="keyword">		</span><span class="default">{</span>
<a name="101"><font size=-1>101     </font></a><span class="default">			</span><span class="keyword">return <a href="dictionary_N.html#17565">count</a></span><span class="default">;</span>
<a name="102"><font size=-1>102     </font></a><span class="default">		}</span>
<a name="103"><font size=-1>103     </font></a><span class="default"></span>
<a name="104"><font size=-1>104     </font></a><span class="default">		</span><span class="keyword">inline bool <a href="dictionary_N.html#17572">full</a></span><span class="default">() </span><span class="keyword">const</span>
<a name="105"><font size=-1>105     </font></a><span class="keyword">		</span><span class="default">{</span>
<a name="106"><font size=-1>106     </font></a><span class="default">			</span><span class="keyword">return <a href="dictionary_N.html#17565">count</a> </span><span class="default">== <a href="dictionary_N.html#17564">capacity</a>;</span>
<a name="107"><font size=-1>107     </font></a><span class="default">		}</span>
<a name="108"><font size=-1>108     </font></a><span class="default"></span>
<a name="109"><font size=-1>109     </font></a><span class="default"></span>
<a name="110"><font size=-1>110     </font></a><span class="default">		</span><span class="keyword">inline void <a href="dictionary_N.html#17573">addPoint</a></span><span class="default">(<a href="dictionary_N.html#17559">DistanceType</a> <a href="dictionary_D.html#17574">dist</a>, <a href="dictionary_N.html#17560">IndexType</a> <a href="dictionary_I.html#17575">index</a>)</span>
<a name="111"><font size=-1>111     </font></a><span class="default">		{</span>
<a name="112"><font size=-1>112     </font></a><span class="default">			<a href="dictionary_N.html#17561">CountType</a> <a href="dictionary_I.html#17579">i</a>;</span>
<a name="113"><font size=-1>113     </font></a><span class="default">			</span><span class="keyword">for </span><span class="default">(<a href="dictionary_I.html#17579">i</a>=<a href="dictionary_N.html#17565">count</a>; <a href="dictionary_I.html#17579">i</a>&gt;</span><span class="number">0</span><span class="default">; --<a href="dictionary_I.html#17579">i</a>) {</span>
<a name="114"><font size=-1>114     </font></a><span class="default"></span><span class="preproc">#ifdef <a href="dictionary_N.html#17576">NANOFLANN_FIRST_MATCH</a>   </span><span class="comment">// If defined and two points have the same distance, the one with the lowest-index will be returned first.</span>
<a name="115"><font size=-1>115     </font></a><span class="comment">				</span><span class="keyword">if </span><span class="default">( (<a href="dictionary_N.html#17563">dists</a>[<a href="dictionary_I.html#14196">i</a>-</span><span class="number">1</span><span class="default">]&gt;<a href="dictionary_D.html#17574">dist</a>) || ((<a href="dictionary_D.html#17574">dist</a>==<a href="dictionary_N.html#17563">dists</a>[<a href="dictionary_I.html#14196">i</a>-</span><span class="number">1</span><span class="default">])&amp;&amp;(<a href="dictionary_N.html#17562">indices</a>[<a href="dictionary_I.html#14196">i</a>-</span><span class="number">1</span><span class="default">]&gt;<a href="dictionary_I.html#17575">index</a>)) ) {</span>
<a name="116"><font size=-1>116     </font></a><span class="default"></span><span class="preproc">#else</span>
<a name="117"><font size=-1>117     </font></a><span class="preproc">				</span><span class="keyword">if </span><span class="default">(<a href="dictionary_N.html#17563">dists</a>[<a href="dictionary_I.html#17579">i</a>-</span><span class="number">1</span><span class="default">]&gt;<a href="dictionary_D.html#17574">dist</a>) {</span>
<a name="118"><font size=-1>118     </font></a><span class="default"></span><span class="preproc">#endif</span>
<a name="119"><font size=-1>119     </font></a><span class="preproc">					</span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#17579">i</a>&lt;<a href="dictionary_N.html#17564">capacity</a>) {</span>
<a name="120"><font size=-1>120     </font></a><span class="default">						<a href="dictionary_N.html#17563">dists</a>[<a href="dictionary_I.html#17579">i</a>] = <a href="dictionary_N.html#17563">dists</a>[<a href="dictionary_I.html#17579">i</a>-</span><span class="number">1</span><span class="default">];</span>
<a name="121"><font size=-1>121     </font></a><span class="default">						<a href="dictionary_N.html#17562">indices</a>[<a href="dictionary_I.html#17579">i</a>] = <a href="dictionary_N.html#17562">indices</a>[<a href="dictionary_I.html#17579">i</a>-</span><span class="number">1</span><span class="default">];</span>
<a name="122"><font size=-1>122     </font></a><span class="default">					}</span>
<a name="123"><font size=-1>123     </font></a><span class="default">				}</span>
<a name="124"><font size=-1>124     </font></a><span class="default">				</span><span class="keyword">else break</span><span class="default">;</span>
<a name="125"><font size=-1>125     </font></a><span class="default">			}</span>
<a name="126"><font size=-1>126     </font></a><span class="default">			</span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#17579">i</a>&lt;<a href="dictionary_N.html#17564">capacity</a>) {</span>
<a name="127"><font size=-1>127     </font></a><span class="default">				<a href="dictionary_N.html#17563">dists</a>[<a href="dictionary_I.html#17579">i</a>] = <a href="dictionary_D.html#17574">dist</a>;</span>
<a name="128"><font size=-1>128     </font></a><span class="default">				<a href="dictionary_N.html#17562">indices</a>[<a href="dictionary_I.html#17579">i</a>] = <a href="dictionary_I.html#17575">index</a>;</span>
<a name="129"><font size=-1>129     </font></a><span class="default">			}</span>
<a name="130"><font size=-1>130     </font></a><span class="default">			</span><span class="keyword">if </span><span class="default">(<a href="dictionary_N.html#17565">count</a>&lt;<a href="dictionary_N.html#17564">capacity</a>) <a href="dictionary_N.html#17565">count</a>++;</span>
<a name="131"><font size=-1>131     </font></a><span class="default">		}</span>
<a name="132"><font size=-1>132     </font></a><span class="default"></span>
<a name="133"><font size=-1>133     </font></a><span class="default">		</span><span class="keyword">inline <a href="dictionary_N.html#17559">DistanceType</a> <a href="dictionary_N.html#17577">worstDist</a></span><span class="default">() </span><span class="keyword">const</span>
<a name="134"><font size=-1>134     </font></a><span class="keyword">		</span><span class="default">{</span>
<a name="135"><font size=-1>135     </font></a><span class="default">			</span><span class="keyword">return <a href="dictionary_N.html#17563">dists</a></span><span class="default">[<a href="dictionary_N.html#17564">capacity</a>-</span><span class="number">1</span><span class="default">];</span>
<a name="136"><font size=-1>136     </font></a><span class="default">		}</span>
<a name="137"><font size=-1>137     </font></a><span class="default">	};</span>
<a name="138"><font size=-1>138     </font></a><span class="default"></span>
<a name="139"><font size=-1>139     </font></a><span class="default"></span>
<a name="140"><font size=-1>140     </font></a><span class="default">	</span><span class="comment">/**</span>
<a name="141"><font size=-1>141     </font></a><span class="comment">	 * A result-set class used when performing a radius based search.</span>
<a name="142"><font size=-1>142     </font></a><span class="comment">	 */</span>
<a name="143"><font size=-1>143     </font></a><span class="comment">	</span><span class="keyword">template </span><span class="default">&lt;</span><span class="keyword">typename <a href="dictionary_N.html#17581">DistanceType</a></span><span class="default">, </span><span class="keyword">typename <a href="dictionary_N.html#17582">IndexType</a> </span><span class="default">= size_t&gt;</span>
<a name="144"><font size=-1>144     </font></a><span class="default">	</span><span class="keyword">class <a href="dictionary_N.html#17580">RadiusResultSet</a></span>
<a name="145"><font size=-1>145     </font></a><span class="keyword">	</span><span class="default">{</span>
<a name="146"><font size=-1>146     </font></a><span class="default">	</span><span class="keyword">public</span><span class="default">:</span>
<a name="147"><font size=-1>147     </font></a><span class="default">		</span><span class="keyword">const <a href="dictionary_N.html#17581">DistanceType</a> <a href="dictionary_N.html#17583">radius</a></span><span class="default">;</span>
<a name="148"><font size=-1>148     </font></a><span class="default"></span>
<a name="149"><font size=-1>149     </font></a><span class="default">		std::<a href="dictionary_S.html#74">vector</a>&lt;std::pair&lt;IndexType,DistanceType&gt; &gt;&amp; <a href="dictionary_N.html#17584">m_indices_dists</a>;</span>
<a name="150"><font size=-1>150     </font></a><span class="default"></span>
<a name="151"><font size=-1>151     </font></a><span class="default">		</span><span class="keyword">inline <a href="dictionary_N.html#17585">RadiusResultSet</a></span><span class="default">(<a href="dictionary_N.html#17581">DistanceType</a> <a href="dictionary_R.html#17586">radius_</a>, std::<a href="dictionary_S.html#74">vector</a>&lt;std::pair&lt;IndexType,DistanceType&gt; &gt;&amp; <a href="dictionary_I.html#17587">indices_dists</a>) : <a href="dictionary_N.html#17583">radius</a>(<a href="dictionary_R.html#17586">radius_</a>), <a href="dictionary_N.html#17584">m_indices_dists</a>(<a href="dictionary_I.html#17587">indices_dists</a>)</span>
<a name="152"><font size=-1>152     </font></a><span class="default">		{</span>
<a name="153"><font size=-1>153     </font></a><span class="default">			<a href="dictionary_N.html#17589">init</a>();</span>
<a name="154"><font size=-1>154     </font></a><span class="default">		}</span>
<a name="155"><font size=-1>155     </font></a><span class="default"></span>
<a name="156"><font size=-1>156     </font></a><span class="default">		</span><span class="keyword">inline </span><span class="default">~<a href="dictionary_N.html#17588">RadiusResultSet</a>() { }</span>
<a name="157"><font size=-1>157     </font></a><span class="default"></span>
<a name="158"><font size=-1>158     </font></a><span class="default">		</span><span class="keyword">inline void <a href="dictionary_N.html#17589">init</a></span><span class="default">() { <a href="dictionary_N.html#17590">clear</a>(); }</span>
<a name="159"><font size=-1>159     </font></a><span class="default">		</span><span class="keyword">inline void <a href="dictionary_N.html#17590">clear</a></span><span class="default">() { <a href="dictionary_N.html#17584">m_indices_dists</a>.<a href="dictionary_C.html#142">clear</a>(); }</span>
<a name="160"><font size=-1>160     </font></a><span class="default"></span>
<a name="161"><font size=-1>161     </font></a><span class="default">		</span><span class="keyword">inline <a href="dictionary_S.html#56">size_t</a> <a href="dictionary_N.html#17591">size</a></span><span class="default">() </span><span class="keyword">const </span><span class="default">{ </span><span class="keyword">return <a href="dictionary_N.html#17584">m_indices_dists</a></span><span class="default">.<a href="dictionary_S.html#442">size</a>(); }</span>
<a name="162"><font size=-1>162     </font></a><span class="default"></span>
<a name="163"><font size=-1>163     </font></a><span class="default">		</span><span class="keyword">inline bool <a href="dictionary_N.html#17592">full</a></span><span class="default">() </span><span class="keyword">const </span><span class="default">{ </span><span class="keyword">return true</span><span class="default">; }</span>
<a name="164"><font size=-1>164     </font></a><span class="default"></span>
<a name="165"><font size=-1>165     </font></a><span class="default">		</span><span class="keyword">inline void <a href="dictionary_N.html#17593">addPoint</a></span><span class="default">(<a href="dictionary_N.html#17581">DistanceType</a> <a href="dictionary_D.html#17594">dist</a>, <a href="dictionary_N.html#17582">IndexType</a> <a href="dictionary_I.html#17595">index</a>)</span>
<a name="166"><font size=-1>166     </font></a><span class="default">		{</span>
<a name="167"><font size=-1>167     </font></a><span class="default">			</span><span class="keyword">if </span><span class="default">(<a href="dictionary_D.html#17594">dist</a>&lt;<a href="dictionary_N.html#17583">radius</a>)</span>
<a name="168"><font size=-1>168     </font></a><span class="default">				<a href="dictionary_N.html#17584">m_indices_dists</a>.<a href="dictionary_P.html#1599">push_back</a>(std::<a href="dictionary_S.html#5195">make_pair</a>(<a href="dictionary_I.html#17595">index</a>,<a href="dictionary_D.html#17594">dist</a>));</span>
<a name="169"><font size=-1>169     </font></a><span class="default">		}</span>
<a name="170"><font size=-1>170     </font></a><span class="default"></span>
<a name="171"><font size=-1>171     </font></a><span class="default">		</span><span class="keyword">inline <a href="dictionary_N.html#17581">DistanceType</a> <a href="dictionary_N.html#17596">worstDist</a></span><span class="default">() </span><span class="keyword">const </span><span class="default">{ </span><span class="keyword">return <a href="dictionary_N.html#17583">radius</a></span><span class="default">; }</span>
<a name="172"><font size=-1>172     </font></a><span class="default"></span>
<a name="173"><font size=-1>173     </font></a><span class="default">		</span><span class="comment">/** Clears the result set and adjusts the search radius. */</span>
<a name="174"><font size=-1>174     </font></a><span class="comment">		</span><span class="keyword">inline void <a href="dictionary_N.html#17597">set_radius_and_clear</a></span><span class="default">( </span><span class="keyword">const <a href="dictionary_N.html#17581">DistanceType</a> <a href="dictionary_R.html#17598">r</a> </span><span class="default">)</span>
<a name="175"><font size=-1>175     </font></a><span class="default">		{</span>
<a name="176"><font size=-1>176     </font></a><span class="default">			<a href="dictionary_N.html#17583">radius</a> = <a href="dictionary_R.html#17598">r</a>;</span>
<a name="177"><font size=-1>177     </font></a><span class="default">			<a href="dictionary_N.html#17590">clear</a>();</span>
<a name="178"><font size=-1>178     </font></a><span class="default">		}</span>
<a name="179"><font size=-1>179     </font></a><span class="default"></span>
<a name="180"><font size=-1>180     </font></a><span class="default">		</span><span class="comment">/**</span>
<a name="181"><font size=-1>181     </font></a><span class="comment">		 * Find the worst result (furtherest neighbor) without copying or sorting</span>
<a name="182"><font size=-1>182     </font></a><span class="comment">		 * Pre-conditions: size() &gt; 0</span>
<a name="183"><font size=-1>183     </font></a><span class="comment">		 */</span>
<a name="184"><font size=-1>184     </font></a><span class="comment">		</span><span class="default">std::<a href="dictionary_S.html#4856">pair</a>&lt;IndexType,DistanceType&gt; <a href="dictionary_N.html#17599">worst_item</a>() </span><span class="keyword">const</span>
<a name="185"><font size=-1>185     </font></a><span class="keyword">		</span><span class="default">{</span>
<a name="186"><font size=-1>186     </font></a><span class="default">		   </span><span class="keyword">if </span><span class="default">(<a href="dictionary_N.html#17584">m_indices_dists</a>.<a href="dictionary_E.html#160">empty</a>()) </span><span class="keyword">throw </span><span class="default">std::<a href="dictionary_S.html#713">runtime_error</a>(</span><span class="string">&quot;Cannot invoke RadiusResultSet::worst_item() on an empty list of results.&quot;</span><span class="default">);</span>
<a name="187"><font size=-1>187     </font></a><span class="default">		   </span><span class="keyword">typedef typename </span><span class="default">std::<a href="dictionary_V.html#45">vector</a>&lt;std::pair&lt;IndexType,DistanceType&gt; &gt;::<a href="dictionary_V.html#1596">const_iterator</a> <a href="dictionary_D.html#17600">DistIt</a>;</span>
<a name="188"><font size=-1>188     </font></a><span class="default">		   <a href="dictionary_D.html#17600">DistIt</a> <a href="dictionary_I.html#17601">it</a> = std::<a href="dictionary_S.html#17602">max_element</a>(<a href="dictionary_N.html#17584">m_indices_dists</a>.<a href="dictionary_B.html#448">begin</a>(), <a href="dictionary_N.html#17584">m_indices_dists</a>.<a href="dictionary_E.html#449">end</a>());</span>
<a name="189"><font size=-1>189     </font></a><span class="default">		   </span><span class="keyword">return </span><span class="default">*<a href="dictionary_I.html#17601">it</a>;</span>
<a name="190"><font size=-1>190     </font></a><span class="default">		}</span>
<a name="191"><font size=-1>191     </font></a><span class="default">	};</span>
<a name="192"><font size=-1>192     </font></a><span class="default"></span>
<a name="193"><font size=-1>193     </font></a><span class="default">	</span><span class="comment">/** operator &quot;&lt;&quot; for std::sort() */</span>
<a name="194"><font size=-1>194     </font></a><span class="comment">	</span><span class="keyword">struct <a href="dictionary_N.html#17603">IndexDist_Sorter</a></span>
<a name="195"><font size=-1>195     </font></a><span class="keyword">	</span><span class="default">{</span>
<a name="196"><font size=-1>196     </font></a><span class="default">		</span><span class="comment">/** PairType will be typically: std::pair&lt;IndexType,DistanceType&gt; */</span>
<a name="197"><font size=-1>197     </font></a><span class="comment">		</span><span class="keyword">template </span><span class="default">&lt;</span><span class="keyword">typename <a href="dictionary_P.html#17605">PairType</a></span><span class="default">&gt;</span>
<a name="198"><font size=-1>198     </font></a><span class="default">		</span><span class="keyword">inline bool operator</span><span class="default">()(</span><span class="keyword">const <a href="dictionary_P.html#17605">PairType</a> </span><span class="default">&amp;<a href="dictionary_P.html#17606">p1</a>, </span><span class="keyword">const <a href="dictionary_P.html#17605">PairType</a> </span><span class="default">&amp;<a href="dictionary_P.html#17607">p2</a>) </span><span class="keyword">const </span><span class="default">{</span>
<a name="199"><font size=-1>199     </font></a><span class="default">			</span><span class="keyword">return <a href="dictionary_P.html#17606">p1</a></span><span class="default">.<a href="dictionary_S.html#23">second</a> &lt; <a href="dictionary_P.html#17607">p2</a>.<a href="dictionary_S.html#23">second</a>;</span>
<a name="200"><font size=-1>200     </font></a><span class="default">		}</span>
<a name="201"><font size=-1>201     </font></a><span class="default">	};</span>
<a name="202"><font size=-1>202     </font></a><span class="default"></span>
<a name="203"><font size=-1>203     </font></a><span class="default">	</span><span class="comment">/** @} */</span>
<a name="204"><font size=-1>204     </font></a><span class="comment"></span>
<a name="205"><font size=-1>205     </font></a><span class="comment"></span>
<a name="206"><font size=-1>206     </font></a><span class="comment">	/** @addtogroup loadsave_grp Load/save auxiliary functions</span>
<a name="207"><font size=-1>207     </font></a><span class="comment">	  * @{ */</span>
<a name="208"><font size=-1>208     </font></a><span class="comment">	</span><span class="keyword">template</span><span class="default">&lt;</span><span class="keyword">typename <a href="dictionary_T.html#17609">T</a></span><span class="default">&gt;</span>
<a name="209"><font size=-1>209     </font></a><span class="default">	</span><span class="keyword">void <a href="dictionary_N.html#17608">save_value</a></span><span class="default">(<a href="dictionary_F.html#2277">FILE</a>* <a href="dictionary_S.html#17610">stream</a>, </span><span class="keyword">const <a href="dictionary_T.html#17609">T</a></span><span class="default">&amp; <a href="dictionary_V.html#17611">value</a>, <a href="dictionary_S.html#56">size_t</a> <a href="dictionary_C.html#17612">count</a> = </span><span class="number">1</span><span class="default">)</span>
<a name="210"><font size=-1>210     </font></a><span class="default">	{</span>
<a name="211"><font size=-1>211     </font></a><span class="default">		<a href="dictionary_F.html#17613">fwrite</a>(&amp;<a href="dictionary_V.html#17611">value</a>, </span><span class="keyword">sizeof</span><span class="default">(<a href="dictionary_V.html#17611">value</a>),<a href="dictionary_C.html#17612">count</a>, <a href="dictionary_S.html#17610">stream</a>);</span>
<a name="212"><font size=-1>212     </font></a><span class="default">	}</span>
<a name="213"><font size=-1>213     </font></a><span class="default"></span>
<a name="214"><font size=-1>214     </font></a><span class="default">	</span><span class="keyword">template</span><span class="default">&lt;</span><span class="keyword">typename <a href="dictionary_T.html#17615">T</a></span><span class="default">&gt;</span>
<a name="215"><font size=-1>215     </font></a><span class="default">	</span><span class="keyword">void <a href="dictionary_N.html#17614">save_value</a></span><span class="default">(<a href="dictionary_F.html#2277">FILE</a>* <a href="dictionary_S.html#17616">stream</a>, </span><span class="keyword">const </span><span class="default">std::<a href="dictionary_S.html#74">vector</a>&lt;T&gt;&amp; <a href="dictionary_V.html#17617">value</a>)</span>
<a name="216"><font size=-1>216     </font></a><span class="default">	{</span>
<a name="217"><font size=-1>217     </font></a><span class="default">		<a href="dictionary_S.html#56">size_t</a> <a href="dictionary_S.html#17618">size</a> = <a href="dictionary_V.html#17617">value</a>.<a href="dictionary_S.html#442">size</a>();</span>
<a name="218"><font size=-1>218     </font></a><span class="default">		<a href="dictionary_F.html#17613">fwrite</a>(&amp;<a href="dictionary_S.html#17618">size</a>, </span><span class="keyword">sizeof</span><span class="default">(<a href="dictionary_S.html#56">size_t</a>), </span><span class="number">1</span><span class="default">, <a href="dictionary_S.html#17616">stream</a>);</span>
<a name="219"><font size=-1>219     </font></a><span class="default">		<a href="dictionary_F.html#17613">fwrite</a>(&amp;<a href="dictionary_V.html#17617">value</a>[</span><span class="number">0</span><span class="default">], </span><span class="keyword">sizeof</span><span class="default">(<a href="dictionary_T.html#806">T</a>), <a href="dictionary_S.html#17618">size</a>, <a href="dictionary_S.html#17616">stream</a>);</span>
<a name="220"><font size=-1>220     </font></a><span class="default">	}</span>
<a name="221"><font size=-1>221     </font></a><span class="default"></span>
<a name="222"><font size=-1>222     </font></a><span class="default">	</span><span class="keyword">template</span><span class="default">&lt;</span><span class="keyword">typename <a href="dictionary_T.html#17620">T</a></span><span class="default">&gt;</span>
<a name="223"><font size=-1>223     </font></a><span class="default">	</span><span class="keyword">void <a href="dictionary_N.html#17619">load_value</a></span><span class="default">(<a href="dictionary_F.html#2277">FILE</a>* <a href="dictionary_S.html#17621">stream</a>, <a href="dictionary_T.html#17620">T</a>&amp; <a href="dictionary_V.html#17622">value</a>, <a href="dictionary_S.html#56">size_t</a> <a href="dictionary_C.html#17623">count</a> = </span><span class="number">1</span><span class="default">)</span>
<a name="224"><font size=-1>224     </font></a><span class="default">	{</span>
<a name="225"><font size=-1>225     </font></a><span class="default">		<a href="dictionary_S.html#56">size_t</a> <a href="dictionary_R.html#17624">read_cnt</a> = <a href="dictionary_F.html#17625">fread</a>(&amp;<a href="dictionary_V.html#17622">value</a>, </span><span class="keyword">sizeof</span><span class="default">(<a href="dictionary_V.html#17622">value</a>), <a href="dictionary_C.html#17623">count</a>, <a href="dictionary_S.html#17621">stream</a>);</span>
<a name="226"><font size=-1>226     </font></a><span class="default">		</span><span class="keyword">if </span><span class="default">(<a href="dictionary_R.html#17624">read_cnt</a> != <a href="dictionary_C.html#17623">count</a>) {</span>
<a name="227"><font size=-1>227     </font></a><span class="default">			</span><span class="keyword">throw </span><span class="default">std::<a href="dictionary_S.html#713">runtime_error</a>(</span><span class="string">&quot;Cannot read from file&quot;</span><span class="default">);</span>
<a name="228"><font size=-1>228     </font></a><span class="default">		}</span>
<a name="229"><font size=-1>229     </font></a><span class="default">	}</span>
<a name="230"><font size=-1>230     </font></a><span class="default"></span>
<a name="231"><font size=-1>231     </font></a><span class="default"></span>
<a name="232"><font size=-1>232     </font></a><span class="default">	</span><span class="keyword">template</span><span class="default">&lt;</span><span class="keyword">typename <a href="dictionary_T.html#17627">T</a></span><span class="default">&gt;</span>
<a name="233"><font size=-1>233     </font></a><span class="default">	</span><span class="keyword">void <a href="dictionary_N.html#17626">load_value</a></span><span class="default">(<a href="dictionary_F.html#2277">FILE</a>* <a href="dictionary_S.html#17628">stream</a>, std::<a href="dictionary_S.html#74">vector</a>&lt;T&gt;&amp; <a href="dictionary_V.html#17629">value</a>)</span>
<a name="234"><font size=-1>234     </font></a><span class="default">	{</span>
<a name="235"><font size=-1>235     </font></a><span class="default">		<a href="dictionary_S.html#56">size_t</a> <a href="dictionary_S.html#17630">size</a>;</span>
<a name="236"><font size=-1>236     </font></a><span class="default">		<a href="dictionary_S.html#56">size_t</a> <a href="dictionary_R.html#17631">read_cnt</a> = <a href="dictionary_F.html#17625">fread</a>(&amp;<a href="dictionary_S.html#17630">size</a>, </span><span class="keyword">sizeof</span><span class="default">(<a href="dictionary_S.html#56">size_t</a>), </span><span class="number">1</span><span class="default">, <a href="dictionary_S.html#17628">stream</a>);</span>
<a name="237"><font size=-1>237     </font></a><span class="default">		</span><span class="keyword">if </span><span class="default">(<a href="dictionary_R.html#17631">read_cnt</a>!=</span><span class="number">1</span><span class="default">) {</span>
<a name="238"><font size=-1>238     </font></a><span class="default">			</span><span class="keyword">throw </span><span class="default">std::<a href="dictionary_S.html#713">runtime_error</a>(</span><span class="string">&quot;Cannot read from file&quot;</span><span class="default">);</span>
<a name="239"><font size=-1>239     </font></a><span class="default">		}</span>
<a name="240"><font size=-1>240     </font></a><span class="default">		<a href="dictionary_V.html#17629">value</a>.<a href="dictionary_R.html#472">resize</a>(<a href="dictionary_S.html#17630">size</a>);</span>
<a name="241"><font size=-1>241     </font></a><span class="default">		<a href="dictionary_R.html#17631">read_cnt</a> = <a href="dictionary_F.html#17625">fread</a>(&amp;<a href="dictionary_V.html#17629">value</a>[</span><span class="number">0</span><span class="default">], </span><span class="keyword">sizeof</span><span class="default">(<a href="dictionary_T.html#806">T</a>), <a href="dictionary_S.html#17630">size</a>, <a href="dictionary_S.html#17628">stream</a>);</span>
<a name="242"><font size=-1>242     </font></a><span class="default">		</span><span class="keyword">if </span><span class="default">(<a href="dictionary_R.html#17631">read_cnt</a>!=<a href="dictionary_S.html#17630">size</a>) {</span>
<a name="243"><font size=-1>243     </font></a><span class="default">			</span><span class="keyword">throw </span><span class="default">std::<a href="dictionary_S.html#713">runtime_error</a>(</span><span class="string">&quot;Cannot read from file&quot;</span><span class="default">);</span>
<a name="244"><font size=-1>244     </font></a><span class="default">		}</span>
<a name="245"><font size=-1>245     </font></a><span class="default">	}</span>
<a name="246"><font size=-1>246     </font></a><span class="default">	</span><span class="comment">/** @} */</span>
<a name="247"><font size=-1>247     </font></a><span class="comment"></span>
<a name="248"><font size=-1>248     </font></a><span class="comment"></span>
<a name="249"><font size=-1>249     </font></a><span class="comment">	/** @addtogroup metric_grp Metric (distance) classes</span>
<a name="250"><font size=-1>250     </font></a><span class="comment">	  * @{ */</span>
<a name="251"><font size=-1>251     </font></a><span class="comment"></span>
<a name="252"><font size=-1>252     </font></a><span class="comment">	/** Manhattan distance functor (generic version, optimized for high-dimensionality data sets).</span>
<a name="253"><font size=-1>253     </font></a><span class="comment">	  *  Corresponding distance traits: nanoflann::metric_L1</span>
<a name="254"><font size=-1>254     </font></a><span class="comment">	  * \tparam T Type of the elements (e.g. double, float, uint8_t)</span>
<a name="255"><font size=-1>255     </font></a><span class="comment">	  * \tparam _DistanceType Type of distance variables (must be signed) (e.g. float, double, int64_t)</span>
<a name="256"><font size=-1>256     </font></a><span class="comment">	  */</span>
<a name="257"><font size=-1>257     </font></a><span class="comment">	</span><span class="keyword">template</span><span class="default">&lt;</span><span class="keyword">class <a href="dictionary_N.html#17633">T</a></span><span class="default">, </span><span class="keyword">class <a href="dictionary_N.html#17634">DataSource</a></span><span class="default">, </span><span class="keyword">typename <a href="dictionary_N.html#17635">_DistanceType</a> </span><span class="default">= T&gt;</span>
<a name="258"><font size=-1>258     </font></a><span class="default">	</span><span class="keyword">struct <a href="dictionary_N.html#17632">L1_Adaptor</a></span>
<a name="259"><font size=-1>259     </font></a><span class="keyword">	</span><span class="default">{</span>
<a name="260"><font size=-1>260     </font></a><span class="default">		</span><span class="keyword">typedef <a href="dictionary_N.html#17633">T</a> <a href="dictionary_N.html#17636">ElementType</a></span><span class="default">;</span>
<a name="261"><font size=-1>261     </font></a><span class="default">		</span><span class="keyword">typedef <a href="dictionary_N.html#17635">_DistanceType</a> <a href="dictionary_N.html#17637">DistanceType</a></span><span class="default">;</span>
<a name="262"><font size=-1>262     </font></a><span class="default"></span>
<a name="263"><font size=-1>263     </font></a><span class="default">		</span><span class="keyword">const <a href="dictionary_N.html#17634">DataSource</a> </span><span class="default">&amp;<a href="dictionary_N.html#17638">data_source</a>;</span>
<a name="264"><font size=-1>264     </font></a><span class="default"></span>
<a name="265"><font size=-1>265     </font></a><span class="default">		<a href="dictionary_N.html#17639">L1_Adaptor</a>(</span><span class="keyword">const <a href="dictionary_N.html#17634">DataSource</a> </span><span class="default">&amp;<a href="dictionary_Non-Alpha.html#17640">_data_source</a>) : <a href="dictionary_N.html#17638">data_source</a>(<a href="dictionary_Non-Alpha.html#17640">_data_source</a>) { }</span>
<a name="266"><font size=-1>266     </font></a><span class="default"></span>
<a name="267"><font size=-1>267     </font></a><span class="default">		</span><span class="keyword">inline <a href="dictionary_N.html#17637">DistanceType</a> operator</span><span class="default">()(</span><span class="keyword">const <a href="dictionary_N.html#17633">T</a></span><span class="default">* <a href="dictionary_A.html#17642">a</a>, </span><span class="keyword">const <a href="dictionary_S.html#56">size_t</a> <a href="dictionary_B.html#17643">b_idx</a></span><span class="default">, <a href="dictionary_S.html#56">size_t</a> <a href="dictionary_S.html#17644">size</a>, <a href="dictionary_N.html#17637">DistanceType</a> <a href="dictionary_W.html#17645">worst_dist</a> = -</span><span class="number">1</span><span class="default">) </span><span class="keyword">const</span>
<a name="268"><font size=-1>268     </font></a><span class="keyword">		</span><span class="default">{</span>
<a name="269"><font size=-1>269     </font></a><span class="default">			<a href="dictionary_N.html#17637">DistanceType</a> <a href="dictionary_R.html#17652">result</a> = <a href="dictionary_N.html#17637">DistanceType</a>();</span>
<a name="270"><font size=-1>270     </font></a><span class="default">			</span><span class="keyword">const <a href="dictionary_N.html#17633">T</a></span><span class="default">* <a href="dictionary_L.html#17653">last</a> = <a href="dictionary_A.html#17642">a</a> + <a href="dictionary_S.html#17644">size</a>;</span>
<a name="271"><font size=-1>271     </font></a><span class="default">			</span><span class="keyword">const <a href="dictionary_N.html#17633">T</a></span><span class="default">* <a href="dictionary_L.html#17654">lastgroup</a> = <a href="dictionary_L.html#17653">last</a> - </span><span class="number">3</span><span class="default">;</span>
<a name="272"><font size=-1>272     </font></a><span class="default">			<a href="dictionary_S.html#56">size_t</a> <a href="dictionary_D.html#17655">d</a> = </span><span class="number">0</span><span class="default">;</span>
<a name="273"><font size=-1>273     </font></a><span class="default"></span>
<a name="274"><font size=-1>274     </font></a><span class="default">			</span><span class="comment">/* Process 4 items with each loop for efficiency. */</span>
<a name="275"><font size=-1>275     </font></a><span class="comment">			</span><span class="keyword">while </span><span class="default">(<a href="dictionary_A.html#17642">a</a> &lt; <a href="dictionary_L.html#17654">lastgroup</a>) {</span>
<a name="276"><font size=-1>276     </font></a><span class="default">				</span><span class="keyword">const <a href="dictionary_N.html#17637">DistanceType</a> <a href="dictionary_D.html#17656">diff0</a> </span><span class="default">= std::<a href="dictionary_S.html#10142">abs</a>(<a href="dictionary_A.html#17642">a</a>[</span><span class="number">0</span><span class="default">] - <a href="dictionary_N.html#17638">data_source</a>.<a href="dictionary_K.html#17657">kdtree_get_pt</a>(<a href="dictionary_B.html#17643">b_idx</a>,<a href="dictionary_D.html#17655">d</a>++));</span>
<a name="277"><font size=-1>277     </font></a><span class="default">				</span><span class="keyword">const <a href="dictionary_N.html#17637">DistanceType</a> <a href="dictionary_D.html#17658">diff1</a> </span><span class="default">= std::<a href="dictionary_S.html#10142">abs</a>(<a href="dictionary_A.html#17642">a</a>[</span><span class="number">1</span><span class="default">] - <a href="dictionary_N.html#17638">data_source</a>.<a href="dictionary_K.html#17657">kdtree_get_pt</a>(<a href="dictionary_B.html#17643">b_idx</a>,<a href="dictionary_D.html#17655">d</a>++));</span>
<a name="278"><font size=-1>278     </font></a><span class="default">				</span><span class="keyword">const <a href="dictionary_N.html#17637">DistanceType</a> <a href="dictionary_D.html#17659">diff2</a> </span><span class="default">= std::<a href="dictionary_S.html#10142">abs</a>(<a href="dictionary_A.html#17642">a</a>[</span><span class="number">2</span><span class="default">] - <a href="dictionary_N.html#17638">data_source</a>.<a href="dictionary_K.html#17657">kdtree_get_pt</a>(<a href="dictionary_B.html#17643">b_idx</a>,<a href="dictionary_D.html#17655">d</a>++));</span>
<a name="279"><font size=-1>279     </font></a><span class="default">				</span><span class="keyword">const <a href="dictionary_N.html#17637">DistanceType</a> <a href="dictionary_D.html#17660">diff3</a> </span><span class="default">= std::<a href="dictionary_S.html#10142">abs</a>(<a href="dictionary_A.html#17642">a</a>[</span><span class="number">3</span><span class="default">] - <a href="dictionary_N.html#17638">data_source</a>.<a href="dictionary_K.html#17657">kdtree_get_pt</a>(<a href="dictionary_B.html#17643">b_idx</a>,<a href="dictionary_D.html#17655">d</a>++));</span>
<a name="280"><font size=-1>280     </font></a><span class="default">				<a href="dictionary_R.html#17652">result</a> += <a href="dictionary_D.html#17656">diff0</a> + <a href="dictionary_D.html#17658">diff1</a> + <a href="dictionary_D.html#17659">diff2</a> + <a href="dictionary_D.html#17660">diff3</a>;</span>
<a name="281"><font size=-1>281     </font></a><span class="default">				<a href="dictionary_A.html#17642">a</a> += </span><span class="number">4</span><span class="default">;</span>
<a name="282"><font size=-1>282     </font></a><span class="default">				</span><span class="keyword">if </span><span class="default">((<a href="dictionary_W.html#17645">worst_dist</a>&gt;</span><span class="number">0</span><span class="default">)&amp;&amp;(<a href="dictionary_R.html#17652">result</a>&gt;<a href="dictionary_W.html#17645">worst_dist</a>)) {</span>
<a name="283"><font size=-1>283     </font></a><span class="default">					</span><span class="keyword">return <a href="dictionary_R.html#17652">result</a></span><span class="default">;</span>
<a name="284"><font size=-1>284     </font></a><span class="default">				}</span>
<a name="285"><font size=-1>285     </font></a><span class="default">			}</span>
<a name="286"><font size=-1>286     </font></a><span class="default">			</span><span class="comment">/* Process last 0-3 components.  Not needed for standard vector lengths. */</span>
<a name="287"><font size=-1>287     </font></a><span class="comment">			</span><span class="keyword">while </span><span class="default">(<a href="dictionary_A.html#17642">a</a> &lt; <a href="dictionary_L.html#17653">last</a>) {</span>
<a name="288"><font size=-1>288     </font></a><span class="default">				<a href="dictionary_R.html#17652">result</a> += std::<a href="dictionary_S.html#10142">abs</a>( *<a href="dictionary_A.html#17642">a</a>++ - <a href="dictionary_N.html#17638">data_source</a>.<a href="dictionary_K.html#17657">kdtree_get_pt</a>(<a href="dictionary_B.html#17643">b_idx</a>,<a href="dictionary_D.html#17655">d</a>++) );</span>
<a name="289"><font size=-1>289     </font></a><span class="default">			}</span>
<a name="290"><font size=-1>290     </font></a><span class="default">			</span><span class="keyword">return <a href="dictionary_R.html#17652">result</a></span><span class="default">;</span>
<a name="291"><font size=-1>291     </font></a><span class="default">		}</span>
<a name="292"><font size=-1>292     </font></a><span class="default"></span>
<a name="293"><font size=-1>293     </font></a><span class="default">		</span><span class="keyword">template </span><span class="default">&lt;</span><span class="keyword">typename <a href="dictionary_U.html#17647">U</a></span><span class="default">, </span><span class="keyword">typename <a href="dictionary_V.html#17648">V</a></span><span class="default">&gt;</span>
<a name="294"><font size=-1>294     </font></a><span class="default">		</span><span class="keyword">inline <a href="dictionary_N.html#17637">DistanceType</a> <a href="dictionary_N.html#17646">accum_dist</a></span><span class="default">(</span><span class="keyword">const <a href="dictionary_U.html#17647">U</a> <a href="dictionary_A.html#17649">a</a></span><span class="default">, </span><span class="keyword">const <a href="dictionary_V.html#17648">V</a> <a href="dictionary_B.html#17650">b</a></span><span class="default">, </span><span class="keyword">int </span><span class="default">) </span><span class="keyword">const</span>
<a name="295"><font size=-1>295     </font></a><span class="keyword">		</span><span class="default">{</span>
<a name="296"><font size=-1>296     </font></a><span class="default">			</span><span class="keyword">return </span><span class="default">std::<a href="dictionary_S.html#10142">abs</a>(<a href="dictionary_A.html#17649">a</a>-<a href="dictionary_B.html#17650">b</a>);</span>
<a name="297"><font size=-1>297     </font></a><span class="default">		}</span>
<a name="298"><font size=-1>298     </font></a><span class="default">	};</span>
<a name="299"><font size=-1>299     </font></a><span class="default"></span>
<a name="300"><font size=-1>300     </font></a><span class="default">	</span><span class="comment">/** Squared Euclidean distance functor (generic version, optimized for high-dimensionality data sets).</span>
<a name="301"><font size=-1>301     </font></a><span class="comment">	  *  Corresponding distance traits: nanoflann::metric_L2</span>
<a name="302"><font size=-1>302     </font></a><span class="comment">	  * \tparam T Type of the elements (e.g. double, float, uint8_t)</span>
<a name="303"><font size=-1>303     </font></a><span class="comment">	  * \tparam _DistanceType Type of distance variables (must be signed) (e.g. float, double, int64_t)</span>
<a name="304"><font size=-1>304     </font></a><span class="comment">	  */</span>
<a name="305"><font size=-1>305     </font></a><span class="comment">	</span><span class="keyword">template</span><span class="default">&lt;</span><span class="keyword">class <a href="dictionary_N.html#17662">T</a></span><span class="default">, </span><span class="keyword">class <a href="dictionary_N.html#17663">DataSource</a></span><span class="default">, </span><span class="keyword">typename <a href="dictionary_N.html#17664">_DistanceType</a> </span><span class="default">= T&gt;</span>
<a name="306"><font size=-1>306     </font></a><span class="default">	</span><span class="keyword">struct <a href="dictionary_N.html#17661">L2_Adaptor</a></span>
<a name="307"><font size=-1>307     </font></a><span class="keyword">	</span><span class="default">{</span>
<a name="308"><font size=-1>308     </font></a><span class="default">		</span><span class="keyword">typedef <a href="dictionary_N.html#17662">T</a> <a href="dictionary_N.html#17665">ElementType</a></span><span class="default">;</span>
<a name="309"><font size=-1>309     </font></a><span class="default">		</span><span class="keyword">typedef <a href="dictionary_N.html#17664">_DistanceType</a> <a href="dictionary_N.html#17666">DistanceType</a></span><span class="default">;</span>
<a name="310"><font size=-1>310     </font></a><span class="default"></span>
<a name="311"><font size=-1>311     </font></a><span class="default">		</span><span class="keyword">const <a href="dictionary_N.html#17663">DataSource</a> </span><span class="default">&amp;<a href="dictionary_N.html#17667">data_source</a>;</span>
<a name="312"><font size=-1>312     </font></a><span class="default"></span>
<a name="313"><font size=-1>313     </font></a><span class="default">		<a href="dictionary_N.html#17668">L2_Adaptor</a>(</span><span class="keyword">const <a href="dictionary_N.html#17663">DataSource</a> </span><span class="default">&amp;<a href="dictionary_Non-Alpha.html#17669">_data_source</a>) : <a href="dictionary_N.html#17667">data_source</a>(<a href="dictionary_Non-Alpha.html#17669">_data_source</a>) { }</span>
<a name="314"><font size=-1>314     </font></a><span class="default"></span>
<a name="315"><font size=-1>315     </font></a><span class="default">		</span><span class="keyword">inline <a href="dictionary_N.html#17666">DistanceType</a> operator</span><span class="default">()(</span><span class="keyword">const <a href="dictionary_N.html#17662">T</a></span><span class="default">* <a href="dictionary_A.html#17671">a</a>, </span><span class="keyword">const <a href="dictionary_S.html#56">size_t</a> <a href="dictionary_B.html#17672">b_idx</a></span><span class="default">, <a href="dictionary_S.html#56">size_t</a> <a href="dictionary_S.html#17673">size</a>, <a href="dictionary_N.html#17666">DistanceType</a> <a href="dictionary_W.html#17674">worst_dist</a> = -</span><span class="number">1</span><span class="default">) </span><span class="keyword">const</span>
<a name="316"><font size=-1>316     </font></a><span class="keyword">		</span><span class="default">{</span>
<a name="317"><font size=-1>317     </font></a><span class="default">			<a href="dictionary_N.html#17666">DistanceType</a> <a href="dictionary_R.html#17681">result</a> = <a href="dictionary_N.html#17666">DistanceType</a>();</span>
<a name="318"><font size=-1>318     </font></a><span class="default">			</span><span class="keyword">const <a href="dictionary_N.html#17662">T</a></span><span class="default">* <a href="dictionary_L.html#17682">last</a> = <a href="dictionary_A.html#17671">a</a> + <a href="dictionary_S.html#17673">size</a>;</span>
<a name="319"><font size=-1>319     </font></a><span class="default">			</span><span class="keyword">const <a href="dictionary_N.html#17662">T</a></span><span class="default">* <a href="dictionary_L.html#17683">lastgroup</a> = <a href="dictionary_L.html#17682">last</a> - </span><span class="number">3</span><span class="default">;</span>
<a name="320"><font size=-1>320     </font></a><span class="default">			<a href="dictionary_S.html#56">size_t</a> <a href="dictionary_D.html#17684">d</a> = </span><span class="number">0</span><span class="default">;</span>
<a name="321"><font size=-1>321     </font></a><span class="default"></span>
<a name="322"><font size=-1>322     </font></a><span class="default">			</span><span class="comment">/* Process 4 items with each loop for efficiency. */</span>
<a name="323"><font size=-1>323     </font></a><span class="comment">			</span><span class="keyword">while </span><span class="default">(<a href="dictionary_A.html#17671">a</a> &lt; <a href="dictionary_L.html#17683">lastgroup</a>) {</span>
<a name="324"><font size=-1>324     </font></a><span class="default">				</span><span class="keyword">const <a href="dictionary_N.html#17666">DistanceType</a> <a href="dictionary_D.html#17685">diff0</a> </span><span class="default">= <a href="dictionary_A.html#17671">a</a>[</span><span class="number">0</span><span class="default">] - <a href="dictionary_N.html#17667">data_source</a>.<a href="dictionary_K.html#17657">kdtree_get_pt</a>(<a href="dictionary_B.html#17672">b_idx</a>,<a href="dictionary_D.html#17684">d</a>++);</span>
<a name="325"><font size=-1>325     </font></a><span class="default">				</span><span class="keyword">const <a href="dictionary_N.html#17666">DistanceType</a> <a href="dictionary_D.html#17686">diff1</a> </span><span class="default">= <a href="dictionary_A.html#17671">a</a>[</span><span class="number">1</span><span class="default">] - <a href="dictionary_N.html#17667">data_source</a>.<a href="dictionary_K.html#17657">kdtree_get_pt</a>(<a href="dictionary_B.html#17672">b_idx</a>,<a href="dictionary_D.html#17684">d</a>++);</span>
<a name="326"><font size=-1>326     </font></a><span class="default">				</span><span class="keyword">const <a href="dictionary_N.html#17666">DistanceType</a> <a href="dictionary_D.html#17687">diff2</a> </span><span class="default">= <a href="dictionary_A.html#17671">a</a>[</span><span class="number">2</span><span class="default">] - <a href="dictionary_N.html#17667">data_source</a>.<a href="dictionary_K.html#17657">kdtree_get_pt</a>(<a href="dictionary_B.html#17672">b_idx</a>,<a href="dictionary_D.html#17684">d</a>++);</span>
<a name="327"><font size=-1>327     </font></a><span class="default">				</span><span class="keyword">const <a href="dictionary_N.html#17666">DistanceType</a> <a href="dictionary_D.html#17688">diff3</a> </span><span class="default">= <a href="dictionary_A.html#17671">a</a>[</span><span class="number">3</span><span class="default">] - <a href="dictionary_N.html#17667">data_source</a>.<a href="dictionary_K.html#17657">kdtree_get_pt</a>(<a href="dictionary_B.html#17672">b_idx</a>,<a href="dictionary_D.html#17684">d</a>++);</span>
<a name="328"><font size=-1>328     </font></a><span class="default">				<a href="dictionary_R.html#17681">result</a> += <a href="dictionary_D.html#17685">diff0</a> * <a href="dictionary_D.html#17685">diff0</a> + <a href="dictionary_D.html#17686">diff1</a> * <a href="dictionary_D.html#17686">diff1</a> + <a href="dictionary_D.html#17687">diff2</a> * <a href="dictionary_D.html#17687">diff2</a> + <a href="dictionary_D.html#17688">diff3</a> * <a href="dictionary_D.html#17688">diff3</a>;</span>
<a name="329"><font size=-1>329     </font></a><span class="default">				<a href="dictionary_A.html#17671">a</a> += </span><span class="number">4</span><span class="default">;</span>
<a name="330"><font size=-1>330     </font></a><span class="default">				</span><span class="keyword">if </span><span class="default">((<a href="dictionary_W.html#17674">worst_dist</a>&gt;</span><span class="number">0</span><span class="default">)&amp;&amp;(<a href="dictionary_R.html#17681">result</a>&gt;<a href="dictionary_W.html#17674">worst_dist</a>)) {</span>
<a name="331"><font size=-1>331     </font></a><span class="default">					</span><span class="keyword">return <a href="dictionary_R.html#17681">result</a></span><span class="default">;</span>
<a name="332"><font size=-1>332     </font></a><span class="default">				}</span>
<a name="333"><font size=-1>333     </font></a><span class="default">			}</span>
<a name="334"><font size=-1>334     </font></a><span class="default">			</span><span class="comment">/* Process last 0-3 components.  Not needed for standard vector lengths. */</span>
<a name="335"><font size=-1>335     </font></a><span class="comment">			</span><span class="keyword">while </span><span class="default">(<a href="dictionary_A.html#17671">a</a> &lt; <a href="dictionary_L.html#17682">last</a>) {</span>
<a name="336"><font size=-1>336     </font></a><span class="default">				</span><span class="keyword">const <a href="dictionary_N.html#17666">DistanceType</a> <a href="dictionary_D.html#17689">diff0</a> </span><span class="default">= *<a href="dictionary_A.html#17671">a</a>++ - <a href="dictionary_N.html#17667">data_source</a>.<a href="dictionary_K.html#17657">kdtree_get_pt</a>(<a href="dictionary_B.html#17672">b_idx</a>,<a href="dictionary_D.html#17684">d</a>++);</span>
<a name="337"><font size=-1>337     </font></a><span class="default">				<a href="dictionary_R.html#17681">result</a> += <a href="dictionary_D.html#17689">diff0</a> * <a href="dictionary_D.html#17689">diff0</a>;</span>
<a name="338"><font size=-1>338     </font></a><span class="default">			}</span>
<a name="339"><font size=-1>339     </font></a><span class="default">			</span><span class="keyword">return <a href="dictionary_R.html#17681">result</a></span><span class="default">;</span>
<a name="340"><font size=-1>340     </font></a><span class="default">		}</span>
<a name="341"><font size=-1>341     </font></a><span class="default"></span>
<a name="342"><font size=-1>342     </font></a><span class="default">		</span><span class="keyword">template </span><span class="default">&lt;</span><span class="keyword">typename <a href="dictionary_U.html#17676">U</a></span><span class="default">, </span><span class="keyword">typename <a href="dictionary_V.html#17677">V</a></span><span class="default">&gt;</span>
<a name="343"><font size=-1>343     </font></a><span class="default">		</span><span class="keyword">inline <a href="dictionary_N.html#17666">DistanceType</a> <a href="dictionary_N.html#17675">accum_dist</a></span><span class="default">(</span><span class="keyword">const <a href="dictionary_U.html#17676">U</a> <a href="dictionary_A.html#17678">a</a></span><span class="default">, </span><span class="keyword">const <a href="dictionary_V.html#17677">V</a> <a href="dictionary_B.html#17679">b</a></span><span class="default">, </span><span class="keyword">int </span><span class="default">) </span><span class="keyword">const</span>
<a name="344"><font size=-1>344     </font></a><span class="keyword">		</span><span class="default">{</span>
<a name="345"><font size=-1>345     </font></a><span class="default">			</span><span class="keyword">return </span><span class="default">(<a href="dictionary_A.html#17678">a</a>-<a href="dictionary_B.html#17679">b</a>)*(<a href="dictionary_A.html#17678">a</a>-<a href="dictionary_B.html#17679">b</a>);</span>
<a name="346"><font size=-1>346     </font></a><span class="default">		}</span>
<a name="347"><font size=-1>347     </font></a><span class="default">	};</span>
<a name="348"><font size=-1>348     </font></a><span class="default"></span>
<a name="349"><font size=-1>349     </font></a><span class="default">	</span><span class="comment">/** Squared Euclidean (L2) distance functor (suitable for low-dimensionality datasets, like 2D or 3D point clouds)</span>
<a name="350"><font size=-1>350     </font></a><span class="comment">	  *  Corresponding distance traits: nanoflann::metric_L2_Simple</span>
<a name="351"><font size=-1>351     </font></a><span class="comment">	  * \tparam T Type of the elements (e.g. double, float, uint8_t)</span>
<a name="352"><font size=-1>352     </font></a><span class="comment">	  * \tparam _DistanceType Type of distance variables (must be signed) (e.g. float, double, int64_t)</span>
<a name="353"><font size=-1>353     </font></a><span class="comment">	  */</span>
<a name="354"><font size=-1>354     </font></a><span class="comment">	</span><span class="keyword">template</span><span class="default">&lt;</span><span class="keyword">class <a href="dictionary_N.html#17691">T</a></span><span class="default">, </span><span class="keyword">class <a href="dictionary_N.html#17692">DataSource</a></span><span class="default">, </span><span class="keyword">typename <a href="dictionary_N.html#17693">_DistanceType</a> </span><span class="default">= T&gt;</span>
<a name="355"><font size=-1>355     </font></a><span class="default">	</span><span class="keyword">struct <a href="dictionary_N.html#17690">L2_Simple_Adaptor</a></span>
<a name="356"><font size=-1>356     </font></a><span class="keyword">	</span><span class="default">{</span>
<a name="357"><font size=-1>357     </font></a><span class="default">		</span><span class="keyword">typedef <a href="dictionary_N.html#17691">T</a> <a href="dictionary_N.html#17694">ElementType</a></span><span class="default">;</span>
<a name="358"><font size=-1>358     </font></a><span class="default">		</span><span class="keyword">typedef <a href="dictionary_N.html#17693">_DistanceType</a> <a href="dictionary_N.html#17695">DistanceType</a></span><span class="default">;</span>
<a name="359"><font size=-1>359     </font></a><span class="default"></span>
<a name="360"><font size=-1>360     </font></a><span class="default">		</span><span class="keyword">const <a href="dictionary_N.html#17692">DataSource</a> </span><span class="default">&amp;<a href="dictionary_N.html#17696">data_source</a>;</span>
<a name="361"><font size=-1>361     </font></a><span class="default"></span>
<a name="362"><font size=-1>362     </font></a><span class="default">		<a href="dictionary_N.html#17697">L2_Simple_Adaptor</a>(</span><span class="keyword">const <a href="dictionary_N.html#17692">DataSource</a> </span><span class="default">&amp;<a href="dictionary_Non-Alpha.html#17698">_data_source</a>) : <a href="dictionary_N.html#17696">data_source</a>(<a href="dictionary_Non-Alpha.html#17698">_data_source</a>) { }</span>
<a name="363"><font size=-1>363     </font></a><span class="default"></span>
<a name="364"><font size=-1>364     </font></a><span class="default">		</span><span class="keyword">inline <a href="dictionary_N.html#17695">DistanceType</a> operator</span><span class="default">()(</span><span class="keyword">const <a href="dictionary_N.html#17691">T</a></span><span class="default">* <a href="dictionary_A.html#17700">a</a>, </span><span class="keyword">const <a href="dictionary_S.html#56">size_t</a> <a href="dictionary_B.html#17701">b_idx</a></span><span class="default">, <a href="dictionary_S.html#56">size_t</a> <a href="dictionary_S.html#17702">size</a>) </span><span class="keyword">const </span><span class="default">{</span>
<a name="365"><font size=-1>365     </font></a><span class="default">			</span><span class="keyword">return <a href="dictionary_N.html#17696">data_source</a></span><span class="default">.<a href="dictionary_K.html#17709">kdtree_distance</a>(<a href="dictionary_A.html#17700">a</a>,<a href="dictionary_B.html#17701">b_idx</a>,<a href="dictionary_S.html#17702">size</a>);</span>
<a name="366"><font size=-1>366     </font></a><span class="default">		}</span>
<a name="367"><font size=-1>367     </font></a><span class="default"></span>
<a name="368"><font size=-1>368     </font></a><span class="default">		</span><span class="keyword">template </span><span class="default">&lt;</span><span class="keyword">typename <a href="dictionary_U.html#17704">U</a></span><span class="default">, </span><span class="keyword">typename <a href="dictionary_V.html#17705">V</a></span><span class="default">&gt;</span>
<a name="369"><font size=-1>369     </font></a><span class="default">		</span><span class="keyword">inline <a href="dictionary_N.html#17695">DistanceType</a> <a href="dictionary_N.html#17703">accum_dist</a></span><span class="default">(</span><span class="keyword">const <a href="dictionary_U.html#17704">U</a> <a href="dictionary_A.html#17706">a</a></span><span class="default">, </span><span class="keyword">const <a href="dictionary_V.html#17705">V</a> <a href="dictionary_B.html#17707">b</a></span><span class="default">, </span><span class="keyword">int </span><span class="default">) </span><span class="keyword">const</span>
<a name="370"><font size=-1>370     </font></a><span class="keyword">		</span><span class="default">{</span>
<a name="371"><font size=-1>371     </font></a><span class="default">			</span><span class="keyword">return </span><span class="default">(<a href="dictionary_A.html#17706">a</a>-<a href="dictionary_B.html#17707">b</a>)*(<a href="dictionary_A.html#17706">a</a>-<a href="dictionary_B.html#17707">b</a>);</span>
<a name="372"><font size=-1>372     </font></a><span class="default">		}</span>
<a name="373"><font size=-1>373     </font></a><span class="default">	};</span>
<a name="374"><font size=-1>374     </font></a><span class="default"></span>
<a name="375"><font size=-1>375     </font></a><span class="default">	</span><span class="comment">/** Metaprogramming helper traits class for the L1 (Manhattan) metric */</span>
<a name="376"><font size=-1>376     </font></a><span class="comment">	</span><span class="keyword">struct <a href="dictionary_N.html#17710">metric_L1</a> </span><span class="default">{</span>
<a name="377"><font size=-1>377     </font></a><span class="default">		</span><span class="keyword">template</span><span class="default">&lt;</span><span class="keyword">class <a href="dictionary_N.html#17712">T</a></span><span class="default">, </span><span class="keyword">class <a href="dictionary_N.html#17713">DataSource</a></span><span class="default">&gt;</span>
<a name="378"><font size=-1>378     </font></a><span class="default">		</span><span class="keyword">struct <a href="dictionary_N.html#17711">traits</a> </span><span class="default">{</span>
<a name="379"><font size=-1>379     </font></a><span class="default">			</span><span class="keyword">typedef <a href="dictionary_N.html#17632">L1_Adaptor</a></span><span class="default">&lt;T,DataSource&gt; <a href="dictionary_N.html#17714">distance_t</a>;</span>
<a name="380"><font size=-1>380     </font></a><span class="default">		};</span>
<a name="381"><font size=-1>381     </font></a><span class="default">	};</span>
<a name="382"><font size=-1>382     </font></a><span class="default">	</span><span class="comment">/** Metaprogramming helper traits class for the L2 (Euclidean) metric */</span>
<a name="383"><font size=-1>383     </font></a><span class="comment">	</span><span class="keyword">struct <a href="dictionary_N.html#17715">metric_L2</a> </span><span class="default">{</span>
<a name="384"><font size=-1>384     </font></a><span class="default">		</span><span class="keyword">template</span><span class="default">&lt;</span><span class="keyword">class <a href="dictionary_N.html#17717">T</a></span><span class="default">, </span><span class="keyword">class <a href="dictionary_N.html#17718">DataSource</a></span><span class="default">&gt;</span>
<a name="385"><font size=-1>385     </font></a><span class="default">		</span><span class="keyword">struct <a href="dictionary_N.html#17716">traits</a> </span><span class="default">{</span>
<a name="386"><font size=-1>386     </font></a><span class="default">			</span><span class="keyword">typedef <a href="dictionary_N.html#17661">L2_Adaptor</a></span><span class="default">&lt;T,DataSource&gt; <a href="dictionary_N.html#17719">distance_t</a>;</span>
<a name="387"><font size=-1>387     </font></a><span class="default">		};</span>
<a name="388"><font size=-1>388     </font></a><span class="default">	};</span>
<a name="389"><font size=-1>389     </font></a><span class="default">	</span><span class="comment">/** Metaprogramming helper traits class for the L2_simple (Euclidean) metric */</span>
<a name="390"><font size=-1>390     </font></a><span class="comment">	</span><span class="keyword">struct <a href="dictionary_N.html#17720">metric_L2_Simple</a> </span><span class="default">{</span>
<a name="391"><font size=-1>391     </font></a><span class="default">		</span><span class="keyword">template</span><span class="default">&lt;</span><span class="keyword">class <a href="dictionary_N.html#17722">T</a></span><span class="default">, </span><span class="keyword">class <a href="dictionary_N.html#17723">DataSource</a></span><span class="default">&gt;</span>
<a name="392"><font size=-1>392     </font></a><span class="default">		</span><span class="keyword">struct <a href="dictionary_N.html#17721">traits</a> </span><span class="default">{</span>
<a name="393"><font size=-1>393     </font></a><span class="default">			</span><span class="keyword">typedef <a href="dictionary_N.html#17690">L2_Simple_Adaptor</a></span><span class="default">&lt;T,DataSource&gt; <a href="dictionary_N.html#17724">distance_t</a>;</span>
<a name="394"><font size=-1>394     </font></a><span class="default">		};</span>
<a name="395"><font size=-1>395     </font></a><span class="default">	};</span>
<a name="396"><font size=-1>396     </font></a><span class="default"></span>
<a name="397"><font size=-1>397     </font></a><span class="default">	</span><span class="comment">/** @} */</span>
<a name="398"><font size=-1>398     </font></a><span class="comment"></span>
<a name="399"><font size=-1>399     </font></a><span class="comment">	/** @addtogroup param_grp Parameter structs</span>
<a name="400"><font size=-1>400     </font></a><span class="comment">	  * @{ */</span>
<a name="401"><font size=-1>401     </font></a><span class="comment"></span>
<a name="402"><font size=-1>402     </font></a><span class="comment">	/**  Parameters (see README.md) */</span>
<a name="403"><font size=-1>403     </font></a><span class="comment">	</span><span class="keyword">struct <a href="dictionary_N.html#17725">KDTreeSingleIndexAdaptorParams</a></span>
<a name="404"><font size=-1>404     </font></a><span class="keyword">	</span><span class="default">{</span>
<a name="405"><font size=-1>405     </font></a><span class="default">		<a href="dictionary_N.html#17726">KDTreeSingleIndexAdaptorParams</a>(<a href="dictionary_S.html#56">size_t</a> <a href="dictionary_Non-Alpha.html#17727">_leaf_max_size</a> = </span><span class="number">10</span><span class="default">) :</span>
<a name="406"><font size=-1>406     </font></a><span class="default">			<a href="dictionary_N.html#17728">leaf_max_size</a>(<a href="dictionary_Non-Alpha.html#17727">_leaf_max_size</a>)</span>
<a name="407"><font size=-1>407     </font></a><span class="default">		{}</span>
<a name="408"><font size=-1>408     </font></a><span class="default"></span>
<a name="409"><font size=-1>409     </font></a><span class="default">		<a href="dictionary_S.html#56">size_t</a> <a href="dictionary_N.html#17728">leaf_max_size</a>;</span>
<a name="410"><font size=-1>410     </font></a><span class="default">	};</span>
<a name="411"><font size=-1>411     </font></a><span class="default"></span>
<a name="412"><font size=-1>412     </font></a><span class="default">	</span><span class="comment">/** Search options for KDTreeSingleIndexAdaptor::findNeighbors() */</span>
<a name="413"><font size=-1>413     </font></a><span class="comment">	</span><span class="keyword">struct <a href="dictionary_N.html#17729">SearchParams</a></span>
<a name="414"><font size=-1>414     </font></a><span class="keyword">	</span><span class="default">{</span>
<a name="415"><font size=-1>415     </font></a><span class="default">		</span><span class="comment">/** Note: The first argument (checks_IGNORED_) is ignored, but kept for compatibility with the FLANN interface */</span>
<a name="416"><font size=-1>416     </font></a><span class="comment">		<a href="dictionary_N.html#17730">SearchParams</a></span><span class="default">(</span><span class="keyword">int <a href="dictionary_C.html#17731">checks_IGNORED_</a> </span><span class="default">= </span><span class="number">32</span><span class="default">, </span><span class="keyword">float <a href="dictionary_E.html#17732">eps_</a> </span><span class="default">= </span><span class="number">0</span><span class="default">, </span><span class="keyword">bool <a href="dictionary_S.html#17733">sorted_</a> </span><span class="default">= </span><span class="keyword">true </span><span class="default">) :</span>
<a name="417"><font size=-1>417     </font></a><span class="default">			<a href="dictionary_N.html#17734">checks</a>(<a href="dictionary_C.html#17731">checks_IGNORED_</a>), <a href="dictionary_N.html#17735">eps</a>(<a href="dictionary_E.html#17732">eps_</a>), <a href="dictionary_N.html#17736">sorted</a>(<a href="dictionary_S.html#17733">sorted_</a>) {}</span>
<a name="418"><font size=-1>418     </font></a><span class="default"></span>
<a name="419"><font size=-1>419     </font></a><span class="default">		</span><span class="keyword">int   <a href="dictionary_N.html#17734">checks</a></span><span class="default">;  </span><span class="comment">//!&lt; Ignored parameter (Kept for compatibility with the FLANN interface).</span>
<a name="420"><font size=-1>420     </font></a><span class="comment">		</span><span class="keyword">float <a href="dictionary_N.html#17735">eps</a></span><span class="default">;  </span><span class="comment">//!&lt; search for eps-approximate neighbours (default: 0)</span>
<a name="421"><font size=-1>421     </font></a><span class="comment">		</span><span class="keyword">bool <a href="dictionary_N.html#17736">sorted</a></span><span class="default">; </span><span class="comment">//!&lt; only for radius search, require neighbours sorted by distance (default: true)</span>
<a name="422"><font size=-1>422     </font></a><span class="comment">	</span><span class="default">};</span>
<a name="423"><font size=-1>423     </font></a><span class="default">	</span><span class="comment">/** @} */</span>
<a name="424"><font size=-1>424     </font></a><span class="comment"></span>
<a name="425"><font size=-1>425     </font></a><span class="comment"></span>
<a name="426"><font size=-1>426     </font></a><span class="comment">	/** @addtogroup memalloc_grp Memory allocation</span>
<a name="427"><font size=-1>427     </font></a><span class="comment">	  * @{ */</span>
<a name="428"><font size=-1>428     </font></a><span class="comment"></span>
<a name="429"><font size=-1>429     </font></a><span class="comment">	/**</span>
<a name="430"><font size=-1>430     </font></a><span class="comment">	 * Allocates (using C's malloc) a generic type T.</span>
<a name="431"><font size=-1>431     </font></a><span class="comment">	 *</span>
<a name="432"><font size=-1>432     </font></a><span class="comment">	 * Params:</span>
<a name="433"><font size=-1>433     </font></a><span class="comment">	 *     count = number of instances to allocate.</span>
<a name="434"><font size=-1>434     </font></a><span class="comment">	 * Returns: pointer (of type T*) to memory buffer</span>
<a name="435"><font size=-1>435     </font></a><span class="comment">	 */</span>
<a name="436"><font size=-1>436     </font></a><span class="comment">	</span><span class="keyword">template </span><span class="default">&lt;</span><span class="keyword">typename <a href="dictionary_T.html#17738">T</a></span><span class="default">&gt;</span>
<a name="437"><font size=-1>437     </font></a><span class="default">	</span><span class="keyword">inline <a href="dictionary_T.html#17738">T</a></span><span class="default">* <a href="dictionary_N.html#17737">allocate</a>(<a href="dictionary_S.html#56">size_t</a> <a href="dictionary_C.html#17739">count</a> = </span><span class="number">1</span><span class="default">)</span>
<a name="438"><font size=-1>438     </font></a><span class="default">	{</span>
<a name="439"><font size=-1>439     </font></a><span class="default">		<a href="dictionary_T.html#17738">T</a>* <a href="dictionary_M.html#17740">mem</a> = </span><span class="keyword">static_cast</span><span class="default">&lt;<a href="dictionary_T.html#17738">T</a>*&gt;( ::<a href="dictionary_M.html#14195">malloc</a>(</span><span class="keyword">sizeof</span><span class="default">(<a href="dictionary_T.html#806">T</a>)*<a href="dictionary_C.html#17739">count</a>));</span>
<a name="440"><font size=-1>440     </font></a><span class="default">		</span><span class="keyword">return <a href="dictionary_M.html#17740">mem</a></span><span class="default">;</span>
<a name="441"><font size=-1>441     </font></a><span class="default">	}</span>
<a name="442"><font size=-1>442     </font></a><span class="default"></span>
<a name="443"><font size=-1>443     </font></a><span class="default"></span>
<a name="444"><font size=-1>444     </font></a><span class="default">	</span><span class="comment">/**</span>
<a name="445"><font size=-1>445     </font></a><span class="comment">	 * Pooled storage allocator</span>
<a name="446"><font size=-1>446     </font></a><span class="comment">	 *</span>
<a name="447"><font size=-1>447     </font></a><span class="comment">	 * The following routines allow for the efficient allocation of storage in</span>
<a name="448"><font size=-1>448     </font></a><span class="comment">	 * small chunks from a specified pool.  Rather than allowing each structure</span>
<a name="449"><font size=-1>449     </font></a><span class="comment">	 * to be freed individually, an entire pool of storage is freed at once.</span>
<a name="450"><font size=-1>450     </font></a><span class="comment">	 * This method has two advantages over just using malloc() and free().  First,</span>
<a name="451"><font size=-1>451     </font></a><span class="comment">	 * it is far more efficient for allocating small objects, as there is</span>
<a name="452"><font size=-1>452     </font></a><span class="comment">	 * no overhead for remembering all the information needed to free each</span>
<a name="453"><font size=-1>453     </font></a><span class="comment">	 * object or consolidating fragmented memory.  Second, the decision about</span>
<a name="454"><font size=-1>454     </font></a><span class="comment">	 * how long to keep an object is made at the time of allocation, and there</span>
<a name="455"><font size=-1>455     </font></a><span class="comment">	 * is no need to track down all the objects to free them.</span>
<a name="456"><font size=-1>456     </font></a><span class="comment">	 *</span>
<a name="457"><font size=-1>457     </font></a><span class="comment">	 */</span>
<a name="458"><font size=-1>458     </font></a><span class="comment"></span>
<a name="459"><font size=-1>459     </font></a><span class="comment">	</span><span class="keyword">const <a href="dictionary_S.html#56">size_t</a>     <a href="dictionary_N.html#17741">WORDSIZE</a></span><span class="default">=</span><span class="number">16</span><span class="default">;</span>
<a name="460"><font size=-1>460     </font></a><span class="default">	</span><span class="keyword">const <a href="dictionary_S.html#56">size_t</a>     <a href="dictionary_N.html#17742">BLOCKSIZE</a></span><span class="default">=</span><span class="number">8192</span><span class="default">;</span>
<a name="461"><font size=-1>461     </font></a><span class="default"></span>
<a name="462"><font size=-1>462     </font></a><span class="default">	</span><span class="keyword">class <a href="dictionary_N.html#17743">PooledAllocator</a></span>
<a name="463"><font size=-1>463     </font></a><span class="keyword">	</span><span class="default">{</span>
<a name="464"><font size=-1>464     </font></a><span class="default">		</span><span class="comment">/* We maintain memory alignment to word boundaries by requiring that all</span>
<a name="465"><font size=-1>465     </font></a><span class="comment">		    allocations be in multiples of the machine wordsize.  */</span>
<a name="466"><font size=-1>466     </font></a><span class="comment">		/* Size of machine word in bytes.  Must be power of 2. */</span>
<a name="467"><font size=-1>467     </font></a><span class="comment">		/* Minimum number of bytes requested at a time from	the system.  Must be multiple of WORDSIZE. */</span>
<a name="468"><font size=-1>468     </font></a><span class="comment"></span>
<a name="469"><font size=-1>469     </font></a><span class="comment"></span>
<a name="470"><font size=-1>470     </font></a><span class="comment">		<a href="dictionary_S.html#56">size_t</a>  <a href="dictionary_N.html#17744">remaining</a></span><span class="default">;  </span><span class="comment">/* Number of bytes left in current block of storage. */</span>
<a name="471"><font size=-1>471     </font></a><span class="comment">		</span><span class="keyword">void</span><span class="default">*   <a href="dictionary_N.html#17745">base</a>;     </span><span class="comment">/* Pointer to base of current block of storage. */</span>
<a name="472"><font size=-1>472     </font></a><span class="comment">		</span><span class="keyword">void</span><span class="default">*   <a href="dictionary_N.html#17746">loc</a>;      </span><span class="comment">/* Current location in block to next allocate memory. */</span>
<a name="473"><font size=-1>473     </font></a><span class="comment"></span>
<a name="474"><font size=-1>474     </font></a><span class="comment">		</span><span class="keyword">void <a href="dictionary_N.html#17747">internal_init</a></span><span class="default">()</span>
<a name="475"><font size=-1>475     </font></a><span class="default">		{</span>
<a name="476"><font size=-1>476     </font></a><span class="default">			<a href="dictionary_N.html#17744">remaining</a> = </span><span class="number">0</span><span class="default">;</span>
<a name="477"><font size=-1>477     </font></a><span class="default">			<a href="dictionary_B.html#17759">base</a> = <a href="dictionary_N.html#439">NULL</a>;</span>
<a name="478"><font size=-1>478     </font></a><span class="default">			<a href="dictionary_N.html#17748">usedMemory</a> = </span><span class="number">0</span><span class="default">;</span>
<a name="479"><font size=-1>479     </font></a><span class="default">			<a href="dictionary_N.html#17749">wastedMemory</a> = </span><span class="number">0</span><span class="default">;</span>
<a name="480"><font size=-1>480     </font></a><span class="default">		}</span>
<a name="481"><font size=-1>481     </font></a><span class="default"></span>
<a name="482"><font size=-1>482     </font></a><span class="default">	</span><span class="keyword">public</span><span class="default">:</span>
<a name="483"><font size=-1>483     </font></a><span class="default">		<a href="dictionary_S.html#56">size_t</a>  <a href="dictionary_N.html#17748">usedMemory</a>;</span>
<a name="484"><font size=-1>484     </font></a><span class="default">		<a href="dictionary_S.html#56">size_t</a>  <a href="dictionary_N.html#17749">wastedMemory</a>;</span>
<a name="485"><font size=-1>485     </font></a><span class="default"></span>
<a name="486"><font size=-1>486     </font></a><span class="default">		</span><span class="comment">/**</span>
<a name="487"><font size=-1>487     </font></a><span class="comment">		    Default constructor. Initializes a new pool.</span>
<a name="488"><font size=-1>488     </font></a><span class="comment">		 */</span>
<a name="489"><font size=-1>489     </font></a><span class="comment">		<a href="dictionary_N.html#17750">PooledAllocator</a></span><span class="default">() {</span>
<a name="490"><font size=-1>490     </font></a><span class="default">			<a href="dictionary_N.html#17747">internal_init</a>();</span>
<a name="491"><font size=-1>491     </font></a><span class="default">		}</span>
<a name="492"><font size=-1>492     </font></a><span class="default"></span>
<a name="493"><font size=-1>493     </font></a><span class="default">		</span><span class="comment">/**</span>
<a name="494"><font size=-1>494     </font></a><span class="comment">		 * Destructor. Frees all the memory allocated in this pool.</span>
<a name="495"><font size=-1>495     </font></a><span class="comment">		 */</span>
<a name="496"><font size=-1>496     </font></a><span class="comment">		</span><span class="default">~<a href="dictionary_N.html#17751">PooledAllocator</a>() {</span>
<a name="497"><font size=-1>497     </font></a><span class="default">			<a href="dictionary_N.html#17752">free_all</a>();</span>
<a name="498"><font size=-1>498     </font></a><span class="default">		}</span>
<a name="499"><font size=-1>499     </font></a><span class="default"></span>
<a name="500"><font size=-1>500     </font></a><span class="default">		</span><span class="comment">/** Frees all allocated memory chunks */</span>
<a name="501"><font size=-1>501     </font></a><span class="comment">		</span><span class="keyword">void <a href="dictionary_N.html#17752">free_all</a></span><span class="default">()</span>
<a name="502"><font size=-1>502     </font></a><span class="default">		{</span>
<a name="503"><font size=-1>503     </font></a><span class="default">			</span><span class="keyword">while </span><span class="default">(<a href="dictionary_N.html#17745">base</a> != <a href="dictionary_N.html#439">NULL</a>) {</span>
<a name="504"><font size=-1>504     </font></a><span class="default">				</span><span class="keyword">void </span><span class="default">*<a href="dictionary_P.html#17760">prev</a> = *(</span><span class="keyword">static_cast</span><span class="default">&lt;</span><span class="keyword">void</span><span class="default">**&gt;( <a href="dictionary_N.html#17745">base</a>)); </span><span class="comment">/* Get pointer to prev block. */</span>
<a name="505"><font size=-1>505     </font></a><span class="comment">				</span><span class="default">::<a href="dictionary_F.html#17761">free</a>(<a href="dictionary_N.html#17745">base</a>);</span>
<a name="506"><font size=-1>506     </font></a><span class="default">				<a href="dictionary_B.html#17762">base</a> = <a href="dictionary_P.html#17760">prev</a>;</span>
<a name="507"><font size=-1>507     </font></a><span class="default">			}</span>
<a name="508"><font size=-1>508     </font></a><span class="default">			<a href="dictionary_N.html#17747">internal_init</a>();</span>
<a name="509"><font size=-1>509     </font></a><span class="default">		}</span>
<a name="510"><font size=-1>510     </font></a><span class="default"></span>
<a name="511"><font size=-1>511     </font></a><span class="default">		</span><span class="comment">/**</span>
<a name="512"><font size=-1>512     </font></a><span class="comment">		 * Returns a pointer to a piece of new memory of the given size in bytes</span>
<a name="513"><font size=-1>513     </font></a><span class="comment">		 * allocated from the pool.</span>
<a name="514"><font size=-1>514     </font></a><span class="comment">		 */</span>
<a name="515"><font size=-1>515     </font></a><span class="comment">		</span><span class="keyword">void</span><span class="default">* <a href="dictionary_N.html#17753">malloc</a>(</span><span class="keyword">const <a href="dictionary_S.html#56">size_t</a> <a href="dictionary_R.html#17754">req_size</a></span><span class="default">)</span>
<a name="516"><font size=-1>516     </font></a><span class="default">		{</span>
<a name="517"><font size=-1>517     </font></a><span class="default">			</span><span class="comment">/* Round size up to a multiple of wordsize.  The following expression</span>
<a name="518"><font size=-1>518     </font></a><span class="comment">			    only works for WORDSIZE that is a power of 2, by masking last bits of</span>
<a name="519"><font size=-1>519     </font></a><span class="comment">			    incremented size to zero.</span>
<a name="520"><font size=-1>520     </font></a><span class="comment">			 */</span>
<a name="521"><font size=-1>521     </font></a><span class="comment">			</span><span class="keyword">const <a href="dictionary_S.html#56">size_t</a> <a href="dictionary_S.html#17763">size</a> </span><span class="default">= (<a href="dictionary_R.html#17754">req_size</a> + (<a href="dictionary_N.html#17741">WORDSIZE</a> - </span><span class="number">1</span><span class="default">)) &amp; ~(<a href="dictionary_N.html#17741">WORDSIZE</a> - </span><span class="number">1</span><span class="default">);</span>
<a name="522"><font size=-1>522     </font></a><span class="default"></span>
<a name="523"><font size=-1>523     </font></a><span class="default">			</span><span class="comment">/* Check whether a new block must be allocated.  Note that the first word</span>
<a name="524"><font size=-1>524     </font></a><span class="comment">			    of a block is reserved for a pointer to the previous block.</span>
<a name="525"><font size=-1>525     </font></a><span class="comment">			 */</span>
<a name="526"><font size=-1>526     </font></a><span class="comment">			</span><span class="keyword">if </span><span class="default">(<a href="dictionary_S.html#17763">size</a> &gt; <a href="dictionary_N.html#17744">remaining</a>) {</span>
<a name="527"><font size=-1>527     </font></a><span class="default"></span>
<a name="528"><font size=-1>528     </font></a><span class="default">				<a href="dictionary_N.html#17749">wastedMemory</a> += <a href="dictionary_N.html#17744">remaining</a>;</span>
<a name="529"><font size=-1>529     </font></a><span class="default"></span>
<a name="530"><font size=-1>530     </font></a><span class="default">				</span><span class="comment">/* Allocate new storage. */</span>
<a name="531"><font size=-1>531     </font></a><span class="comment">				</span><span class="keyword">const <a href="dictionary_S.html#56">size_t</a> <a href="dictionary_B.html#17764">blocksize</a> </span><span class="default">= (<a href="dictionary_S.html#17763">size</a> + </span><span class="keyword">sizeof</span><span class="default">(</span><span class="keyword">void</span><span class="default">*) + (<a href="dictionary_N.html#17741">WORDSIZE</a>-</span><span class="number">1</span><span class="default">) &gt; <a href="dictionary_N.html#17742">BLOCKSIZE</a>) ?</span>
<a name="532"><font size=-1>532     </font></a><span class="default">							<a href="dictionary_S.html#17763">size</a> + </span><span class="keyword">sizeof</span><span class="default">(</span><span class="keyword">void</span><span class="default">*) + (<a href="dictionary_N.html#17741">WORDSIZE</a>-</span><span class="number">1</span><span class="default">) : <a href="dictionary_N.html#17742">BLOCKSIZE</a>;</span>
<a name="533"><font size=-1>533     </font></a><span class="default"></span>
<a name="534"><font size=-1>534     </font></a><span class="default">				</span><span class="comment">// use the standard C malloc to allocate memory</span>
<a name="535"><font size=-1>535     </font></a><span class="comment">				</span><span class="keyword">void</span><span class="default">* <a href="dictionary_M.html#17765">m</a> = ::<a href="dictionary_M.html#14195">malloc</a>(<a href="dictionary_B.html#17764">blocksize</a>);</span>
<a name="536"><font size=-1>536     </font></a><span class="default">				</span><span class="keyword">if </span><span class="default">(!<a href="dictionary_M.html#17765">m</a>) {</span>
<a name="537"><font size=-1>537     </font></a><span class="default">					<a href="dictionary_F.html#17766">fprintf</a>(<a href="dictionary_S.html#17767">stderr</a>,</span><span class="string">&quot;Failed to allocate memory.\n&quot;</span><span class="default">);</span>
<a name="538"><font size=-1>538     </font></a><span class="default">					</span><span class="keyword">return <a href="dictionary_N.html#439">NULL</a></span><span class="default">;</span>
<a name="539"><font size=-1>539     </font></a><span class="default">				}</span>
<a name="540"><font size=-1>540     </font></a><span class="default"></span>
<a name="541"><font size=-1>541     </font></a><span class="default">				</span><span class="comment">/* Fill first word of new block with pointer to previous block. */</span>
<a name="542"><font size=-1>542     </font></a><span class="comment">				</span><span class="keyword">static_cast</span><span class="default">&lt;</span><span class="keyword">void</span><span class="default">**&gt;(<a href="dictionary_M.html#17765">m</a>)[</span><span class="number">0</span><span class="default">] = <a href="dictionary_N.html#17745">base</a>;</span>
<a name="543"><font size=-1>543     </font></a><span class="default">				<a href="dictionary_B.html#17768">base</a> = <a href="dictionary_M.html#17765">m</a>;</span>
<a name="544"><font size=-1>544     </font></a><span class="default"></span>
<a name="545"><font size=-1>545     </font></a><span class="default">				<a href="dictionary_S.html#56">size_t</a> <a href="dictionary_S.html#17769">shift</a> = </span><span class="number">0</span><span class="default">;</span>
<a name="546"><font size=-1>546     </font></a><span class="default">				</span><span class="comment">//int size_t = (WORDSIZE - ( (((size_t)m) + sizeof(void*)) &amp; (WORDSIZE-1))) &amp; (WORDSIZE-1);</span>
<a name="547"><font size=-1>547     </font></a><span class="comment"></span>
<a name="548"><font size=-1>548     </font></a><span class="comment">				<a href="dictionary_N.html#17744">remaining</a> </span><span class="default">= <a href="dictionary_B.html#17764">blocksize</a> - </span><span class="keyword">sizeof</span><span class="default">(</span><span class="keyword">void</span><span class="default">*) - <a href="dictionary_S.html#17769">shift</a>;</span>
<a name="549"><font size=-1>549     </font></a><span class="default">				<a href="dictionary_N.html#17746">loc</a> = (</span><span class="keyword">static_cast</span><span class="default">&lt;</span><span class="keyword">char</span><span class="default">*&gt;(<a href="dictionary_M.html#17765">m</a>) + </span><span class="keyword">sizeof</span><span class="default">(</span><span class="keyword">void</span><span class="default">*) + <a href="dictionary_S.html#17769">shift</a>);</span>
<a name="550"><font size=-1>550     </font></a><span class="default">			}</span>
<a name="551"><font size=-1>551     </font></a><span class="default">			</span><span class="keyword">void</span><span class="default">* <a href="dictionary_R.html#17770">rloc</a> = <a href="dictionary_N.html#17746">loc</a>;</span>
<a name="552"><font size=-1>552     </font></a><span class="default">			<a href="dictionary_N.html#17746">loc</a> = </span><span class="keyword">static_cast</span><span class="default">&lt;</span><span class="keyword">char</span><span class="default">*&gt;(<a href="dictionary_N.html#17746">loc</a>) + <a href="dictionary_S.html#17763">size</a>;</span>
<a name="553"><font size=-1>553     </font></a><span class="default">			<a href="dictionary_N.html#17744">remaining</a> -= <a href="dictionary_S.html#17763">size</a>;</span>
<a name="554"><font size=-1>554     </font></a><span class="default"></span>
<a name="555"><font size=-1>555     </font></a><span class="default">			<a href="dictionary_N.html#17748">usedMemory</a> += <a href="dictionary_S.html#17763">size</a>;</span>
<a name="556"><font size=-1>556     </font></a><span class="default"></span>
<a name="557"><font size=-1>557     </font></a><span class="default">			</span><span class="keyword">return <a href="dictionary_R.html#17770">rloc</a></span><span class="default">;</span>
<a name="558"><font size=-1>558     </font></a><span class="default">		}</span>
<a name="559"><font size=-1>559     </font></a><span class="default"></span>
<a name="560"><font size=-1>560     </font></a><span class="default">		</span><span class="comment">/**</span>
<a name="561"><font size=-1>561     </font></a><span class="comment">		 * Allocates (using this pool) a generic type T.</span>
<a name="562"><font size=-1>562     </font></a><span class="comment">		 *</span>
<a name="563"><font size=-1>563     </font></a><span class="comment">		 * Params:</span>
<a name="564"><font size=-1>564     </font></a><span class="comment">		 *     count = number of instances to allocate.</span>
<a name="565"><font size=-1>565     </font></a><span class="comment">		 * Returns: pointer (of type T*) to memory buffer</span>
<a name="566"><font size=-1>566     </font></a><span class="comment">		 */</span>
<a name="567"><font size=-1>567     </font></a><span class="comment">		</span><span class="keyword">template </span><span class="default">&lt;</span><span class="keyword">typename <a href="dictionary_T.html#17757">T</a></span><span class="default">&gt;</span>
<a name="568"><font size=-1>568     </font></a><span class="default">		<a href="dictionary_T.html#17757">T</a>* <a href="dictionary_N.html#17756">allocate</a>(</span><span class="keyword">const <a href="dictionary_S.html#56">size_t</a> <a href="dictionary_C.html#17758">count</a> </span><span class="default">= </span><span class="number">1</span><span class="default">)</span>
<a name="569"><font size=-1>569     </font></a><span class="default">		{</span>
<a name="570"><font size=-1>570     </font></a><span class="default">			<a href="dictionary_T.html#17757">T</a>* <a href="dictionary_M.html#17771">mem</a> = </span><span class="keyword">static_cast</span><span class="default">&lt;<a href="dictionary_T.html#17757">T</a>*&gt;(</span><span class="keyword">this</span><span class="default">-&gt;<a href="dictionary_N.html#17753">malloc</a>(</span><span class="keyword">sizeof</span><span class="default">(<a href="dictionary_T.html#806">T</a>)*<a href="dictionary_C.html#17758">count</a>));</span>
<a name="571"><font size=-1>571     </font></a><span class="default">			</span><span class="keyword">return <a href="dictionary_M.html#17771">mem</a></span><span class="default">;</span>
<a name="572"><font size=-1>572     </font></a><span class="default">		}</span>
<a name="573"><font size=-1>573     </font></a><span class="default"></span>
<a name="574"><font size=-1>574     </font></a><span class="default">	};</span>
<a name="575"><font size=-1>575     </font></a><span class="default">	</span><span class="comment">/** @} */</span>
<a name="576"><font size=-1>576     </font></a><span class="comment"></span>
<a name="577"><font size=-1>577     </font></a><span class="comment">	/** @addtogroup nanoflann_metaprog_grp Auxiliary metaprogramming stuff</span>
<a name="578"><font size=-1>578     </font></a><span class="comment">	  * @{ */</span>
<a name="579"><font size=-1>579     </font></a><span class="comment"></span>
<a name="580"><font size=-1>580     </font></a><span class="comment">	// ----------------  CArray -------------------------</span>
<a name="581"><font size=-1>581     </font></a><span class="comment">	/** A STL container (as wrapper) for arrays of constant size defined at compile time (class imported from the MRPT project)</span>
<a name="582"><font size=-1>582     </font></a><span class="comment">	 * This code is an adapted version from Boost, modifed for its integration</span>
<a name="583"><font size=-1>583     </font></a><span class="comment">	 *	within MRPT (JLBC, Dec/2009) (Renamed array -&gt; CArray to avoid possible potential conflicts).</span>
<a name="584"><font size=-1>584     </font></a><span class="comment">	 * See</span>
<a name="585"><font size=-1>585     </font></a><span class="comment">	 *      http://www.josuttis.com/cppcode</span>
<a name="586"><font size=-1>586     </font></a><span class="comment">	 * for details and the latest version.</span>
<a name="587"><font size=-1>587     </font></a><span class="comment">	 * See</span>
<a name="588"><font size=-1>588     </font></a><span class="comment">	 *      http://www.boost.org/libs/array for Documentation.</span>
<a name="589"><font size=-1>589     </font></a><span class="comment">	 * for documentation.</span>
<a name="590"><font size=-1>590     </font></a><span class="comment">	 *</span>
<a name="591"><font size=-1>591     </font></a><span class="comment">	 * (C) Copyright Nicolai M. Josuttis 2001.</span>
<a name="592"><font size=-1>592     </font></a><span class="comment">	 * Permission to copy, use, modify, sell and distribute this software</span>
<a name="593"><font size=-1>593     </font></a><span class="comment">	 * is granted provided this copyright notice appears in all copies.</span>
<a name="594"><font size=-1>594     </font></a><span class="comment">	 * This software is provided &quot;as is&quot; without express or implied</span>
<a name="595"><font size=-1>595     </font></a><span class="comment">	 * warranty, and with no claim as to its suitability for any purpose.</span>
<a name="596"><font size=-1>596     </font></a><span class="comment">	 *</span>
<a name="597"><font size=-1>597     </font></a><span class="comment">	 * 29 Jan 2004 - minor fixes (Nico Josuttis)</span>
<a name="598"><font size=-1>598     </font></a><span class="comment">	 * 04 Dec 2003 - update to synch with library TR1 (Alisdair Meredith)</span>
<a name="599"><font size=-1>599     </font></a><span class="comment">	 * 23 Aug 2002 - fix for Non-MSVC compilers combined with MSVC libraries.</span>
<a name="600"><font size=-1>600     </font></a><span class="comment">	 * 05 Aug 2001 - minor update (Nico Josuttis)</span>
<a name="601"><font size=-1>601     </font></a><span class="comment">	 * 20 Jan 2001 - STLport fix (Beman Dawes)</span>
<a name="602"><font size=-1>602     </font></a><span class="comment">	 * 29 Sep 2000 - Initial Revision (Nico Josuttis)</span>
<a name="603"><font size=-1>603     </font></a><span class="comment">	 *</span>
<a name="604"><font size=-1>604     </font></a><span class="comment">	 * Jan 30, 2004</span>
<a name="605"><font size=-1>605     </font></a><span class="comment">	 */</span>
<a name="606"><font size=-1>606     </font></a><span class="comment">    </span><span class="keyword">template </span><span class="default">&lt;</span><span class="keyword">typename <a href="dictionary_N.html#17773">T</a></span><span class="default">, std::<a href="dictionary_S.html#684">size_t</a> <a href="dictionary_N.html#17774">N</a>&gt;</span>
<a name="607"><font size=-1>607     </font></a><span class="default">    </span><span class="keyword">class <a href="dictionary_N.html#17772">CArray</a> </span><span class="default">{</span>
<a name="608"><font size=-1>608     </font></a><span class="default">      </span><span class="keyword">public</span><span class="default">:</span>
<a name="609"><font size=-1>609     </font></a><span class="default">        <a href="dictionary_N.html#17773">T</a> <a href="dictionary_N.html#17775">elems</a>[<a href="dictionary_N.html#17774">N</a>];    </span><span class="comment">// fixed-size array of elements of type T</span>
<a name="610"><font size=-1>610     </font></a><span class="comment"></span>
<a name="611"><font size=-1>611     </font></a><span class="comment">      </span><span class="keyword">public</span><span class="default">:</span>
<a name="612"><font size=-1>612     </font></a><span class="default">        </span><span class="comment">// type definitions</span>
<a name="613"><font size=-1>613     </font></a><span class="comment">        </span><span class="keyword">typedef <a href="dictionary_N.html#17773">T</a>              <a href="dictionary_N.html#17776">value_type</a></span><span class="default">;</span>
<a name="614"><font size=-1>614     </font></a><span class="default">        </span><span class="keyword">typedef <a href="dictionary_N.html#17773">T</a></span><span class="default">*             <a href="dictionary_N.html#17777">iterator</a>;</span>
<a name="615"><font size=-1>615     </font></a><span class="default">        </span><span class="keyword">typedef const <a href="dictionary_N.html#17773">T</a></span><span class="default">*       <a href="dictionary_N.html#17778">const_iterator</a>;</span>
<a name="616"><font size=-1>616     </font></a><span class="default">        </span><span class="keyword">typedef <a href="dictionary_N.html#17773">T</a></span><span class="default">&amp;             <a href="dictionary_N.html#17779">reference</a>;</span>
<a name="617"><font size=-1>617     </font></a><span class="default">        </span><span class="keyword">typedef const <a href="dictionary_N.html#17773">T</a></span><span class="default">&amp;       <a href="dictionary_N.html#17780">const_reference</a>;</span>
<a name="618"><font size=-1>618     </font></a><span class="default">        </span><span class="keyword">typedef </span><span class="default">std::<a href="dictionary_S.html#684">size_t</a>    <a href="dictionary_N.html#17781">size_type</a>;</span>
<a name="619"><font size=-1>619     </font></a><span class="default">        </span><span class="keyword">typedef </span><span class="default">std::<a href="dictionary_S.html#686">ptrdiff_t</a> <a href="dictionary_N.html#17782">difference_type</a>;</span>
<a name="620"><font size=-1>620     </font></a><span class="default"></span>
<a name="621"><font size=-1>621     </font></a><span class="default">        </span><span class="comment">// iterator support</span>
<a name="622"><font size=-1>622     </font></a><span class="comment">        </span><span class="keyword">inline <a href="dictionary_N.html#17777">iterator</a> <a href="dictionary_N.html#17783">begin</a></span><span class="default">() { </span><span class="keyword">return <a href="dictionary_N.html#17775">elems</a></span><span class="default">; }</span>
<a name="623"><font size=-1>623     </font></a><span class="default">        </span><span class="keyword">inline <a href="dictionary_N.html#17778">const_iterator</a> <a href="dictionary_N.html#17784">begin</a></span><span class="default">() </span><span class="keyword">const </span><span class="default">{ </span><span class="keyword">return <a href="dictionary_N.html#17775">elems</a></span><span class="default">; }</span>
<a name="624"><font size=-1>624     </font></a><span class="default">        </span><span class="keyword">inline <a href="dictionary_N.html#17777">iterator</a> <a href="dictionary_N.html#17785">end</a></span><span class="default">() { </span><span class="keyword">return <a href="dictionary_N.html#17775">elems</a></span><span class="default">+<a href="dictionary_N.html#17774">N</a>; }</span>
<a name="625"><font size=-1>625     </font></a><span class="default">        </span><span class="keyword">inline <a href="dictionary_N.html#17778">const_iterator</a> <a href="dictionary_N.html#17786">end</a></span><span class="default">() </span><span class="keyword">const </span><span class="default">{ </span><span class="keyword">return <a href="dictionary_N.html#17775">elems</a></span><span class="default">+<a href="dictionary_N.html#17774">N</a>; }</span>
<a name="626"><font size=-1>626     </font></a><span class="default"></span>
<a name="627"><font size=-1>627     </font></a><span class="default">        </span><span class="comment">// reverse iterator support</span>
<a name="628"><font size=-1>628     </font></a><span class="comment"></span><span class="preproc">#if </span><span class="default">!</span><span class="preproc">defined</span><span class="default">(<a href="dictionary_B.html#16952">BOOST_NO_TEMPLATE_PARTIAL_SPECIALIZATION</a>) &amp;&amp; !</span><span class="preproc">defined</span><span class="default">(<a href="dictionary_B.html#16953">BOOST_MSVC_STD_ITERATOR</a>) &amp;&amp; !</span><span class="preproc">defined</span><span class="default">(<a href="dictionary_B.html#16954">BOOST_NO_STD_ITERATOR_TRAITS</a>)</span>
<a name="629"><font size=-1>629     </font></a><span class="default">        </span><span class="keyword">typedef </span><span class="default">std::<a href="dictionary_S.html#2818">reverse_iterator</a>&lt;iterator&gt; <a href="dictionary_N.html#17787">reverse_iterator</a>;</span>
<a name="630"><font size=-1>630     </font></a><span class="default">        </span><span class="keyword">typedef </span><span class="default">std::<a href="dictionary_S.html#2818">reverse_iterator</a>&lt;const_iterator&gt; <a href="dictionary_N.html#17788">const_reverse_iterator</a>;</span>
<a name="631"><font size=-1>631     </font></a><span class="default"></span><span class="preproc">#elif defined</span><span class="default">(<a href="dictionary_Non-Alpha.html#1000">_MSC_VER</a>) &amp;&amp; (_MSC_VER == </span><span class="number">1300</span><span class="default">) &amp;&amp; </span><span class="preproc">defined</span><span class="default">(<a href="dictionary_B.html#16957">BOOST_DINKUMWARE_STDLIB</a>) &amp;&amp; (BOOST_DINKUMWARE_STDLIB == </span><span class="number">310</span><span class="default">)</span>
<a name="632"><font size=-1>632     </font></a><span class="default">        </span><span class="comment">// workaround for broken reverse_iterator in VC7</span>
<a name="633"><font size=-1>633     </font></a><span class="comment">        </span><span class="keyword">typedef </span><span class="default">std::<a href="dictionary_N.html#17787">reverse_iterator</a>&lt;std::_Ptrit&lt;<a href="dictionary_N.html#17776">value_type</a>, <a href="dictionary_N.html#17782">difference_type</a>, <a href="dictionary_N.html#17777">iterator</a>,</span>
<a name="634"><font size=-1>634     </font></a><span class="default">                                      <a href="dictionary_N.html#17779">reference</a>, <a href="dictionary_N.html#17777">iterator</a>, <a href="dictionary_N.html#17779">reference</a>&gt; &gt; <a href="dictionary_N.html#17787">reverse_iterator</a>;</span>
<a name="635"><font size=-1>635     </font></a><span class="default">        </span><span class="keyword">typedef </span><span class="default">std::<a href="dictionary_N.html#17787">reverse_iterator</a>&lt;std::_Ptrit&lt;<a href="dictionary_N.html#17776">value_type</a>, <a href="dictionary_N.html#17782">difference_type</a>, <a href="dictionary_N.html#17778">const_iterator</a>,</span>
<a name="636"><font size=-1>636     </font></a><span class="default">                                      <a href="dictionary_N.html#17780">const_reference</a>, <a href="dictionary_N.html#17777">iterator</a>, <a href="dictionary_N.html#17779">reference</a>&gt; &gt; <a href="dictionary_N.html#17788">const_reverse_iterator</a>;</span>
<a name="637"><font size=-1>637     </font></a><span class="default"></span><span class="preproc">#else</span>
<a name="638"><font size=-1>638     </font></a><span class="preproc">        </span><span class="comment">// workaround for broken reverse_iterator implementations</span>
<a name="639"><font size=-1>639     </font></a><span class="comment">        </span><span class="keyword">typedef </span><span class="default">std::<a href="dictionary_N.html#17787">reverse_iterator</a>&lt;<a href="dictionary_N.html#17777">iterator</a>,<a href="dictionary_N.html#17773">T</a>&gt; <a href="dictionary_N.html#17787">reverse_iterator</a>;</span>
<a name="640"><font size=-1>640     </font></a><span class="default">        </span><span class="keyword">typedef </span><span class="default">std::<a href="dictionary_N.html#17787">reverse_iterator</a>&lt;<a href="dictionary_N.html#17778">const_iterator</a>,<a href="dictionary_N.html#17773">T</a>&gt; <a href="dictionary_N.html#17788">const_reverse_iterator</a>;</span>
<a name="641"><font size=-1>641     </font></a><span class="default"></span><span class="preproc">#endif</span>
<a name="642"><font size=-1>642     </font></a><span class="preproc"></span>
<a name="643"><font size=-1>643     </font></a><span class="preproc">        <a href="dictionary_N.html#17787">reverse_iterator</a> <a href="dictionary_N.html#17789">rbegin</a></span><span class="default">() { </span><span class="keyword">return <a href="dictionary_N.html#17787">reverse_iterator</a></span><span class="default">(<a href="dictionary_N.html#17785">end</a>()); }</span>
<a name="644"><font size=-1>644     </font></a><span class="default">        <a href="dictionary_N.html#17788">const_reverse_iterator</a> <a href="dictionary_N.html#17790">rbegin</a>() </span><span class="keyword">const </span><span class="default">{ </span><span class="keyword">return <a href="dictionary_N.html#17788">const_reverse_iterator</a></span><span class="default">(<a href="dictionary_N.html#17785">end</a>()); }</span>
<a name="645"><font size=-1>645     </font></a><span class="default">        <a href="dictionary_N.html#17787">reverse_iterator</a> <a href="dictionary_N.html#17791">rend</a>() { </span><span class="keyword">return <a href="dictionary_N.html#17787">reverse_iterator</a></span><span class="default">(<a href="dictionary_N.html#17783">begin</a>()); }</span>
<a name="646"><font size=-1>646     </font></a><span class="default">        <a href="dictionary_N.html#17788">const_reverse_iterator</a> <a href="dictionary_N.html#17792">rend</a>() </span><span class="keyword">const </span><span class="default">{ </span><span class="keyword">return <a href="dictionary_N.html#17788">const_reverse_iterator</a></span><span class="default">(<a href="dictionary_N.html#17783">begin</a>()); }</span>
<a name="647"><font size=-1>647     </font></a><span class="default">        </span><span class="comment">// operator[]</span>
<a name="648"><font size=-1>648     </font></a><span class="comment">        </span><span class="keyword">inline <a href="dictionary_N.html#17779">reference</a> operator</span><span class="default">[](<a href="dictionary_N.html#17781">size_type</a> <a href="dictionary_I.html#17794">i</a>) { </span><span class="keyword">return <a href="dictionary_N.html#17775">elems</a></span><span class="default">[<a href="dictionary_I.html#17794">i</a>]; }</span>
<a name="649"><font size=-1>649     </font></a><span class="default">        </span><span class="keyword">inline <a href="dictionary_N.html#17780">const_reference</a> operator</span><span class="default">[](<a href="dictionary_N.html#17781">size_type</a> <a href="dictionary_I.html#17796">i</a>) </span><span class="keyword">const </span><span class="default">{ </span><span class="keyword">return <a href="dictionary_N.html#17775">elems</a></span><span class="default">[<a href="dictionary_I.html#17796">i</a>]; }</span>
<a name="650"><font size=-1>650     </font></a><span class="default">        </span><span class="comment">// at() with range check</span>
<a name="651"><font size=-1>651     </font></a><span class="comment">        <a href="dictionary_N.html#17779">reference</a> <a href="dictionary_N.html#17797">at</a></span><span class="default">(<a href="dictionary_N.html#17781">size_type</a> <a href="dictionary_I.html#17798">i</a>) { <a href="dictionary_N.html#17824">rangecheck</a>(<a href="dictionary_I.html#17798">i</a>); </span><span class="keyword">return <a href="dictionary_N.html#17775">elems</a></span><span class="default">[<a href="dictionary_I.html#17798">i</a>]; }</span>
<a name="652"><font size=-1>652     </font></a><span class="default">        <a href="dictionary_N.html#17780">const_reference</a> <a href="dictionary_N.html#17799">at</a>(<a href="dictionary_N.html#17781">size_type</a> <a href="dictionary_I.html#17800">i</a>) </span><span class="keyword">const </span><span class="default">{ <a href="dictionary_N.html#17824">rangecheck</a>(<a href="dictionary_I.html#17800">i</a>); </span><span class="keyword">return <a href="dictionary_N.html#17775">elems</a></span><span class="default">[<a href="dictionary_I.html#17800">i</a>]; }</span>
<a name="653"><font size=-1>653     </font></a><span class="default">        </span><span class="comment">// front() and back()</span>
<a name="654"><font size=-1>654     </font></a><span class="comment">        <a href="dictionary_N.html#17779">reference</a> <a href="dictionary_N.html#17801">front</a></span><span class="default">() { </span><span class="keyword">return <a href="dictionary_N.html#17775">elems</a></span><span class="default">[</span><span class="number">0</span><span class="default">]; }</span>
<a name="655"><font size=-1>655     </font></a><span class="default">        <a href="dictionary_N.html#17780">const_reference</a> <a href="dictionary_N.html#17802">front</a>() </span><span class="keyword">const </span><span class="default">{ </span><span class="keyword">return <a href="dictionary_N.html#17775">elems</a></span><span class="default">[</span><span class="number">0</span><span class="default">]; }</span>
<a name="656"><font size=-1>656     </font></a><span class="default">        <a href="dictionary_N.html#17779">reference</a> <a href="dictionary_N.html#17803">back</a>() { </span><span class="keyword">return <a href="dictionary_N.html#17775">elems</a></span><span class="default">[<a href="dictionary_N.html#17774">N</a>-</span><span class="number">1</span><span class="default">]; }</span>
<a name="657"><font size=-1>657     </font></a><span class="default">        <a href="dictionary_N.html#17780">const_reference</a> <a href="dictionary_N.html#17804">back</a>() </span><span class="keyword">const </span><span class="default">{ </span><span class="keyword">return <a href="dictionary_N.html#17775">elems</a></span><span class="default">[<a href="dictionary_N.html#17774">N</a>-</span><span class="number">1</span><span class="default">]; }</span>
<a name="658"><font size=-1>658     </font></a><span class="default">        </span><span class="comment">// size is constant</span>
<a name="659"><font size=-1>659     </font></a><span class="comment">        </span><span class="keyword">static inline <a href="dictionary_N.html#17781">size_type</a> <a href="dictionary_N.html#17805">size</a></span><span class="default">() { </span><span class="keyword">return <a href="dictionary_N.html#17774">N</a></span><span class="default">; }</span>
<a name="660"><font size=-1>660     </font></a><span class="default">        </span><span class="keyword">static bool <a href="dictionary_N.html#17806">empty</a></span><span class="default">() { </span><span class="keyword">return false</span><span class="default">; }</span>
<a name="661"><font size=-1>661     </font></a><span class="default">        </span><span class="keyword">static <a href="dictionary_N.html#17781">size_type</a> <a href="dictionary_N.html#17807">max_size</a></span><span class="default">() { </span><span class="keyword">return <a href="dictionary_N.html#17774">N</a></span><span class="default">; }</span>
<a name="662"><font size=-1>662     </font></a><span class="default">        </span><span class="keyword">enum </span><span class="default">{ static_size = <a href="dictionary_N.html#17774">N</a> };</span>
<a name="663"><font size=-1>663     </font></a><span class="default">		</span><span class="comment">/** This method has no effects in this class, but raises an exception if the expected size does not match */</span>
<a name="664"><font size=-1>664     </font></a><span class="comment">		</span><span class="keyword">inline void <a href="dictionary_N.html#17810">resize</a></span><span class="default">(</span><span class="keyword">const <a href="dictionary_S.html#56">size_t</a> <a href="dictionary_N.html#17811">nElements</a></span><span class="default">) { </span><span class="keyword">if </span><span class="default">(<a href="dictionary_N.html#17811">nElements</a>!=<a href="dictionary_N.html#17774">N</a>) </span><span class="keyword">throw </span><span class="default">std::<a href="dictionary_S.html#150">logic_error</a>(</span><span class="string">&quot;Try to change the size of a CArray.&quot;</span><span class="default">); }</span>
<a name="665"><font size=-1>665     </font></a><span class="default">        </span><span class="comment">// swap (note: linear complexity in N, constant for given instantiation)</span>
<a name="666"><font size=-1>666     </font></a><span class="comment">        </span><span class="keyword">void <a href="dictionary_N.html#17812">swap</a> </span><span class="default">(<a href="dictionary_N.html#17772">CArray</a>&lt;T,N&gt;&amp; <a href="dictionary_Y.html#17813">y</a>) { std::<a href="dictionary_S.html#16999">swap_ranges</a>(<a href="dictionary_N.html#17783">begin</a>(),<a href="dictionary_N.html#17785">end</a>(),<a href="dictionary_Y.html#17813">y</a>.<a href="dictionary_N.html#17783">begin</a>()); }</span>
<a name="667"><font size=-1>667     </font></a><span class="default">        </span><span class="comment">// direct access to data (read-only)</span>
<a name="668"><font size=-1>668     </font></a><span class="comment">        </span><span class="keyword">const <a href="dictionary_N.html#17773">T</a></span><span class="default">* <a href="dictionary_N.html#17814">data</a>() </span><span class="keyword">const </span><span class="default">{ </span><span class="keyword">return <a href="dictionary_N.html#17775">elems</a></span><span class="default">; }</span>
<a name="669"><font size=-1>669     </font></a><span class="default">        </span><span class="comment">// use array as C array (direct read/write access to data)</span>
<a name="670"><font size=-1>670     </font></a><span class="comment">        <a href="dictionary_N.html#17773">T</a></span><span class="default">* <a href="dictionary_N.html#17815">data</a>() { </span><span class="keyword">return <a href="dictionary_N.html#17775">elems</a></span><span class="default">; }</span>
<a name="671"><font size=-1>671     </font></a><span class="default">        </span><span class="comment">// assignment with type conversion</span>
<a name="672"><font size=-1>672     </font></a><span class="comment">        </span><span class="keyword">template </span><span class="default">&lt;</span><span class="keyword">typename <a href="dictionary_T.html#17817">T2</a></span><span class="default">&gt; <a href="dictionary_N.html#17772">CArray</a>&lt;T,N&gt;&amp; </span><span class="keyword">operator</span><span class="default">= (</span><span class="keyword">const <a href="dictionary_N.html#17772">CArray</a></span><span class="default">&lt;T2,N&gt;&amp; <a href="dictionary_R.html#17818">rhs</a>) {</span>
<a name="673"><font size=-1>673     </font></a><span class="default">            std::<a href="dictionary_S.html#4090">copy</a>(<a href="dictionary_R.html#17818">rhs</a>.<a href="dictionary_N.html#17783">begin</a>(),<a href="dictionary_R.html#17818">rhs</a>.<a href="dictionary_N.html#17785">end</a>(), <a href="dictionary_N.html#17783">begin</a>());</span>
<a name="674"><font size=-1>674     </font></a><span class="default">            </span><span class="keyword">return </span><span class="default">*</span><span class="keyword">this</span><span class="default">;</span>
<a name="675"><font size=-1>675     </font></a><span class="default">        }</span>
<a name="676"><font size=-1>676     </font></a><span class="default">        </span><span class="comment">// assign one value to all elements</span>
<a name="677"><font size=-1>677     </font></a><span class="comment">        </span><span class="keyword">inline void <a href="dictionary_N.html#17819">assign</a> </span><span class="default">(</span><span class="keyword">const <a href="dictionary_N.html#17773">T</a></span><span class="default">&amp; <a href="dictionary_V.html#17820">value</a>) { </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#56">size_t</a> <a href="dictionary_I.html#17826">i</a>=</span><span class="number">0</span><span class="default">;<a href="dictionary_I.html#17826">i</a>&lt;<a href="dictionary_N.html#17774">N</a>;<a href="dictionary_I.html#17826">i</a>++) <a href="dictionary_N.html#17775">elems</a>[<a href="dictionary_I.html#17826">i</a>]=<a href="dictionary_V.html#17820">value</a>; }</span>
<a name="678"><font size=-1>678     </font></a><span class="default">        </span><span class="comment">// assign (compatible with std::vector's one) (by JLBC for MRPT)</span>
<a name="679"><font size=-1>679     </font></a><span class="comment">        </span><span class="keyword">void <a href="dictionary_N.html#17821">assign</a> </span><span class="default">(</span><span class="keyword">const <a href="dictionary_S.html#56">size_t</a> <a href="dictionary_N.html#17822">n</a></span><span class="default">, </span><span class="keyword">const <a href="dictionary_N.html#17773">T</a></span><span class="default">&amp; <a href="dictionary_V.html#17823">value</a>) { <a href="dictionary_A.html#8782">assert</a>(<a href="dictionary_N.html#17774">N</a>==<a href="dictionary_N.html#17822">n</a>); </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#56">size_t</a> <a href="dictionary_I.html#17827">i</a>=</span><span class="number">0</span><span class="default">;<a href="dictionary_I.html#17827">i</a>&lt;<a href="dictionary_N.html#17774">N</a>;<a href="dictionary_I.html#17827">i</a>++) <a href="dictionary_N.html#17775">elems</a>[<a href="dictionary_I.html#17827">i</a>]=<a href="dictionary_V.html#17823">value</a>; }</span>
<a name="680"><font size=-1>680     </font></a><span class="default">      </span><span class="keyword">private</span><span class="default">:</span>
<a name="681"><font size=-1>681     </font></a><span class="default">        </span><span class="comment">// check range (may be private because it is static)</span>
<a name="682"><font size=-1>682     </font></a><span class="comment">        </span><span class="keyword">static void <a href="dictionary_N.html#17824">rangecheck</a> </span><span class="default">(<a href="dictionary_N.html#17781">size_type</a> <a href="dictionary_I.html#17825">i</a>) { </span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#17825">i</a> &gt;= <a href="dictionary_N.html#17805">size</a>()) { </span><span class="keyword">throw </span><span class="default">std::<a href="dictionary_S.html#104">out_of_range</a>(</span><span class="string">&quot;CArray&lt;&gt;: index out of range&quot;</span><span class="default">); } }</span>
<a name="683"><font size=-1>683     </font></a><span class="default">    }; </span><span class="comment">// end of CArray</span>
<a name="684"><font size=-1>684     </font></a><span class="comment"></span>
<a name="685"><font size=-1>685     </font></a><span class="comment">	/** Used to declare fixed-size arrays when DIM&gt;0, dynamically-allocated vectors when DIM=-1.</span>
<a name="686"><font size=-1>686     </font></a><span class="comment">	  * Fixed size version for a generic DIM:</span>
<a name="687"><font size=-1>687     </font></a><span class="comment">	  */</span>
<a name="688"><font size=-1>688     </font></a><span class="comment">	</span><span class="keyword">template </span><span class="default">&lt;</span><span class="keyword">int <a href="dictionary_N.html#17829">DIM</a></span><span class="default">, </span><span class="keyword">typename <a href="dictionary_N.html#17830">T</a></span><span class="default">&gt;</span>
<a name="689"><font size=-1>689     </font></a><span class="default">	</span><span class="keyword">struct <a href="dictionary_N.html#17828">array_or_vector_selector</a></span>
<a name="690"><font size=-1>690     </font></a><span class="keyword">	</span><span class="default">{</span>
<a name="691"><font size=-1>691     </font></a><span class="default">		</span><span class="keyword">typedef <a href="dictionary_N.html#17772">CArray</a></span><span class="default">&lt;T,DIM&gt; <a href="dictionary_N.html#17831">container_t</a>;</span>
<a name="692"><font size=-1>692     </font></a><span class="default">	};</span>
<a name="693"><font size=-1>693     </font></a><span class="default">	</span><span class="comment">/** Dynamic size version */</span>
<a name="694"><font size=-1>694     </font></a><span class="comment">	</span><span class="keyword">template </span><span class="default">&lt;</span><span class="keyword">typename <a href="dictionary_N.html#17833">T</a></span><span class="default">&gt;</span>
<a name="695"><font size=-1>695     </font></a><span class="default">	</span><span class="keyword">struct <a href="dictionary_N.html#17832">array_or_vector_selector</a></span><span class="default">&lt;-</span><span class="number">1</span><span class="default">,T&gt; {</span>
<a name="696"><font size=-1>696     </font></a><span class="default">		</span><span class="keyword">typedef </span><span class="default">std::<a href="dictionary_S.html#74">vector</a>&lt;T&gt; <a href="dictionary_N.html#17834">container_t</a>;</span>
<a name="697"><font size=-1>697     </font></a><span class="default">	};</span>
<a name="698"><font size=-1>698     </font></a><span class="default">	</span><span class="comment">/** @} */</span>
<a name="699"><font size=-1>699     </font></a><span class="comment"></span>
<a name="700"><font size=-1>700     </font></a><span class="comment">	/** @addtogroup kdtrees_grp KD-tree classes and adaptors</span>
<a name="701"><font size=-1>701     </font></a><span class="comment">	  * @{ */</span>
<a name="702"><font size=-1>702     </font></a><span class="comment"></span>
<a name="703"><font size=-1>703     </font></a><span class="comment">	/** kd-tree index</span>
<a name="704"><font size=-1>704     </font></a><span class="comment">	 *</span>
<a name="705"><font size=-1>705     </font></a><span class="comment">	 * Contains the k-d trees and other information for indexing a set of points</span>
<a name="706"><font size=-1>706     </font></a><span class="comment">	 * for nearest-neighbor matching.</span>
<a name="707"><font size=-1>707     </font></a><span class="comment">	 *</span>
<a name="708"><font size=-1>708     </font></a><span class="comment">	 *  The class &quot;DatasetAdaptor&quot; must provide the following interface (can be non-virtual, inlined methods):</span>
<a name="709"><font size=-1>709     </font></a><span class="comment">	 *</span>
<a name="710"><font size=-1>710     </font></a><span class="comment">	 *  \code</span>
<a name="711"><font size=-1>711     </font></a><span class="comment">	 *   // Must return the number of data poins</span>
<a name="712"><font size=-1>712     </font></a><span class="comment">	 *   inline size_t kdtree_get_point_count() const { ... }</span>
<a name="713"><font size=-1>713     </font></a><span class="comment">	 *</span>
<a name="714"><font size=-1>714     </font></a><span class="comment">	 *   // [Only if using the metric_L2_Simple type] Must return the Euclidean (L2) distance between the vector &quot;p1[0:size-1]&quot; and the data point with index &quot;idx_p2&quot; stored in the class:</span>
<a name="715"><font size=-1>715     </font></a><span class="comment">	 *   inline DistanceType kdtree_distance(const T *p1, const size_t idx_p2,size_t size) const { ... }</span>
<a name="716"><font size=-1>716     </font></a><span class="comment">	 *</span>
<a name="717"><font size=-1>717     </font></a><span class="comment">	 *   // Must return the dim'th component of the idx'th point in the class:</span>
<a name="718"><font size=-1>718     </font></a><span class="comment">	 *   inline T kdtree_get_pt(const size_t idx, int dim) const { ... }</span>
<a name="719"><font size=-1>719     </font></a><span class="comment">	 *</span>
<a name="720"><font size=-1>720     </font></a><span class="comment">	 *   // Optional bounding-box computation: return false to default to a standard bbox computation loop.</span>
<a name="721"><font size=-1>721     </font></a><span class="comment">	 *   //   Return true if the BBOX was already computed by the class and returned in &quot;bb&quot; so it can be avoided to redo it again.</span>
<a name="722"><font size=-1>722     </font></a><span class="comment">	 *   //   Look at bb.size() to find out the expected dimensionality (e.g. 2 or 3 for point clouds)</span>
<a name="723"><font size=-1>723     </font></a><span class="comment">	 *   template &lt;class BBOX&gt;</span>
<a name="724"><font size=-1>724     </font></a><span class="comment">	 *   bool kdtree_get_bbox(BBOX &amp;bb) const</span>
<a name="725"><font size=-1>725     </font></a><span class="comment">	 *   {</span>
<a name="726"><font size=-1>726     </font></a><span class="comment">	 *      bb[0].low = ...; bb[0].high = ...;  // 0th dimension limits</span>
<a name="727"><font size=-1>727     </font></a><span class="comment">	 *      bb[1].low = ...; bb[1].high = ...;  // 1st dimension limits</span>
<a name="728"><font size=-1>728     </font></a><span class="comment">	 *      ...</span>
<a name="729"><font size=-1>729     </font></a><span class="comment">	 *      return true;</span>
<a name="730"><font size=-1>730     </font></a><span class="comment">	 *   }</span>
<a name="731"><font size=-1>731     </font></a><span class="comment">	 *</span>
<a name="732"><font size=-1>732     </font></a><span class="comment">	 *  \endcode</span>
<a name="733"><font size=-1>733     </font></a><span class="comment">	 *</span>
<a name="734"><font size=-1>734     </font></a><span class="comment">	 * \tparam DatasetAdaptor The user-provided adaptor (see comments above).</span>
<a name="735"><font size=-1>735     </font></a><span class="comment">	 * \tparam Distance The distance metric to use: nanoflann::metric_L1, nanoflann::metric_L2, nanoflann::metric_L2_Simple, etc.</span>
<a name="736"><font size=-1>736     </font></a><span class="comment">	 * \tparam DIM Dimensionality of data points (e.g. 3 for 3D points)</span>
<a name="737"><font size=-1>737     </font></a><span class="comment">	 * \tparam IndexType Will be typically size_t or int</span>
<a name="738"><font size=-1>738     </font></a><span class="comment">	 */</span>
<a name="739"><font size=-1>739     </font></a><span class="comment">	</span><span class="keyword">template </span><span class="default">&lt;</span><span class="keyword">typename <a href="dictionary_N.html#17836">Distance</a></span><span class="default">, </span><span class="keyword">class <a href="dictionary_N.html#17837">DatasetAdaptor</a></span><span class="default">,</span><span class="keyword">int <a href="dictionary_N.html#17838">DIM</a> </span><span class="default">= -</span><span class="number">1</span><span class="default">, </span><span class="keyword">typename <a href="dictionary_N.html#17839">IndexType</a> </span><span class="default">= size_t&gt;</span>
<a name="740"><font size=-1>740     </font></a><span class="default">	</span><span class="keyword">class <a href="dictionary_N.html#17835">KDTreeSingleIndexAdaptor</a></span>
<a name="741"><font size=-1>741     </font></a><span class="keyword">	</span><span class="default">{</span>
<a name="742"><font size=-1>742     </font></a><span class="default">	</span><span class="keyword">private</span><span class="default">:</span>
<a name="743"><font size=-1>743     </font></a><span class="default">		</span><span class="comment">/** Hidden copy constructor, to disallow copying indices (Not implemented) */</span>
<a name="744"><font size=-1>744     </font></a><span class="comment">		<a href="dictionary_N.html#17840">KDTreeSingleIndexAdaptor</a></span><span class="default">(</span><span class="keyword">const <a href="dictionary_N.html#17835">KDTreeSingleIndexAdaptor</a></span><span class="default">&lt;Distance,DatasetAdaptor,DIM,IndexType&gt;&amp;);</span>
<a name="745"><font size=-1>745     </font></a><span class="default">	</span><span class="keyword">public</span><span class="default">:</span>
<a name="746"><font size=-1>746     </font></a><span class="default">		</span><span class="keyword">typedef typename <a href="dictionary_N.html#17836">Distance</a></span><span class="default">::<a href="dictionary_N.html#17841">ElementType</a>  <a href="dictionary_N.html#17841">ElementType</a>;</span>
<a name="747"><font size=-1>747     </font></a><span class="default">		</span><span class="keyword">typedef typename <a href="dictionary_N.html#17836">Distance</a></span><span class="default">::<a href="dictionary_N.html#17842">DistanceType</a> <a href="dictionary_N.html#17842">DistanceType</a>;</span>
<a name="748"><font size=-1>748     </font></a><span class="default">	</span><span class="keyword">protected</span><span class="default">:</span>
<a name="749"><font size=-1>749     </font></a><span class="default"></span>
<a name="750"><font size=-1>750     </font></a><span class="default">		</span><span class="comment">/**</span>
<a name="751"><font size=-1>751     </font></a><span class="comment">		 *  Array of indices to vectors in the dataset.</span>
<a name="752"><font size=-1>752     </font></a><span class="comment">		 */</span>
<a name="753"><font size=-1>753     </font></a><span class="comment">		</span><span class="default">std::<a href="dictionary_S.html#74">vector</a>&lt;IndexType&gt; <a href="dictionary_N.html#17843">vind</a>;</span>
<a name="754"><font size=-1>754     </font></a><span class="default"></span>
<a name="755"><font size=-1>755     </font></a><span class="default">		<a href="dictionary_S.html#56">size_t</a> <a href="dictionary_N.html#17844">m_leaf_max_size</a>;</span>
<a name="756"><font size=-1>756     </font></a><span class="default"></span>
<a name="757"><font size=-1>757     </font></a><span class="default"></span>
<a name="758"><font size=-1>758     </font></a><span class="default">		</span><span class="comment">/**</span>
<a name="759"><font size=-1>759     </font></a><span class="comment">		 * The dataset used by this index</span>
<a name="760"><font size=-1>760     </font></a><span class="comment">		 */</span>
<a name="761"><font size=-1>761     </font></a><span class="comment">		</span><span class="keyword">const <a href="dictionary_N.html#17837">DatasetAdaptor</a> </span><span class="default">&amp;<a href="dictionary_N.html#17845">dataset</a>; </span><span class="comment">//!&lt; The source of our data</span>
<a name="762"><font size=-1>762     </font></a><span class="comment"></span>
<a name="763"><font size=-1>763     </font></a><span class="comment">		</span><span class="keyword">const <a href="dictionary_N.html#17725">KDTreeSingleIndexAdaptorParams</a> <a href="dictionary_N.html#17846">index_params</a></span><span class="default">;</span>
<a name="764"><font size=-1>764     </font></a><span class="default"></span>
<a name="765"><font size=-1>765     </font></a><span class="default">		<a href="dictionary_S.html#56">size_t</a> <a href="dictionary_N.html#17847">m_size</a>; </span><span class="comment">//!&lt; Number of current poins in the dataset</span>
<a name="766"><font size=-1>766     </font></a><span class="comment">		<a href="dictionary_S.html#56">size_t</a> <a href="dictionary_N.html#17848">m_size_at_index_build</a></span><span class="default">; </span><span class="comment">//!&lt; Number of points in the dataset when the index was built</span>
<a name="767"><font size=-1>767     </font></a><span class="comment">		</span><span class="keyword">int <a href="dictionary_N.html#17849">dim</a></span><span class="default">;  </span><span class="comment">//!&lt; Dimensionality of each data point</span>
<a name="768"><font size=-1>768     </font></a><span class="comment"></span>
<a name="769"><font size=-1>769     </font></a><span class="comment"></span>
<a name="770"><font size=-1>770     </font></a><span class="comment">		/*--------------------- Internal Data Structures --------------------------*/</span>
<a name="771"><font size=-1>771     </font></a><span class="comment">		</span><span class="keyword">struct <a href="dictionary_N.html#17850">Node</a></span>
<a name="772"><font size=-1>772     </font></a><span class="keyword">		</span><span class="default">{</span>
<a name="773"><font size=-1>773     </font></a><span class="default">			</span><span class="comment">/** Union used because a node can be either a LEAF node or a non-leaf node, so both data fields are never used simultaneously */</span>
<a name="774"><font size=-1>774     </font></a><span class="comment">			</span><span class="keyword">union </span><span class="default">{</span>
<a name="775"><font size=-1>775     </font></a><span class="default">				</span><span class="keyword">struct <a href="dictionary_L.html#17852">leaf</a></span>
<a name="776"><font size=-1>776     </font></a><span class="keyword">                                </span><span class="default">{</span>
<a name="777"><font size=-1>777     </font></a><span class="default">					<a href="dictionary_N.html#17839">IndexType</a>    <a href="dictionary_L.html#17853">left</a>, <a href="dictionary_L.html#17854">right</a>;  </span><span class="comment">//!&lt; Indices of points in leaf node</span>
<a name="778"><font size=-1>778     </font></a><span class="comment">				</span><span class="default">} <a href="dictionary_L.html#17855">lr</a>;</span>
<a name="779"><font size=-1>779     </font></a><span class="default">				</span><span class="keyword">struct <a href="dictionary_N.html#17856">nonleaf</a></span>
<a name="780"><font size=-1>780     </font></a><span class="keyword">                                </span><span class="default">{</span>
<a name="781"><font size=-1>781     </font></a><span class="default">					</span><span class="keyword">int          <a href="dictionary_N.html#17857">divfeat</a></span><span class="default">; </span><span class="comment">//!&lt; Dimension used for subdivision.</span>
<a name="782"><font size=-1>782     </font></a><span class="comment">					<a href="dictionary_N.html#17842">DistanceType</a> <a href="dictionary_N.html#17858">divlow</a></span><span class="default">, <a href="dictionary_N.html#17859">divhigh</a>; </span><span class="comment">//!&lt; The values used for subdivision.</span>
<a name="783"><font size=-1>783     </font></a><span class="comment">				</span><span class="default">} <a href="dictionary_S.html#17860">sub</a>;</span>
<a name="784"><font size=-1>784     </font></a><span class="default">			} <a href="dictionary_N.html#17861">node_type</a>;</span>
<a name="785"><font size=-1>785     </font></a><span class="default">			<a href="dictionary_N.html#17850">Node</a>* <a href="dictionary_N.html#17862">child1</a>, * <a href="dictionary_N.html#17863">child2</a>;  </span><span class="comment">//!&lt; Child nodes (both=NULL mean its a leaf node)</span>
<a name="786"><font size=-1>786     </font></a><span class="comment">		</span><span class="default">};</span>
<a name="787"><font size=-1>787     </font></a><span class="default">		</span><span class="keyword">typedef <a href="dictionary_N.html#17850">Node</a></span><span class="default">* <a href="dictionary_N.html#17864">NodePtr</a>;</span>
<a name="788"><font size=-1>788     </font></a><span class="default"></span>
<a name="789"><font size=-1>789     </font></a><span class="default"></span>
<a name="790"><font size=-1>790     </font></a><span class="default">		</span><span class="keyword">struct <a href="dictionary_N.html#17865">Interval</a></span>
<a name="791"><font size=-1>791     </font></a><span class="keyword">		</span><span class="default">{</span>
<a name="792"><font size=-1>792     </font></a><span class="default">			<a href="dictionary_N.html#17841">ElementType</a> <a href="dictionary_N.html#17866">low</a>, <a href="dictionary_N.html#17867">high</a>;</span>
<a name="793"><font size=-1>793     </font></a><span class="default">		};</span>
<a name="794"><font size=-1>794     </font></a><span class="default"></span>
<a name="795"><font size=-1>795     </font></a><span class="default">		</span><span class="comment">/** Define &quot;BoundingBox&quot; as a fixed-size or variable-size container depending on &quot;DIM&quot; */</span>
<a name="796"><font size=-1>796     </font></a><span class="comment">		</span><span class="keyword">typedef typename <a href="dictionary_N.html#17832">array_or_vector_selector</a></span><span class="default">&lt;DIM,Interval&gt;::<a href="dictionary_N.html#17834">container_t</a> <a href="dictionary_N.html#17868">BoundingBox</a>;</span>
<a name="797"><font size=-1>797     </font></a><span class="default"></span>
<a name="798"><font size=-1>798     </font></a><span class="default">		</span><span class="comment">/** Define &quot;distance_vector_t&quot; as a fixed-size or variable-size container depending on &quot;DIM&quot; */</span>
<a name="799"><font size=-1>799     </font></a><span class="comment">		</span><span class="keyword">typedef typename <a href="dictionary_N.html#17832">array_or_vector_selector</a></span><span class="default">&lt;DIM,DistanceType&gt;::<a href="dictionary_N.html#17834">container_t</a> <a href="dictionary_N.html#17869">distance_vector_t</a>;</span>
<a name="800"><font size=-1>800     </font></a><span class="default"></span>
<a name="801"><font size=-1>801     </font></a><span class="default">		</span><span class="comment">/** The KD-tree used to find neighbours */</span>
<a name="802"><font size=-1>802     </font></a><span class="comment">		<a href="dictionary_N.html#17864">NodePtr</a> <a href="dictionary_N.html#17870">root_node</a></span><span class="default">;</span>
<a name="803"><font size=-1>803     </font></a><span class="default">		<a href="dictionary_N.html#17868">BoundingBox</a> <a href="dictionary_N.html#17871">root_bbox</a>;</span>
<a name="804"><font size=-1>804     </font></a><span class="default"></span>
<a name="805"><font size=-1>805     </font></a><span class="default">		</span><span class="comment">/**</span>
<a name="806"><font size=-1>806     </font></a><span class="comment">		 * Pooled memory allocator.</span>
<a name="807"><font size=-1>807     </font></a><span class="comment">		 *</span>
<a name="808"><font size=-1>808     </font></a><span class="comment">		 * Using a pooled memory allocator is more efficient</span>
<a name="809"><font size=-1>809     </font></a><span class="comment">		 * than allocating memory directly when there is a large</span>
<a name="810"><font size=-1>810     </font></a><span class="comment">		 * number small of memory allocations.</span>
<a name="811"><font size=-1>811     </font></a><span class="comment">		 */</span>
<a name="812"><font size=-1>812     </font></a><span class="comment">		<a href="dictionary_N.html#17743">PooledAllocator</a> <a href="dictionary_N.html#17872">pool</a></span><span class="default">;</span>
<a name="813"><font size=-1>813     </font></a><span class="default"></span>
<a name="814"><font size=-1>814     </font></a><span class="default">	</span><span class="keyword">public</span><span class="default">:</span>
<a name="815"><font size=-1>815     </font></a><span class="default"></span>
<a name="816"><font size=-1>816     </font></a><span class="default">		<a href="dictionary_N.html#17836">Distance</a> <a href="dictionary_N.html#17873">distance</a>;</span>
<a name="817"><font size=-1>817     </font></a><span class="default"></span>
<a name="818"><font size=-1>818     </font></a><span class="default">		</span><span class="comment">/**</span>
<a name="819"><font size=-1>819     </font></a><span class="comment">		 * KDTree constructor</span>
<a name="820"><font size=-1>820     </font></a><span class="comment">		 *</span>
<a name="821"><font size=-1>821     </font></a><span class="comment">		 * Refer to docs in README.md or online in https://github.com/jlblancoc/nanoflann</span>
<a name="822"><font size=-1>822     </font></a><span class="comment">		 *</span>
<a name="823"><font size=-1>823     </font></a><span class="comment">		 * The KD-Tree point dimension (the length of each point in the datase, e.g. 3 for 3D points)</span>
<a name="824"><font size=-1>824     </font></a><span class="comment">		 * is determined by means of:</span>
<a name="825"><font size=-1>825     </font></a><span class="comment">		 *  - The \a DIM template parameter if &gt;0 (highest priority)</span>
<a name="826"><font size=-1>826     </font></a><span class="comment">		 *  - Otherwise, the \a dimensionality parameter of this constructor.</span>
<a name="827"><font size=-1>827     </font></a><span class="comment">		 *</span>
<a name="828"><font size=-1>828     </font></a><span class="comment">		 * @param inputData Dataset with the input features</span>
<a name="829"><font size=-1>829     </font></a><span class="comment">		 * @param params Basically, the maximum leaf node size</span>
<a name="830"><font size=-1>830     </font></a><span class="comment">		 */</span>
<a name="831"><font size=-1>831     </font></a><span class="comment">		<a href="dictionary_N.html#17874">KDTreeSingleIndexAdaptor</a></span><span class="default">(</span><span class="keyword">const int <a href="dictionary_D.html#17875">dimensionality</a></span><span class="default">, </span><span class="keyword">const <a href="dictionary_N.html#17837">DatasetAdaptor</a></span><span class="default">&amp; <a href="dictionary_I.html#17876">inputData</a>, </span><span class="keyword">const <a href="dictionary_N.html#17725">KDTreeSingleIndexAdaptorParams</a></span><span class="default">&amp; <a href="dictionary_P.html#17877">params</a> = KDTreeSingleIndexAdaptorParams() ) :</span>
<a name="832"><font size=-1>832     </font></a><span class="default">			<a href="dictionary_N.html#17845">dataset</a>(<a href="dictionary_I.html#17876">inputData</a>), <a href="dictionary_N.html#17846">index_params</a>(<a href="dictionary_P.html#17877">params</a>), <a href="dictionary_N.html#17870">root_node</a>(<a href="dictionary_N.html#439">NULL</a>), <a href="dictionary_N.html#17873">distance</a>(<a href="dictionary_I.html#17876">inputData</a>)</span>
<a name="833"><font size=-1>833     </font></a><span class="default">		{</span>
<a name="834"><font size=-1>834     </font></a><span class="default">			<a href="dictionary_N.html#17847">m_size</a> = <a href="dictionary_N.html#17845">dataset</a>.<a href="dictionary_K.html#17956">kdtree_get_point_count</a>();</span>
<a name="835"><font size=-1>835     </font></a><span class="default">			<a href="dictionary_N.html#17848">m_size_at_index_build</a> = <a href="dictionary_N.html#17847">m_size</a>;</span>
<a name="836"><font size=-1>836     </font></a><span class="default">			<a href="dictionary_N.html#17849">dim</a> = <a href="dictionary_D.html#17875">dimensionality</a>;</span>
<a name="837"><font size=-1>837     </font></a><span class="default">			</span><span class="keyword">if </span><span class="default">(<a href="dictionary_N.html#17838">DIM</a>&gt;</span><span class="number">0</span><span class="default">) <a href="dictionary_N.html#17849">dim</a>=<a href="dictionary_N.html#17838">DIM</a>;</span>
<a name="838"><font size=-1>838     </font></a><span class="default">			<a href="dictionary_N.html#17844">m_leaf_max_size</a> = <a href="dictionary_P.html#17877">params</a>.<a href="dictionary_N.html#17728">leaf_max_size</a>;</span>
<a name="839"><font size=-1>839     </font></a><span class="default"></span>
<a name="840"><font size=-1>840     </font></a><span class="default">			</span><span class="comment">// Create a permutable array of indices to the input vectors.</span>
<a name="841"><font size=-1>841     </font></a><span class="comment">			<a href="dictionary_N.html#17905">init_vind</a></span><span class="default">();</span>
<a name="842"><font size=-1>842     </font></a><span class="default">		}</span>
<a name="843"><font size=-1>843     </font></a><span class="default"></span>
<a name="844"><font size=-1>844     </font></a><span class="default">		</span><span class="comment">/** Standard destructor */</span>
<a name="845"><font size=-1>845     </font></a><span class="comment">		</span><span class="default">~<a href="dictionary_N.html#17878">KDTreeSingleIndexAdaptor</a>() { }</span>
<a name="846"><font size=-1>846     </font></a><span class="default"></span>
<a name="847"><font size=-1>847     </font></a><span class="default">		</span><span class="comment">/** Frees the previously-built index. Automatically called within buildIndex(). */</span>
<a name="848"><font size=-1>848     </font></a><span class="comment">		</span><span class="keyword">void <a href="dictionary_N.html#17879">freeIndex</a></span><span class="default">()</span>
<a name="849"><font size=-1>849     </font></a><span class="default">		{</span>
<a name="850"><font size=-1>850     </font></a><span class="default">			<a href="dictionary_N.html#17872">pool</a>.<a href="dictionary_N.html#17752">free_all</a>();</span>
<a name="851"><font size=-1>851     </font></a><span class="default">			<a href="dictionary_N.html#17870">root_node</a>=<a href="dictionary_N.html#439">NULL</a>;</span>
<a name="852"><font size=-1>852     </font></a><span class="default">			<a href="dictionary_N.html#17848">m_size_at_index_build</a> = </span><span class="number">0</span><span class="default">;</span>
<a name="853"><font size=-1>853     </font></a><span class="default">		}</span>
<a name="854"><font size=-1>854     </font></a><span class="default"></span>
<a name="855"><font size=-1>855     </font></a><span class="default">		</span><span class="comment">/**</span>
<a name="856"><font size=-1>856     </font></a><span class="comment">		 * Builds the index</span>
<a name="857"><font size=-1>857     </font></a><span class="comment">		 */</span>
<a name="858"><font size=-1>858     </font></a><span class="comment">		</span><span class="keyword">void <a href="dictionary_N.html#17880">buildIndex</a></span><span class="default">()</span>
<a name="859"><font size=-1>859     </font></a><span class="default">		{</span>
<a name="860"><font size=-1>860     </font></a><span class="default">			<a href="dictionary_N.html#17905">init_vind</a>();</span>
<a name="861"><font size=-1>861     </font></a><span class="default">			<a href="dictionary_N.html#17879">freeIndex</a>();</span>
<a name="862"><font size=-1>862     </font></a><span class="default">			<a href="dictionary_N.html#17848">m_size_at_index_build</a> = <a href="dictionary_N.html#17847">m_size</a>;</span>
<a name="863"><font size=-1>863     </font></a><span class="default">			</span><span class="keyword">if</span><span class="default">(<a href="dictionary_N.html#17847">m_size</a> == </span><span class="number">0</span><span class="default">) </span><span class="keyword">return</span><span class="default">;</span>
<a name="864"><font size=-1>864     </font></a><span class="default">			<a href="dictionary_N.html#17915">computeBoundingBox</a>(<a href="dictionary_N.html#17871">root_bbox</a>);</span>
<a name="865"><font size=-1>865     </font></a><span class="default">			<a href="dictionary_N.html#17870">root_node</a> = <a href="dictionary_N.html#17917">divideTree</a>(</span><span class="number">0</span><span class="default">, <a href="dictionary_N.html#17847">m_size</a>, <a href="dictionary_N.html#17871">root_bbox</a> );   </span><span class="comment">// construct the tree</span>
<a name="866"><font size=-1>866     </font></a><span class="comment">		</span><span class="default">}</span>
<a name="867"><font size=-1>867     </font></a><span class="default"></span>
<a name="868"><font size=-1>868     </font></a><span class="default">		</span><span class="comment">/** Returns number of points in dataset  */</span>
<a name="869"><font size=-1>869     </font></a><span class="comment">		<a href="dictionary_S.html#56">size_t</a> <a href="dictionary_N.html#17881">size</a></span><span class="default">() </span><span class="keyword">const </span><span class="default">{ </span><span class="keyword">return <a href="dictionary_N.html#17847">m_size</a></span><span class="default">; }</span>
<a name="870"><font size=-1>870     </font></a><span class="default"></span>
<a name="871"><font size=-1>871     </font></a><span class="default">		</span><span class="comment">/** Returns the length of each point in the dataset */</span>
<a name="872"><font size=-1>872     </font></a><span class="comment">		<a href="dictionary_S.html#56">size_t</a> <a href="dictionary_N.html#17882">veclen</a></span><span class="default">() </span><span class="keyword">const </span><span class="default">{</span>
<a name="873"><font size=-1>873     </font></a><span class="default">			</span><span class="keyword">return static_cast</span><span class="default">&lt;<a href="dictionary_S.html#56">size_t</a>&gt;(<a href="dictionary_N.html#17838">DIM</a>&gt;</span><span class="number">0 </span><span class="default">? <a href="dictionary_N.html#17838">DIM</a> : <a href="dictionary_N.html#17849">dim</a>);</span>
<a name="874"><font size=-1>874     </font></a><span class="default">		}</span>
<a name="875"><font size=-1>875     </font></a><span class="default"></span>
<a name="876"><font size=-1>876     </font></a><span class="default">		</span><span class="comment">/**</span>
<a name="877"><font size=-1>877     </font></a><span class="comment">		 * Computes the inde memory usage</span>
<a name="878"><font size=-1>878     </font></a><span class="comment">		 * Returns: memory used by the index</span>
<a name="879"><font size=-1>879     </font></a><span class="comment">		 */</span>
<a name="880"><font size=-1>880     </font></a><span class="comment">		<a href="dictionary_S.html#56">size_t</a> <a href="dictionary_N.html#17883">usedMemory</a></span><span class="default">() </span><span class="keyword">const</span>
<a name="881"><font size=-1>881     </font></a><span class="keyword">		</span><span class="default">{</span>
<a name="882"><font size=-1>882     </font></a><span class="default">			</span><span class="keyword">return <a href="dictionary_N.html#17872">pool</a></span><span class="default">.<a href="dictionary_N.html#17748">usedMemory</a>+<a href="dictionary_N.html#17872">pool</a>.<a href="dictionary_N.html#17749">wastedMemory</a>+<a href="dictionary_N.html#17845">dataset</a>.<a href="dictionary_K.html#17956">kdtree_get_point_count</a>()*</span><span class="keyword">sizeof</span><span class="default">(<a href="dictionary_I.html#17957">IndexType</a>);  </span><span class="comment">// pool memory and vind array memory</span>
<a name="883"><font size=-1>883     </font></a><span class="comment">		</span><span class="default">}</span>
<a name="884"><font size=-1>884     </font></a><span class="default"></span>
<a name="885"><font size=-1>885     </font></a><span class="default">		</span><span class="comment">/** \name Query methods</span>
<a name="886"><font size=-1>886     </font></a><span class="comment">		  * @{ */</span>
<a name="887"><font size=-1>887     </font></a><span class="comment"></span>
<a name="888"><font size=-1>888     </font></a><span class="comment">		/**</span>
<a name="889"><font size=-1>889     </font></a><span class="comment">		 * Find set of nearest neighbors to vec[0:dim-1]. Their indices are stored inside</span>
<a name="890"><font size=-1>890     </font></a><span class="comment">		 * the result object.</span>
<a name="891"><font size=-1>891     </font></a><span class="comment">		 *</span>
<a name="892"><font size=-1>892     </font></a><span class="comment">		 * Params:</span>
<a name="893"><font size=-1>893     </font></a><span class="comment">		 *     result = the result object in which the indices of the nearest-neighbors are stored</span>
<a name="894"><font size=-1>894     </font></a><span class="comment">		 *     vec = the vector for which to search the nearest neighbors</span>
<a name="895"><font size=-1>895     </font></a><span class="comment">		 *</span>
<a name="896"><font size=-1>896     </font></a><span class="comment">		 * \tparam RESULTSET Should be any ResultSet&lt;DistanceType&gt;</span>
<a name="897"><font size=-1>897     </font></a><span class="comment">         * \return  True if the requested neighbors could be found.</span>
<a name="898"><font size=-1>898     </font></a><span class="comment">		 * \sa knnSearch, radiusSearch</span>
<a name="899"><font size=-1>899     </font></a><span class="comment">		 */</span>
<a name="900"><font size=-1>900     </font></a><span class="comment">		</span><span class="keyword">template </span><span class="default">&lt;</span><span class="keyword">typename <a href="dictionary_R.html#17885">RESULTSET</a></span><span class="default">&gt;</span>
<a name="901"><font size=-1>901     </font></a><span class="default">		</span><span class="keyword">bool <a href="dictionary_N.html#17884">findNeighbors</a></span><span class="default">(<a href="dictionary_R.html#17885">RESULTSET</a>&amp; <a href="dictionary_R.html#17886">result</a>, </span><span class="keyword">const <a href="dictionary_N.html#17841">ElementType</a></span><span class="default">* <a href="dictionary_V.html#17887">vec</a>, </span><span class="keyword">const <a href="dictionary_N.html#17729">SearchParams</a></span><span class="default">&amp; <a href="dictionary_S.html#17888">searchParams</a>) </span><span class="keyword">const</span>
<a name="902"><font size=-1>902     </font></a><span class="keyword">		</span><span class="default">{</span>
<a name="903"><font size=-1>903     </font></a><span class="default">			<a href="dictionary_A.html#8782">assert</a>(<a href="dictionary_V.html#17887">vec</a>);</span>
<a name="904"><font size=-1>904     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_N.html#17881">size</a>() == </span><span class="number">0</span><span class="default">)</span>
<a name="905"><font size=-1>905     </font></a><span class="default">                </span><span class="keyword">return false</span><span class="default">;</span>
<a name="906"><font size=-1>906     </font></a><span class="default">			</span><span class="keyword">if </span><span class="default">(!<a href="dictionary_N.html#17870">root_node</a>)</span>
<a name="907"><font size=-1>907     </font></a><span class="default">                </span><span class="keyword">throw </span><span class="default">std::<a href="dictionary_S.html#713">runtime_error</a>(</span><span class="string">&quot;[nanoflann] findNeighbors() called before building the index.&quot;</span><span class="default">);</span>
<a name="908"><font size=-1>908     </font></a><span class="default">			</span><span class="keyword">float <a href="dictionary_E.html#17958">epsError</a> </span><span class="default">= </span><span class="number">1</span><span class="default">+<a href="dictionary_S.html#17888">searchParams</a>.<a href="dictionary_N.html#17735">eps</a>;</span>
<a name="909"><font size=-1>909     </font></a><span class="default"></span>
<a name="910"><font size=-1>910     </font></a><span class="default">			<a href="dictionary_N.html#17869">distance_vector_t</a> <a href="dictionary_D.html#17959">dists</a>; </span><span class="comment">// fixed or variable-sized container (depending on DIM)</span>
<a name="911"><font size=-1>911     </font></a><span class="comment">			<a href="dictionary_D.html#17959">dists</a></span><span class="default">.<a href="dictionary_A.html#4916">assign</a>((<a href="dictionary_N.html#17838">DIM</a>&gt;</span><span class="number">0 </span><span class="default">? <a href="dictionary_N.html#17838">DIM</a> : <a href="dictionary_N.html#17849">dim</a>) ,</span><span class="number">0</span><span class="default">); </span><span class="comment">// Fill it with zeros.</span>
<a name="912"><font size=-1>912     </font></a><span class="comment">			<a href="dictionary_N.html#17842">DistanceType</a> <a href="dictionary_D.html#17960">distsq</a> </span><span class="default">= <a href="dictionary_N.html#17941">computeInitialDistances</a>(<a href="dictionary_V.html#17887">vec</a>, <a href="dictionary_D.html#17959">dists</a>);</span>
<a name="913"><font size=-1>913     </font></a><span class="default">			<a href="dictionary_N.html#17944">searchLevel</a>(<a href="dictionary_R.html#17886">result</a>, <a href="dictionary_V.html#17887">vec</a>, <a href="dictionary_N.html#17870">root_node</a>, <a href="dictionary_D.html#17960">distsq</a>, <a href="dictionary_D.html#17959">dists</a>, <a href="dictionary_E.html#17958">epsError</a>);  </span><span class="comment">// &quot;count_leaf&quot; parameter removed since was neither used nor returned to the user.</span>
<a name="914"><font size=-1>914     </font></a><span class="comment">            </span><span class="keyword">return <a href="dictionary_R.html#17886">result</a></span><span class="default">.<a href="dictionary_F.html#17961">full</a>();</span>
<a name="915"><font size=-1>915     </font></a><span class="default">		}</span>
<a name="916"><font size=-1>916     </font></a><span class="default"></span>
<a name="917"><font size=-1>917     </font></a><span class="default">		</span><span class="comment">/**</span>
<a name="918"><font size=-1>918     </font></a><span class="comment">		 * Find the &quot;num_closest&quot; nearest neighbors to the \a query_point[0:dim-1]. Their indices are stored inside</span>
<a name="919"><font size=-1>919     </font></a><span class="comment">		 * the result object.</span>
<a name="920"><font size=-1>920     </font></a><span class="comment">		 *  \sa radiusSearch, findNeighbors</span>
<a name="921"><font size=-1>921     </font></a><span class="comment">		 * \note nChecks_IGNORED is ignored but kept for compatibility with the original FLANN interface.</span>
<a name="922"><font size=-1>922     </font></a><span class="comment">		 */</span>
<a name="923"><font size=-1>923     </font></a><span class="comment">		</span><span class="keyword">inline void <a href="dictionary_N.html#17889">knnSearch</a></span><span class="default">(</span><span class="keyword">const <a href="dictionary_N.html#17841">ElementType</a> </span><span class="default">*<a href="dictionary_Q.html#17890">query_point</a>, </span><span class="keyword">const <a href="dictionary_S.html#56">size_t</a> <a href="dictionary_N.html#17891">num_closest</a></span><span class="default">, <a href="dictionary_N.html#17839">IndexType</a> *<a href="dictionary_O.html#17892">out_indices</a>, <a href="dictionary_N.html#17842">DistanceType</a> *<a href="dictionary_O.html#17893">out_distances_sq</a>, </span><span class="keyword">const int </span><span class="comment">/* nChecks_IGNORED */ </span><span class="default">= </span><span class="number">10</span><span class="default">) </span><span class="keyword">const</span>
<a name="924"><font size=-1>924     </font></a><span class="keyword">		</span><span class="default">{</span>
<a name="925"><font size=-1>925     </font></a><span class="default">			nanoflann::<a href="dictionary_N.html#17566">KNNResultSet</a>&lt;DistanceType,IndexType&gt; <a href="dictionary_R.html#17962">resultSet</a>(<a href="dictionary_N.html#17891">num_closest</a>);</span>
<a name="926"><font size=-1>926     </font></a><span class="default">			<a href="dictionary_R.html#17962">resultSet</a>.<a href="dictionary_N.html#17568">init</a>(<a href="dictionary_O.html#17892">out_indices</a>, <a href="dictionary_O.html#17893">out_distances_sq</a>);</span>
<a name="927"><font size=-1>927     </font></a><span class="default">			</span><span class="keyword">this</span><span class="default">-&gt;<a href="dictionary_N.html#17884">findNeighbors</a>(<a href="dictionary_R.html#17962">resultSet</a>, <a href="dictionary_Q.html#17890">query_point</a>, nanoflann::<a href="dictionary_N.html#17730">SearchParams</a>());</span>
<a name="928"><font size=-1>928     </font></a><span class="default">		}</span>
<a name="929"><font size=-1>929     </font></a><span class="default"></span>
<a name="930"><font size=-1>930     </font></a><span class="default">		</span><span class="comment">/**</span>
<a name="931"><font size=-1>931     </font></a><span class="comment">		 * Find all the neighbors to \a query_point[0:dim-1] within a maximum radius.</span>
<a name="932"><font size=-1>932     </font></a><span class="comment">		 *  The output is given as a vector of pairs, of which the first element is a point index and the second the corresponding distance.</span>
<a name="933"><font size=-1>933     </font></a><span class="comment">		 *  Previous contents of \a IndicesDists are cleared.</span>
<a name="934"><font size=-1>934     </font></a><span class="comment">		 *</span>
<a name="935"><font size=-1>935     </font></a><span class="comment">		 *  If searchParams.sorted==true, the output list is sorted by ascending distances.</span>
<a name="936"><font size=-1>936     </font></a><span class="comment">		 *</span>
<a name="937"><font size=-1>937     </font></a><span class="comment">		 *  For a better performance, it is advisable to do a .reserve() on the vector if you have any wild guess about the number of expected matches.</span>
<a name="938"><font size=-1>938     </font></a><span class="comment">		 *</span>
<a name="939"><font size=-1>939     </font></a><span class="comment">		 *  \sa knnSearch, findNeighbors, radiusSearchCustomCallback</span>
<a name="940"><font size=-1>940     </font></a><span class="comment">		 * \return The number of points within the given radius (i.e. indices.size() or dists.size() )</span>
<a name="941"><font size=-1>941     </font></a><span class="comment">		 */</span>
<a name="942"><font size=-1>942     </font></a><span class="comment">		<a href="dictionary_S.html#56">size_t</a> <a href="dictionary_N.html#17895">radiusSearch</a></span><span class="default">(</span><span class="keyword">const <a href="dictionary_N.html#17841">ElementType</a> </span><span class="default">*<a href="dictionary_Q.html#17896">query_point</a>,</span><span class="keyword">const <a href="dictionary_N.html#17842">DistanceType</a> </span><span class="default">&amp;<a href="dictionary_R.html#17897">radius</a>, std::<a href="dictionary_S.html#74">vector</a>&lt;std::pair&lt;IndexType,DistanceType&gt; &gt;&amp; <a href="dictionary_I.html#17898">IndicesDists</a>, </span><span class="keyword">const <a href="dictionary_N.html#17729">SearchParams</a></span><span class="default">&amp; <a href="dictionary_S.html#17899">searchParams</a>) </span><span class="keyword">const</span>
<a name="943"><font size=-1>943     </font></a><span class="keyword">		</span><span class="default">{</span>
<a name="944"><font size=-1>944     </font></a><span class="default">			<a href="dictionary_N.html#17585">RadiusResultSet</a>&lt;DistanceType,IndexType&gt; <a href="dictionary_R.html#17963">resultSet</a>(<a href="dictionary_R.html#17897">radius</a>,<a href="dictionary_I.html#17898">IndicesDists</a>);</span>
<a name="945"><font size=-1>945     </font></a><span class="default">			</span><span class="keyword">const <a href="dictionary_S.html#56">size_t</a> <a href="dictionary_N.html#17964">nFound</a> </span><span class="default">= <a href="dictionary_N.html#17900">radiusSearchCustomCallback</a>(<a href="dictionary_Q.html#17896">query_point</a>,<a href="dictionary_R.html#17963">resultSet</a>,<a href="dictionary_S.html#17899">searchParams</a>);</span>
<a name="946"><font size=-1>946     </font></a><span class="default">			</span><span class="keyword">if </span><span class="default">(<a href="dictionary_S.html#17899">searchParams</a>.<a href="dictionary_N.html#17736">sorted</a>)</span>
<a name="947"><font size=-1>947     </font></a><span class="default">				std::<a href="dictionary_S.html#471">sort</a>(<a href="dictionary_I.html#17898">IndicesDists</a>.<a href="dictionary_B.html#448">begin</a>(),<a href="dictionary_I.html#17898">IndicesDists</a>.<a href="dictionary_E.html#449">end</a>(), <a href="dictionary_I.html#17965">IndexDist_Sorter</a>() );</span>
<a name="948"><font size=-1>948     </font></a><span class="default">			</span><span class="keyword">return <a href="dictionary_N.html#17964">nFound</a></span><span class="default">;</span>
<a name="949"><font size=-1>949     </font></a><span class="default">		}</span>
<a name="950"><font size=-1>950     </font></a><span class="default"></span>
<a name="951"><font size=-1>951     </font></a><span class="default">		</span><span class="comment">/**</span>
<a name="952"><font size=-1>952     </font></a><span class="comment">		 * Just like radiusSearch() but with a custom callback class for each point found in the radius of the query.</span>
<a name="953"><font size=-1>953     </font></a><span class="comment">		 * See the source of RadiusResultSet&lt;&gt; as a start point for your own classes.</span>
<a name="954"><font size=-1>954     </font></a><span class="comment">		 * \sa radiusSearch</span>
<a name="955"><font size=-1>955     </font></a><span class="comment">		 */</span>
<a name="956"><font size=-1>956     </font></a><span class="comment">		</span><span class="keyword">template </span><span class="default">&lt;</span><span class="keyword">class <a href="dictionary_S.html#17901">SEARCH_CALLBACK</a></span><span class="default">&gt;</span>
<a name="957"><font size=-1>957     </font></a><span class="default">		<a href="dictionary_S.html#56">size_t</a> <a href="dictionary_N.html#17900">radiusSearchCustomCallback</a>(</span><span class="keyword">const <a href="dictionary_N.html#17841">ElementType</a> </span><span class="default">*<a href="dictionary_Q.html#17902">query_point</a>,<a href="dictionary_S.html#17901">SEARCH_CALLBACK</a> &amp;<a href="dictionary_R.html#17903">resultSet</a>, </span><span class="keyword">const <a href="dictionary_N.html#17729">SearchParams</a></span><span class="default">&amp; <a href="dictionary_S.html#17904">searchParams</a> = SearchParams() ) </span><span class="keyword">const</span>
<a name="958"><font size=-1>958     </font></a><span class="keyword">		</span><span class="default">{</span>
<a name="959"><font size=-1>959     </font></a><span class="default">			</span><span class="keyword">this</span><span class="default">-&gt;<a href="dictionary_N.html#17884">findNeighbors</a>(<a href="dictionary_R.html#17903">resultSet</a>, <a href="dictionary_Q.html#17902">query_point</a>, <a href="dictionary_S.html#17904">searchParams</a>);</span>
<a name="960"><font size=-1>960     </font></a><span class="default">			</span><span class="keyword">return <a href="dictionary_R.html#17903">resultSet</a></span><span class="default">.<a href="dictionary_S.html#442">size</a>();</span>
<a name="961"><font size=-1>961     </font></a><span class="default">		}</span>
<a name="962"><font size=-1>962     </font></a><span class="default"></span>
<a name="963"><font size=-1>963     </font></a><span class="default">		</span><span class="comment">/** @} */</span>
<a name="964"><font size=-1>964     </font></a><span class="comment"></span>
<a name="965"><font size=-1>965     </font></a><span class="comment">	</span><span class="keyword">private</span><span class="default">:</span>
<a name="966"><font size=-1>966     </font></a><span class="default">		</span><span class="comment">/** Make sure the auxiliary list \a vind has the same size than the current dataset, and re-generate if size has changed. */</span>
<a name="967"><font size=-1>967     </font></a><span class="comment">		</span><span class="keyword">void <a href="dictionary_N.html#17905">init_vind</a></span><span class="default">()</span>
<a name="968"><font size=-1>968     </font></a><span class="default">		{</span>
<a name="969"><font size=-1>969     </font></a><span class="default">			</span><span class="comment">// Create a permutable array of indices to the input vectors.</span>
<a name="970"><font size=-1>970     </font></a><span class="comment">			<a href="dictionary_N.html#17847">m_size</a> </span><span class="default">= <a href="dictionary_N.html#17845">dataset</a>.<a href="dictionary_K.html#17956">kdtree_get_point_count</a>();</span>
<a name="971"><font size=-1>971     </font></a><span class="default">			</span><span class="keyword">if </span><span class="default">(<a href="dictionary_N.html#17843">vind</a>.<a href="dictionary_S.html#442">size</a>()!=<a href="dictionary_N.html#17847">m_size</a>) <a href="dictionary_N.html#17843">vind</a>.<a href="dictionary_R.html#472">resize</a>(<a href="dictionary_N.html#17847">m_size</a>);</span>
<a name="972"><font size=-1>972     </font></a><span class="default">			</span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#56">size_t</a> <a href="dictionary_I.html#17966">i</a> = </span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#17966">i</a> &lt; <a href="dictionary_N.html#17847">m_size</a>; <a href="dictionary_I.html#17966">i</a>++) <a href="dictionary_N.html#17843">vind</a>[<a href="dictionary_I.html#17966">i</a>] = <a href="dictionary_I.html#17966">i</a>;</span>
<a name="973"><font size=-1>973     </font></a><span class="default">		}</span>
<a name="974"><font size=-1>974     </font></a><span class="default"></span>
<a name="975"><font size=-1>975     </font></a><span class="default">		</span><span class="comment">/// Helper accessor to the dataset points:</span>
<a name="976"><font size=-1>976     </font></a><span class="comment">		</span><span class="keyword">inline <a href="dictionary_N.html#17841">ElementType</a> <a href="dictionary_N.html#17906">dataset_get</a></span><span class="default">(<a href="dictionary_S.html#56">size_t</a> <a href="dictionary_I.html#17907">idx</a>, </span><span class="keyword">int <a href="dictionary_C.html#17908">component</a></span><span class="default">) </span><span class="keyword">const </span><span class="default">{</span>
<a name="977"><font size=-1>977     </font></a><span class="default">			</span><span class="keyword">return <a href="dictionary_N.html#17845">dataset</a></span><span class="default">.<a href="dictionary_K.html#17657">kdtree_get_pt</a>(<a href="dictionary_I.html#17907">idx</a>,<a href="dictionary_C.html#17908">component</a>);</span>
<a name="978"><font size=-1>978     </font></a><span class="default">		}</span>
<a name="979"><font size=-1>979     </font></a><span class="default"></span>
<a name="980"><font size=-1>980     </font></a><span class="default"></span>
<a name="981"><font size=-1>981     </font></a><span class="default">		</span><span class="keyword">void <a href="dictionary_N.html#17909">save_tree</a></span><span class="default">(<a href="dictionary_F.html#2277">FILE</a>* <a href="dictionary_S.html#17910">stream</a>, <a href="dictionary_N.html#17864">NodePtr</a> <a href="dictionary_T.html#17911">tree</a>)</span>
<a name="982"><font size=-1>982     </font></a><span class="default">		{</span>
<a name="983"><font size=-1>983     </font></a><span class="default">			<a href="dictionary_N.html#17608">save_value</a>(<a href="dictionary_S.html#17910">stream</a>, *<a href="dictionary_T.html#17911">tree</a>);</span>
<a name="984"><font size=-1>984     </font></a><span class="default">			</span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#17911">tree</a>-&gt;<a href="dictionary_N.html#17862">child1</a>!=<a href="dictionary_N.html#439">NULL</a>) {</span>
<a name="985"><font size=-1>985     </font></a><span class="default">				<a href="dictionary_N.html#17909">save_tree</a>(<a href="dictionary_S.html#17910">stream</a>, <a href="dictionary_T.html#17911">tree</a>-&gt;<a href="dictionary_N.html#17862">child1</a>);</span>
<a name="986"><font size=-1>986     </font></a><span class="default">			}</span>
<a name="987"><font size=-1>987     </font></a><span class="default">			</span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#17911">tree</a>-&gt;<a href="dictionary_N.html#17863">child2</a>!=<a href="dictionary_N.html#439">NULL</a>) {</span>
<a name="988"><font size=-1>988     </font></a><span class="default">				<a href="dictionary_N.html#17909">save_tree</a>(<a href="dictionary_S.html#17910">stream</a>, <a href="dictionary_T.html#17911">tree</a>-&gt;<a href="dictionary_N.html#17863">child2</a>);</span>
<a name="989"><font size=-1>989     </font></a><span class="default">			}</span>
<a name="990"><font size=-1>990     </font></a><span class="default">		}</span>
<a name="991"><font size=-1>991     </font></a><span class="default"></span>
<a name="992"><font size=-1>992     </font></a><span class="default"></span>
<a name="993"><font size=-1>993     </font></a><span class="default">		</span><span class="keyword">void <a href="dictionary_N.html#17912">load_tree</a></span><span class="default">(<a href="dictionary_F.html#2277">FILE</a>* <a href="dictionary_S.html#17913">stream</a>, <a href="dictionary_N.html#17864">NodePtr</a>&amp; <a href="dictionary_T.html#17914">tree</a>)</span>
<a name="994"><font size=-1>994     </font></a><span class="default">		{</span>
<a name="995"><font size=-1>995     </font></a><span class="default">			<a href="dictionary_T.html#17914">tree</a> = <a href="dictionary_N.html#17872">pool</a>.<a href="dictionary_N.html#17756">allocate</a>&lt;Node&gt;();</span>
<a name="996"><font size=-1>996     </font></a><span class="default">			<a href="dictionary_N.html#17619">load_value</a>(<a href="dictionary_S.html#17913">stream</a>, *<a href="dictionary_T.html#17914">tree</a>);</span>
<a name="997"><font size=-1>997     </font></a><span class="default">			</span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#17914">tree</a>-&gt;<a href="dictionary_N.html#17862">child1</a>!=<a href="dictionary_N.html#439">NULL</a>) {</span>
<a name="998"><font size=-1>998     </font></a><span class="default">				<a href="dictionary_N.html#17912">load_tree</a>(<a href="dictionary_S.html#17913">stream</a>, <a href="dictionary_T.html#17914">tree</a>-&gt;<a href="dictionary_N.html#17862">child1</a>);</span>
<a name="999"><font size=-1>999     </font></a><span class="default">			}</span>
<a name="1000"><font size=-1>1000     </font></a><span class="default">			</span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#17914">tree</a>-&gt;<a href="dictionary_N.html#17863">child2</a>!=<a href="dictionary_N.html#439">NULL</a>) {</span>
<a name="1001"><font size=-1>1001     </font></a><span class="default">				<a href="dictionary_N.html#17912">load_tree</a>(<a href="dictionary_S.html#17913">stream</a>, <a href="dictionary_T.html#17914">tree</a>-&gt;<a href="dictionary_N.html#17863">child2</a>);</span>
<a name="1002"><font size=-1>1002     </font></a><span class="default">			}</span>
<a name="1003"><font size=-1>1003     </font></a><span class="default">		}</span>
<a name="1004"><font size=-1>1004     </font></a><span class="default"></span>
<a name="1005"><font size=-1>1005     </font></a><span class="default"></span>
<a name="1006"><font size=-1>1006     </font></a><span class="default">		</span><span class="keyword">void <a href="dictionary_N.html#17915">computeBoundingBox</a></span><span class="default">(<a href="dictionary_N.html#17868">BoundingBox</a>&amp; <a href="dictionary_B.html#17916">bbox</a>)</span>
<a name="1007"><font size=-1>1007     </font></a><span class="default">		{</span>
<a name="1008"><font size=-1>1008     </font></a><span class="default">			<a href="dictionary_B.html#17916">bbox</a>.<a href="dictionary_R.html#472">resize</a>((<a href="dictionary_N.html#17838">DIM</a>&gt;</span><span class="number">0 </span><span class="default">? <a href="dictionary_N.html#17838">DIM</a> : <a href="dictionary_N.html#17849">dim</a>));</span>
<a name="1009"><font size=-1>1009     </font></a><span class="default">			</span><span class="keyword">if </span><span class="default">(<a href="dictionary_N.html#17845">dataset</a>.<a href="dictionary_K.html#17967">kdtree_get_bbox</a>(<a href="dictionary_B.html#17916">bbox</a>))</span>
<a name="1010"><font size=-1>1010     </font></a><span class="default">			{</span>
<a name="1011"><font size=-1>1011     </font></a><span class="default">				</span><span class="comment">// Done! It was implemented in derived class</span>
<a name="1012"><font size=-1>1012     </font></a><span class="comment">			</span><span class="default">}</span>
<a name="1013"><font size=-1>1013     </font></a><span class="default">			</span><span class="keyword">else</span>
<a name="1014"><font size=-1>1014     </font></a><span class="keyword">			</span><span class="default">{</span>
<a name="1015"><font size=-1>1015     </font></a><span class="default">				</span><span class="keyword">const <a href="dictionary_S.html#56">size_t</a> <a href="dictionary_N.html#17968">N</a> </span><span class="default">= <a href="dictionary_N.html#17845">dataset</a>.<a href="dictionary_K.html#17956">kdtree_get_point_count</a>();</span>
<a name="1016"><font size=-1>1016     </font></a><span class="default">				</span><span class="keyword">if </span><span class="default">(!<a href="dictionary_N.html#17968">N</a>) </span><span class="keyword">throw </span><span class="default">std::<a href="dictionary_S.html#713">runtime_error</a>(</span><span class="string">&quot;[nanoflann] computeBoundingBox() called but no data points found.&quot;</span><span class="default">);</span>
<a name="1017"><font size=-1>1017     </font></a><span class="default">				</span><span class="keyword">for </span><span class="default">(</span><span class="keyword">int <a href="dictionary_I.html#17969">i</a></span><span class="default">=</span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#17969">i</a>&lt;(<a href="dictionary_N.html#17838">DIM</a>&gt;</span><span class="number">0 </span><span class="default">? <a href="dictionary_N.html#17838">DIM</a> : <a href="dictionary_N.html#17849">dim</a>); ++<a href="dictionary_I.html#17969">i</a>) {</span>
<a name="1018"><font size=-1>1018     </font></a><span class="default">					<a href="dictionary_B.html#17916">bbox</a>[<a href="dictionary_I.html#17969">i</a>].<a href="dictionary_L.html#17971">low</a> =</span>
<a name="1019"><font size=-1>1019     </font></a><span class="default">					<a href="dictionary_B.html#17916">bbox</a>[<a href="dictionary_I.html#17969">i</a>].<a href="dictionary_H.html#17970">high</a> = <a href="dictionary_N.html#17906">dataset_get</a>(</span><span class="number">0</span><span class="default">,<a href="dictionary_I.html#17969">i</a>);</span>
<a name="1020"><font size=-1>1020     </font></a><span class="default">				}</span>
<a name="1021"><font size=-1>1021     </font></a><span class="default">				</span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#56">size_t</a> <a href="dictionary_K.html#17972">k</a>=</span><span class="number">1</span><span class="default">; <a href="dictionary_K.html#17972">k</a>&lt;<a href="dictionary_N.html#17968">N</a>; ++<a href="dictionary_K.html#17972">k</a>) {</span>
<a name="1022"><font size=-1>1022     </font></a><span class="default">					</span><span class="keyword">for </span><span class="default">(</span><span class="keyword">int <a href="dictionary_I.html#17973">i</a></span><span class="default">=</span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#17973">i</a>&lt;(<a href="dictionary_N.html#17838">DIM</a>&gt;</span><span class="number">0 </span><span class="default">? <a href="dictionary_N.html#17838">DIM</a> : <a href="dictionary_N.html#17849">dim</a>); ++<a href="dictionary_I.html#17973">i</a>) {</span>
<a name="1023"><font size=-1>1023     </font></a><span class="default">						</span><span class="keyword">if </span><span class="default">(<a href="dictionary_N.html#17906">dataset_get</a>(<a href="dictionary_K.html#17972">k</a>,<a href="dictionary_I.html#17973">i</a>)&lt;<a href="dictionary_B.html#17916">bbox</a>[<a href="dictionary_I.html#17973">i</a>].<a href="dictionary_L.html#17971">low</a>) <a href="dictionary_B.html#17916">bbox</a>[<a href="dictionary_I.html#17973">i</a>].<a href="dictionary_L.html#17971">low</a> = <a href="dictionary_N.html#17906">dataset_get</a>(<a href="dictionary_K.html#17972">k</a>,<a href="dictionary_I.html#17973">i</a>);</span>
<a name="1024"><font size=-1>1024     </font></a><span class="default">						</span><span class="keyword">if </span><span class="default">(<a href="dictionary_N.html#17906">dataset_get</a>(<a href="dictionary_K.html#17972">k</a>,<a href="dictionary_I.html#17973">i</a>)&gt;<a href="dictionary_B.html#17916">bbox</a>[<a href="dictionary_I.html#17973">i</a>].<a href="dictionary_H.html#17970">high</a>) <a href="dictionary_B.html#17916">bbox</a>[<a href="dictionary_I.html#17973">i</a>].<a href="dictionary_H.html#17970">high</a> = <a href="dictionary_N.html#17906">dataset_get</a>(<a href="dictionary_K.html#17972">k</a>,<a href="dictionary_I.html#17973">i</a>);</span>
<a name="1025"><font size=-1>1025     </font></a><span class="default">					}</span>
<a name="1026"><font size=-1>1026     </font></a><span class="default">				}</span>
<a name="1027"><font size=-1>1027     </font></a><span class="default">			}</span>
<a name="1028"><font size=-1>1028     </font></a><span class="default">		}</span>
<a name="1029"><font size=-1>1029     </font></a><span class="default"></span>
<a name="1030"><font size=-1>1030     </font></a><span class="default"></span>
<a name="1031"><font size=-1>1031     </font></a><span class="default">		</span><span class="comment">/**</span>
<a name="1032"><font size=-1>1032     </font></a><span class="comment">		 * Create a tree node that subdivides the list of vecs from vind[first]</span>
<a name="1033"><font size=-1>1033     </font></a><span class="comment">		 * to vind[last].  The routine is called recursively on each sublist.</span>
<a name="1034"><font size=-1>1034     </font></a><span class="comment">		 *</span>
<a name="1035"><font size=-1>1035     </font></a><span class="comment">		 * @param left index of the first vector</span>
<a name="1036"><font size=-1>1036     </font></a><span class="comment">		 * @param right index of the last vector</span>
<a name="1037"><font size=-1>1037     </font></a><span class="comment">		 */</span>
<a name="1038"><font size=-1>1038     </font></a><span class="comment">		<a href="dictionary_N.html#17864">NodePtr</a> <a href="dictionary_N.html#17917">divideTree</a></span><span class="default">(</span><span class="keyword">const <a href="dictionary_N.html#17839">IndexType</a> <a href="dictionary_L.html#17918">left</a></span><span class="default">, </span><span class="keyword">const <a href="dictionary_N.html#17839">IndexType</a> <a href="dictionary_R.html#17919">right</a></span><span class="default">, <a href="dictionary_N.html#17868">BoundingBox</a>&amp; <a href="dictionary_B.html#17920">bbox</a>)</span>
<a name="1039"><font size=-1>1039     </font></a><span class="default">		{</span>
<a name="1040"><font size=-1>1040     </font></a><span class="default">			<a href="dictionary_N.html#17864">NodePtr</a> <a href="dictionary_N.html#17974">node</a> = <a href="dictionary_N.html#17872">pool</a>.<a href="dictionary_N.html#17756">allocate</a>&lt;Node&gt;(); </span><span class="comment">// allocate memory</span>
<a name="1041"><font size=-1>1041     </font></a><span class="comment"></span>
<a name="1042"><font size=-1>1042     </font></a><span class="comment">			/* If too few exemplars remain, then make this a leaf node. */</span>
<a name="1043"><font size=-1>1043     </font></a><span class="comment">			</span><span class="keyword">if </span><span class="default">( (<a href="dictionary_R.html#17919">right</a>-<a href="dictionary_L.html#17918">left</a>) &lt;= </span><span class="keyword">static_cast</span><span class="default">&lt;<a href="dictionary_N.html#17839">IndexType</a>&gt;(<a href="dictionary_N.html#17844">m_leaf_max_size</a>) ) {</span>
<a name="1044"><font size=-1>1044     </font></a><span class="default">				<a href="dictionary_N.html#17974">node</a>-&gt;<a href="dictionary_N.html#17862">child1</a> = <a href="dictionary_N.html#17974">node</a>-&gt;<a href="dictionary_N.html#17863">child2</a> = <a href="dictionary_N.html#439">NULL</a>;    </span><span class="comment">/* Mark as leaf node. */</span>
<a name="1045"><font size=-1>1045     </font></a><span class="comment">				<a href="dictionary_N.html#17974">node</a></span><span class="default">-&gt;<a href="dictionary_N.html#17861">node_type</a>.<a href="dictionary_L.html#17855">lr</a>.<a href="dictionary_L.html#17853">left</a> = <a href="dictionary_L.html#17918">left</a>;</span>
<a name="1046"><font size=-1>1046     </font></a><span class="default">				<a href="dictionary_N.html#17974">node</a>-&gt;<a href="dictionary_N.html#17861">node_type</a>.<a href="dictionary_L.html#17855">lr</a>.<a href="dictionary_L.html#17854">right</a> = <a href="dictionary_R.html#17919">right</a>;</span>
<a name="1047"><font size=-1>1047     </font></a><span class="default"></span>
<a name="1048"><font size=-1>1048     </font></a><span class="default">				</span><span class="comment">// compute bounding-box of leaf points</span>
<a name="1049"><font size=-1>1049     </font></a><span class="comment">				</span><span class="keyword">for </span><span class="default">(</span><span class="keyword">int <a href="dictionary_I.html#17975">i</a></span><span class="default">=</span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#17975">i</a>&lt;(<a href="dictionary_N.html#17838">DIM</a>&gt;</span><span class="number">0 </span><span class="default">? <a href="dictionary_N.html#17838">DIM</a> : <a href="dictionary_N.html#17849">dim</a>); ++<a href="dictionary_I.html#17975">i</a>) {</span>
<a name="1050"><font size=-1>1050     </font></a><span class="default">					<a href="dictionary_B.html#17920">bbox</a>[<a href="dictionary_I.html#17975">i</a>].<a href="dictionary_L.html#17971">low</a> = <a href="dictionary_N.html#17906">dataset_get</a>(<a href="dictionary_N.html#17843">vind</a>[<a href="dictionary_L.html#17918">left</a>],<a href="dictionary_I.html#17975">i</a>);</span>
<a name="1051"><font size=-1>1051     </font></a><span class="default">					<a href="dictionary_B.html#17920">bbox</a>[<a href="dictionary_I.html#17975">i</a>].<a href="dictionary_H.html#17970">high</a> = <a href="dictionary_N.html#17906">dataset_get</a>(<a href="dictionary_N.html#17843">vind</a>[<a href="dictionary_L.html#17918">left</a>],<a href="dictionary_I.html#17975">i</a>);</span>
<a name="1052"><font size=-1>1052     </font></a><span class="default">				}</span>
<a name="1053"><font size=-1>1053     </font></a><span class="default">				</span><span class="keyword">for </span><span class="default">(<a href="dictionary_N.html#17839">IndexType</a> <a href="dictionary_K.html#17976">k</a>=<a href="dictionary_L.html#17918">left</a>+</span><span class="number">1</span><span class="default">; <a href="dictionary_K.html#17976">k</a>&lt;<a href="dictionary_R.html#17919">right</a>; ++<a href="dictionary_K.html#17976">k</a>) {</span>
<a name="1054"><font size=-1>1054     </font></a><span class="default">					</span><span class="keyword">for </span><span class="default">(</span><span class="keyword">int <a href="dictionary_I.html#17977">i</a></span><span class="default">=</span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#17977">i</a>&lt;(<a href="dictionary_N.html#17838">DIM</a>&gt;</span><span class="number">0 </span><span class="default">? <a href="dictionary_N.html#17838">DIM</a> : <a href="dictionary_N.html#17849">dim</a>); ++<a href="dictionary_I.html#17977">i</a>) {</span>
<a name="1055"><font size=-1>1055     </font></a><span class="default">						</span><span class="keyword">if </span><span class="default">(<a href="dictionary_B.html#17920">bbox</a>[<a href="dictionary_I.html#17977">i</a>].<a href="dictionary_L.html#17971">low</a>&gt;<a href="dictionary_N.html#17906">dataset_get</a>(<a href="dictionary_N.html#17843">vind</a>[<a href="dictionary_K.html#17976">k</a>],<a href="dictionary_I.html#17977">i</a>)) <a href="dictionary_B.html#17920">bbox</a>[<a href="dictionary_I.html#17977">i</a>].<a href="dictionary_L.html#17971">low</a>=<a href="dictionary_N.html#17906">dataset_get</a>(<a href="dictionary_N.html#17843">vind</a>[<a href="dictionary_K.html#17976">k</a>],<a href="dictionary_I.html#17977">i</a>);</span>
<a name="1056"><font size=-1>1056     </font></a><span class="default">						</span><span class="keyword">if </span><span class="default">(<a href="dictionary_B.html#17920">bbox</a>[<a href="dictionary_I.html#17977">i</a>].<a href="dictionary_H.html#17970">high</a>&lt;<a href="dictionary_N.html#17906">dataset_get</a>(<a href="dictionary_N.html#17843">vind</a>[<a href="dictionary_K.html#17976">k</a>],<a href="dictionary_I.html#17977">i</a>)) <a href="dictionary_B.html#17920">bbox</a>[<a href="dictionary_I.html#17977">i</a>].<a href="dictionary_H.html#17970">high</a>=<a href="dictionary_N.html#17906">dataset_get</a>(<a href="dictionary_N.html#17843">vind</a>[<a href="dictionary_K.html#17976">k</a>],<a href="dictionary_I.html#17977">i</a>);</span>
<a name="1057"><font size=-1>1057     </font></a><span class="default">					}</span>
<a name="1058"><font size=-1>1058     </font></a><span class="default">				}</span>
<a name="1059"><font size=-1>1059     </font></a><span class="default">			}</span>
<a name="1060"><font size=-1>1060     </font></a><span class="default">			</span><span class="keyword">else </span><span class="default">{</span>
<a name="1061"><font size=-1>1061     </font></a><span class="default">				<a href="dictionary_N.html#17839">IndexType</a> <a href="dictionary_I.html#17978">idx</a>;</span>
<a name="1062"><font size=-1>1062     </font></a><span class="default">				</span><span class="keyword">int <a href="dictionary_C.html#17979">cutfeat</a></span><span class="default">;</span>
<a name="1063"><font size=-1>1063     </font></a><span class="default">				<a href="dictionary_N.html#17842">DistanceType</a> <a href="dictionary_C.html#17980">cutval</a>;</span>
<a name="1064"><font size=-1>1064     </font></a><span class="default">				<a href="dictionary_N.html#17927">middleSplit_</a>(&amp;<a href="dictionary_N.html#17843">vind</a>[</span><span class="number">0</span><span class="default">]+<a href="dictionary_L.html#17918">left</a>, <a href="dictionary_R.html#17919">right</a>-<a href="dictionary_L.html#17918">left</a>, <a href="dictionary_I.html#17978">idx</a>, <a href="dictionary_C.html#17979">cutfeat</a>, <a href="dictionary_C.html#17980">cutval</a>, <a href="dictionary_B.html#17920">bbox</a>);</span>
<a name="1065"><font size=-1>1065     </font></a><span class="default"></span>
<a name="1066"><font size=-1>1066     </font></a><span class="default">				<a href="dictionary_N.html#17974">node</a>-&gt;<a href="dictionary_N.html#17861">node_type</a>.<a href="dictionary_S.html#17860">sub</a>.<a href="dictionary_N.html#17857">divfeat</a> = <a href="dictionary_C.html#17979">cutfeat</a>;</span>
<a name="1067"><font size=-1>1067     </font></a><span class="default"></span>
<a name="1068"><font size=-1>1068     </font></a><span class="default">				<a href="dictionary_N.html#17868">BoundingBox</a> <a href="dictionary_L.html#17981">left_bbox</a>(<a href="dictionary_B.html#17920">bbox</a>);</span>
<a name="1069"><font size=-1>1069     </font></a><span class="default">				<a href="dictionary_L.html#17981">left_bbox</a>[<a href="dictionary_C.html#17979">cutfeat</a>].<a href="dictionary_H.html#17970">high</a> = <a href="dictionary_C.html#17980">cutval</a>;</span>
<a name="1070"><font size=-1>1070     </font></a><span class="default">				<a href="dictionary_N.html#17974">node</a>-&gt;<a href="dictionary_N.html#17862">child1</a> = <a href="dictionary_N.html#17917">divideTree</a>(<a href="dictionary_L.html#17918">left</a>, <a href="dictionary_L.html#17918">left</a>+<a href="dictionary_I.html#17978">idx</a>, <a href="dictionary_L.html#17981">left_bbox</a>);</span>
<a name="1071"><font size=-1>1071     </font></a><span class="default"></span>
<a name="1072"><font size=-1>1072     </font></a><span class="default">				<a href="dictionary_N.html#17868">BoundingBox</a> <a href="dictionary_R.html#17982">right_bbox</a>(<a href="dictionary_B.html#17920">bbox</a>);</span>
<a name="1073"><font size=-1>1073     </font></a><span class="default">				<a href="dictionary_R.html#17982">right_bbox</a>[<a href="dictionary_C.html#17979">cutfeat</a>].<a href="dictionary_L.html#17971">low</a> = <a href="dictionary_C.html#17980">cutval</a>;</span>
<a name="1074"><font size=-1>1074     </font></a><span class="default">				<a href="dictionary_N.html#17974">node</a>-&gt;<a href="dictionary_N.html#17863">child2</a> = <a href="dictionary_N.html#17917">divideTree</a>(<a href="dictionary_L.html#17918">left</a>+<a href="dictionary_I.html#17978">idx</a>, <a href="dictionary_R.html#17919">right</a>, <a href="dictionary_R.html#17982">right_bbox</a>);</span>
<a name="1075"><font size=-1>1075     </font></a><span class="default"></span>
<a name="1076"><font size=-1>1076     </font></a><span class="default">				<a href="dictionary_N.html#17974">node</a>-&gt;<a href="dictionary_N.html#17861">node_type</a>.<a href="dictionary_S.html#17860">sub</a>.<a href="dictionary_N.html#17858">divlow</a> = <a href="dictionary_L.html#17981">left_bbox</a>[<a href="dictionary_C.html#17979">cutfeat</a>].<a href="dictionary_H.html#17970">high</a>;</span>
<a name="1077"><font size=-1>1077     </font></a><span class="default">				<a href="dictionary_N.html#17974">node</a>-&gt;<a href="dictionary_N.html#17861">node_type</a>.<a href="dictionary_S.html#17860">sub</a>.<a href="dictionary_N.html#17859">divhigh</a> = <a href="dictionary_R.html#17982">right_bbox</a>[<a href="dictionary_C.html#17979">cutfeat</a>].<a href="dictionary_L.html#17971">low</a>;</span>
<a name="1078"><font size=-1>1078     </font></a><span class="default"></span>
<a name="1079"><font size=-1>1079     </font></a><span class="default">				</span><span class="keyword">for </span><span class="default">(</span><span class="keyword">int <a href="dictionary_I.html#17983">i</a></span><span class="default">=</span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#17983">i</a>&lt;(<a href="dictionary_N.html#17838">DIM</a>&gt;</span><span class="number">0 </span><span class="default">? <a href="dictionary_N.html#17838">DIM</a> : <a href="dictionary_N.html#17849">dim</a>); ++<a href="dictionary_I.html#17983">i</a>) {</span>
<a name="1080"><font size=-1>1080     </font></a><span class="default">					<a href="dictionary_B.html#17920">bbox</a>[<a href="dictionary_I.html#17983">i</a>].<a href="dictionary_L.html#17971">low</a> = std::<a href="dictionary_S.html#451">min</a>(<a href="dictionary_L.html#17981">left_bbox</a>[<a href="dictionary_I.html#17983">i</a>].<a href="dictionary_L.html#17971">low</a>, <a href="dictionary_R.html#17982">right_bbox</a>[<a href="dictionary_I.html#17983">i</a>].<a href="dictionary_L.html#17971">low</a>);</span>
<a name="1081"><font size=-1>1081     </font></a><span class="default">					<a href="dictionary_B.html#17920">bbox</a>[<a href="dictionary_I.html#17983">i</a>].<a href="dictionary_H.html#17970">high</a> = std::<a href="dictionary_S.html#450">max</a>(<a href="dictionary_L.html#17981">left_bbox</a>[<a href="dictionary_I.html#17983">i</a>].<a href="dictionary_H.html#17970">high</a>, <a href="dictionary_R.html#17982">right_bbox</a>[<a href="dictionary_I.html#17983">i</a>].<a href="dictionary_H.html#17970">high</a>);</span>
<a name="1082"><font size=-1>1082     </font></a><span class="default">				}</span>
<a name="1083"><font size=-1>1083     </font></a><span class="default">			}</span>
<a name="1084"><font size=-1>1084     </font></a><span class="default"></span>
<a name="1085"><font size=-1>1085     </font></a><span class="default">			</span><span class="keyword">return <a href="dictionary_N.html#17974">node</a></span><span class="default">;</span>
<a name="1086"><font size=-1>1086     </font></a><span class="default">		}</span>
<a name="1087"><font size=-1>1087     </font></a><span class="default"></span>
<a name="1088"><font size=-1>1088     </font></a><span class="default"></span>
<a name="1089"><font size=-1>1089     </font></a><span class="default">		</span><span class="keyword">void <a href="dictionary_N.html#17921">computeMinMax</a></span><span class="default">(<a href="dictionary_N.html#17839">IndexType</a>* <a href="dictionary_I.html#17922">ind</a>, <a href="dictionary_N.html#17839">IndexType</a> <a href="dictionary_C.html#17923">count</a>, </span><span class="keyword">int <a href="dictionary_E.html#17924">element</a></span><span class="default">, <a href="dictionary_N.html#17841">ElementType</a>&amp; <a href="dictionary_M.html#17925">min_elem</a>, <a href="dictionary_N.html#17841">ElementType</a>&amp; <a href="dictionary_M.html#17926">max_elem</a>)</span>
<a name="1090"><font size=-1>1090     </font></a><span class="default">		{</span>
<a name="1091"><font size=-1>1091     </font></a><span class="default">			<a href="dictionary_M.html#17925">min_elem</a> = <a href="dictionary_N.html#17906">dataset_get</a>(<a href="dictionary_I.html#17922">ind</a>[</span><span class="number">0</span><span class="default">],<a href="dictionary_E.html#17924">element</a>);</span>
<a name="1092"><font size=-1>1092     </font></a><span class="default">			<a href="dictionary_M.html#17926">max_elem</a> = <a href="dictionary_N.html#17906">dataset_get</a>(<a href="dictionary_I.html#17922">ind</a>[</span><span class="number">0</span><span class="default">],<a href="dictionary_E.html#17924">element</a>);</span>
<a name="1093"><font size=-1>1093     </font></a><span class="default">			</span><span class="keyword">for </span><span class="default">(<a href="dictionary_N.html#17839">IndexType</a> <a href="dictionary_I.html#17984">i</a>=</span><span class="number">1</span><span class="default">; <a href="dictionary_I.html#17984">i</a>&lt;<a href="dictionary_C.html#17923">count</a>; ++<a href="dictionary_I.html#17984">i</a>) {</span>
<a name="1094"><font size=-1>1094     </font></a><span class="default">				<a href="dictionary_N.html#17841">ElementType</a> <a href="dictionary_V.html#17985">val</a> = <a href="dictionary_N.html#17906">dataset_get</a>(<a href="dictionary_I.html#17922">ind</a>[<a href="dictionary_I.html#17984">i</a>],<a href="dictionary_E.html#17924">element</a>);</span>
<a name="1095"><font size=-1>1095     </font></a><span class="default">				</span><span class="keyword">if </span><span class="default">(<a href="dictionary_V.html#17985">val</a>&lt;<a href="dictionary_M.html#17925">min_elem</a>) <a href="dictionary_M.html#17925">min_elem</a> = <a href="dictionary_V.html#17985">val</a>;</span>
<a name="1096"><font size=-1>1096     </font></a><span class="default">				</span><span class="keyword">if </span><span class="default">(<a href="dictionary_V.html#17985">val</a>&gt;<a href="dictionary_M.html#17926">max_elem</a>) <a href="dictionary_M.html#17926">max_elem</a> = <a href="dictionary_V.html#17985">val</a>;</span>
<a name="1097"><font size=-1>1097     </font></a><span class="default">			}</span>
<a name="1098"><font size=-1>1098     </font></a><span class="default">		}</span>
<a name="1099"><font size=-1>1099     </font></a><span class="default"></span>
<a name="1100"><font size=-1>1100     </font></a><span class="default">		</span><span class="keyword">void <a href="dictionary_N.html#17927">middleSplit_</a></span><span class="default">(<a href="dictionary_N.html#17839">IndexType</a>* <a href="dictionary_I.html#17928">ind</a>, <a href="dictionary_N.html#17839">IndexType</a> <a href="dictionary_C.html#17929">count</a>, <a href="dictionary_N.html#17839">IndexType</a>&amp; <a href="dictionary_I.html#17930">index</a>, </span><span class="keyword">int</span><span class="default">&amp; <a href="dictionary_C.html#17931">cutfeat</a>, <a href="dictionary_N.html#17842">DistanceType</a>&amp; <a href="dictionary_C.html#17932">cutval</a>, </span><span class="keyword">const <a href="dictionary_N.html#17868">BoundingBox</a></span><span class="default">&amp; <a href="dictionary_B.html#17933">bbox</a>)</span>
<a name="1101"><font size=-1>1101     </font></a><span class="default">		{</span>
<a name="1102"><font size=-1>1102     </font></a><span class="default">			</span><span class="keyword">const <a href="dictionary_N.html#17842">DistanceType</a> <a href="dictionary_E.html#17986">EPS</a></span><span class="default">=</span><span class="keyword">static_cast</span><span class="default">&lt;<a href="dictionary_N.html#17842">DistanceType</a>&gt;(</span><span class="number">0.00001</span><span class="default">);</span>
<a name="1103"><font size=-1>1103     </font></a><span class="default">			<a href="dictionary_N.html#17841">ElementType</a> <a href="dictionary_M.html#17987">max_span</a> = <a href="dictionary_B.html#17933">bbox</a>[</span><span class="number">0</span><span class="default">].<a href="dictionary_H.html#17970">high</a>-<a href="dictionary_B.html#17933">bbox</a>[</span><span class="number">0</span><span class="default">].<a href="dictionary_L.html#17971">low</a>;</span>
<a name="1104"><font size=-1>1104     </font></a><span class="default">			</span><span class="keyword">for </span><span class="default">(</span><span class="keyword">int <a href="dictionary_I.html#17988">i</a></span><span class="default">=</span><span class="number">1</span><span class="default">; <a href="dictionary_I.html#17988">i</a>&lt;(<a href="dictionary_N.html#17838">DIM</a>&gt;</span><span class="number">0 </span><span class="default">? <a href="dictionary_N.html#17838">DIM</a> : <a href="dictionary_N.html#17849">dim</a>); ++<a href="dictionary_I.html#17988">i</a>) {</span>
<a name="1105"><font size=-1>1105     </font></a><span class="default">				<a href="dictionary_N.html#17841">ElementType</a> <a href="dictionary_S.html#17989">span</a> = <a href="dictionary_B.html#17933">bbox</a>[<a href="dictionary_I.html#17988">i</a>].<a href="dictionary_H.html#17970">high</a>-<a href="dictionary_B.html#17933">bbox</a>[<a href="dictionary_I.html#17988">i</a>].<a href="dictionary_L.html#17971">low</a>;</span>
<a name="1106"><font size=-1>1106     </font></a><span class="default">				</span><span class="keyword">if </span><span class="default">(<a href="dictionary_S.html#17989">span</a>&gt;<a href="dictionary_M.html#17987">max_span</a>) {</span>
<a name="1107"><font size=-1>1107     </font></a><span class="default">					<a href="dictionary_M.html#17987">max_span</a> = <a href="dictionary_S.html#17989">span</a>;</span>
<a name="1108"><font size=-1>1108     </font></a><span class="default">				}</span>
<a name="1109"><font size=-1>1109     </font></a><span class="default">			}</span>
<a name="1110"><font size=-1>1110     </font></a><span class="default">			<a href="dictionary_N.html#17841">ElementType</a> <a href="dictionary_M.html#17990">max_spread</a> = -</span><span class="number">1</span><span class="default">;</span>
<a name="1111"><font size=-1>1111     </font></a><span class="default">			<a href="dictionary_C.html#17931">cutfeat</a> = </span><span class="number">0</span><span class="default">;</span>
<a name="1112"><font size=-1>1112     </font></a><span class="default">			</span><span class="keyword">for </span><span class="default">(</span><span class="keyword">int <a href="dictionary_I.html#17991">i</a></span><span class="default">=</span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#17991">i</a>&lt;(<a href="dictionary_N.html#17838">DIM</a>&gt;</span><span class="number">0 </span><span class="default">? <a href="dictionary_N.html#17838">DIM</a> : <a href="dictionary_N.html#17849">dim</a>); ++<a href="dictionary_I.html#17991">i</a>) {</span>
<a name="1113"><font size=-1>1113     </font></a><span class="default">				<a href="dictionary_N.html#17841">ElementType</a> <a href="dictionary_S.html#17992">span</a> = <a href="dictionary_B.html#17933">bbox</a>[<a href="dictionary_I.html#17991">i</a>].<a href="dictionary_H.html#17970">high</a>-<a href="dictionary_B.html#17933">bbox</a>[<a href="dictionary_I.html#17991">i</a>].<a href="dictionary_L.html#17971">low</a>;</span>
<a name="1114"><font size=-1>1114     </font></a><span class="default">				</span><span class="keyword">if </span><span class="default">(<a href="dictionary_S.html#17992">span</a>&gt;(</span><span class="number">1</span><span class="default">-<a href="dictionary_E.html#17986">EPS</a>)*<a href="dictionary_M.html#17987">max_span</a>) {</span>
<a name="1115"><font size=-1>1115     </font></a><span class="default">					<a href="dictionary_N.html#17841">ElementType</a> <a href="dictionary_M.html#17993">min_elem</a>, <a href="dictionary_M.html#17994">max_elem</a>;</span>
<a name="1116"><font size=-1>1116     </font></a><span class="default">					<a href="dictionary_N.html#17921">computeMinMax</a>(<a href="dictionary_I.html#17928">ind</a>, <a href="dictionary_C.html#17929">count</a>, <a href="dictionary_C.html#17931">cutfeat</a>, <a href="dictionary_M.html#17993">min_elem</a>, <a href="dictionary_M.html#17994">max_elem</a>);</span>
<a name="1117"><font size=-1>1117     </font></a><span class="default">					<a href="dictionary_N.html#17841">ElementType</a> <a href="dictionary_S.html#17995">spread</a> = <a href="dictionary_M.html#17994">max_elem</a>-<a href="dictionary_M.html#17993">min_elem</a>;;</span>
<a name="1118"><font size=-1>1118     </font></a><span class="default">					</span><span class="keyword">if </span><span class="default">(<a href="dictionary_S.html#17995">spread</a>&gt;<a href="dictionary_M.html#17990">max_spread</a>) {</span>
<a name="1119"><font size=-1>1119     </font></a><span class="default">						<a href="dictionary_C.html#17931">cutfeat</a> = <a href="dictionary_I.html#17991">i</a>;</span>
<a name="1120"><font size=-1>1120     </font></a><span class="default">						<a href="dictionary_M.html#17990">max_spread</a> = <a href="dictionary_S.html#17995">spread</a>;</span>
<a name="1121"><font size=-1>1121     </font></a><span class="default">					}</span>
<a name="1122"><font size=-1>1122     </font></a><span class="default">				}</span>
<a name="1123"><font size=-1>1123     </font></a><span class="default">			}</span>
<a name="1124"><font size=-1>1124     </font></a><span class="default">			</span><span class="comment">// split in the middle</span>
<a name="1125"><font size=-1>1125     </font></a><span class="comment">			<a href="dictionary_N.html#17842">DistanceType</a> <a href="dictionary_S.html#17996">split_val</a> </span><span class="default">= (<a href="dictionary_B.html#17933">bbox</a>[<a href="dictionary_C.html#17931">cutfeat</a>].<a href="dictionary_L.html#17971">low</a>+<a href="dictionary_B.html#17933">bbox</a>[<a href="dictionary_C.html#17931">cutfeat</a>].<a href="dictionary_H.html#17970">high</a>)/</span><span class="number">2</span><span class="default">;</span>
<a name="1126"><font size=-1>1126     </font></a><span class="default">			<a href="dictionary_N.html#17841">ElementType</a> <a href="dictionary_M.html#17997">min_elem</a>, <a href="dictionary_M.html#17998">max_elem</a>;</span>
<a name="1127"><font size=-1>1127     </font></a><span class="default">			<a href="dictionary_N.html#17921">computeMinMax</a>(<a href="dictionary_I.html#17928">ind</a>, <a href="dictionary_C.html#17929">count</a>, <a href="dictionary_C.html#17931">cutfeat</a>, <a href="dictionary_M.html#17997">min_elem</a>, <a href="dictionary_M.html#17998">max_elem</a>);</span>
<a name="1128"><font size=-1>1128     </font></a><span class="default"></span>
<a name="1129"><font size=-1>1129     </font></a><span class="default">			</span><span class="keyword">if </span><span class="default">(<a href="dictionary_S.html#17996">split_val</a>&lt;<a href="dictionary_M.html#17997">min_elem</a>) <a href="dictionary_C.html#17932">cutval</a> = <a href="dictionary_M.html#17997">min_elem</a>;</span>
<a name="1130"><font size=-1>1130     </font></a><span class="default">			</span><span class="keyword">else if </span><span class="default">(<a href="dictionary_S.html#17996">split_val</a>&gt;<a href="dictionary_M.html#17998">max_elem</a>) <a href="dictionary_C.html#17932">cutval</a> = <a href="dictionary_M.html#17998">max_elem</a>;</span>
<a name="1131"><font size=-1>1131     </font></a><span class="default">			</span><span class="keyword">else <a href="dictionary_C.html#17932">cutval</a> </span><span class="default">= <a href="dictionary_S.html#17996">split_val</a>;</span>
<a name="1132"><font size=-1>1132     </font></a><span class="default"></span>
<a name="1133"><font size=-1>1133     </font></a><span class="default">			<a href="dictionary_N.html#17839">IndexType</a> <a href="dictionary_L.html#17999">lim1</a>, <a href="dictionary_L.html#18000">lim2</a>;</span>
<a name="1134"><font size=-1>1134     </font></a><span class="default">			<a href="dictionary_N.html#17934">planeSplit</a>(<a href="dictionary_I.html#17928">ind</a>, <a href="dictionary_C.html#17929">count</a>, <a href="dictionary_C.html#17931">cutfeat</a>, <a href="dictionary_C.html#17932">cutval</a>, <a href="dictionary_L.html#17999">lim1</a>, <a href="dictionary_L.html#18000">lim2</a>);</span>
<a name="1135"><font size=-1>1135     </font></a><span class="default"></span>
<a name="1136"><font size=-1>1136     </font></a><span class="default">			</span><span class="keyword">if </span><span class="default">(<a href="dictionary_L.html#17999">lim1</a>&gt;<a href="dictionary_C.html#17929">count</a>/</span><span class="number">2</span><span class="default">) <a href="dictionary_I.html#17930">index</a> = <a href="dictionary_L.html#17999">lim1</a>;</span>
<a name="1137"><font size=-1>1137     </font></a><span class="default">			</span><span class="keyword">else if </span><span class="default">(<a href="dictionary_L.html#18000">lim2</a>&lt;<a href="dictionary_C.html#17929">count</a>/</span><span class="number">2</span><span class="default">) <a href="dictionary_I.html#17930">index</a> = <a href="dictionary_L.html#18000">lim2</a>;</span>
<a name="1138"><font size=-1>1138     </font></a><span class="default">			</span><span class="keyword">else <a href="dictionary_I.html#17930">index</a> </span><span class="default">= <a href="dictionary_C.html#17929">count</a>/</span><span class="number">2</span><span class="default">;</span>
<a name="1139"><font size=-1>1139     </font></a><span class="default">		}</span>
<a name="1140"><font size=-1>1140     </font></a><span class="default"></span>
<a name="1141"><font size=-1>1141     </font></a><span class="default"></span>
<a name="1142"><font size=-1>1142     </font></a><span class="default">		</span><span class="comment">/**</span>
<a name="1143"><font size=-1>1143     </font></a><span class="comment">		 *  Subdivide the list of points by a plane perpendicular on axe corresponding</span>
<a name="1144"><font size=-1>1144     </font></a><span class="comment">		 *  to the 'cutfeat' dimension at 'cutval' position.</span>
<a name="1145"><font size=-1>1145     </font></a><span class="comment">		 *</span>
<a name="1146"><font size=-1>1146     </font></a><span class="comment">		 *  On return:</span>
<a name="1147"><font size=-1>1147     </font></a><span class="comment">		 *  dataset[ind[0..lim1-1]][cutfeat]&lt;cutval</span>
<a name="1148"><font size=-1>1148     </font></a><span class="comment">		 *  dataset[ind[lim1..lim2-1]][cutfeat]==cutval</span>
<a name="1149"><font size=-1>1149     </font></a><span class="comment">		 *  dataset[ind[lim2..count]][cutfeat]&gt;cutval</span>
<a name="1150"><font size=-1>1150     </font></a><span class="comment">		 */</span>
<a name="1151"><font size=-1>1151     </font></a><span class="comment">		</span><span class="keyword">void <a href="dictionary_N.html#17934">planeSplit</a></span><span class="default">(<a href="dictionary_N.html#17839">IndexType</a>* <a href="dictionary_I.html#17935">ind</a>, </span><span class="keyword">const <a href="dictionary_N.html#17839">IndexType</a> <a href="dictionary_C.html#17936">count</a></span><span class="default">, </span><span class="keyword">int <a href="dictionary_C.html#17937">cutfeat</a></span><span class="default">, <a href="dictionary_N.html#17842">DistanceType</a> &amp;<a href="dictionary_C.html#17938">cutval</a>, <a href="dictionary_N.html#17839">IndexType</a>&amp; <a href="dictionary_L.html#17939">lim1</a>, <a href="dictionary_N.html#17839">IndexType</a>&amp; <a href="dictionary_L.html#17940">lim2</a>)</span>
<a name="1152"><font size=-1>1152     </font></a><span class="default">		{</span>
<a name="1153"><font size=-1>1153     </font></a><span class="default">			</span><span class="comment">/* Move vector indices for left subtree to front of list. */</span>
<a name="1154"><font size=-1>1154     </font></a><span class="comment">			<a href="dictionary_N.html#17839">IndexType</a> <a href="dictionary_L.html#18001">left</a> </span><span class="default">= </span><span class="number">0</span><span class="default">;</span>
<a name="1155"><font size=-1>1155     </font></a><span class="default">			<a href="dictionary_N.html#17839">IndexType</a> <a href="dictionary_R.html#18002">right</a> = <a href="dictionary_C.html#17936">count</a>-</span><span class="number">1</span><span class="default">;</span>
<a name="1156"><font size=-1>1156     </font></a><span class="default">			</span><span class="keyword">for </span><span class="default">(;; ) {</span>
<a name="1157"><font size=-1>1157     </font></a><span class="default">				</span><span class="keyword">while </span><span class="default">(<a href="dictionary_L.html#18001">left</a>&lt;=<a href="dictionary_R.html#18002">right</a> &amp;&amp; <a href="dictionary_N.html#17906">dataset_get</a>(<a href="dictionary_I.html#17935">ind</a>[<a href="dictionary_L.html#18001">left</a>],<a href="dictionary_C.html#17937">cutfeat</a>)&lt;<a href="dictionary_C.html#17938">cutval</a>) ++<a href="dictionary_L.html#18001">left</a>;</span>
<a name="1158"><font size=-1>1158     </font></a><span class="default">				</span><span class="keyword">while </span><span class="default">(<a href="dictionary_R.html#18002">right</a> &amp;&amp; <a href="dictionary_L.html#18001">left</a>&lt;=<a href="dictionary_R.html#18002">right</a> &amp;&amp; <a href="dictionary_N.html#17906">dataset_get</a>(<a href="dictionary_I.html#17935">ind</a>[<a href="dictionary_R.html#18002">right</a>],<a href="dictionary_C.html#17937">cutfeat</a>)&gt;=<a href="dictionary_C.html#17938">cutval</a>) --<a href="dictionary_R.html#18002">right</a>;</span>
<a name="1159"><font size=-1>1159     </font></a><span class="default">				</span><span class="keyword">if </span><span class="default">(<a href="dictionary_L.html#18001">left</a>&gt;<a href="dictionary_R.html#18002">right</a> || !<a href="dictionary_R.html#18002">right</a>) </span><span class="keyword">break</span><span class="default">;  </span><span class="comment">// &quot;!right&quot; was added to support unsigned Index types</span>
<a name="1160"><font size=-1>1160     </font></a><span class="comment">				</span><span class="default">std::<a href="dictionary_S.html#4519">swap</a>(<a href="dictionary_I.html#17935">ind</a>[<a href="dictionary_L.html#18001">left</a>], <a href="dictionary_I.html#17935">ind</a>[<a href="dictionary_R.html#18002">right</a>]);</span>
<a name="1161"><font size=-1>1161     </font></a><span class="default">				++<a href="dictionary_L.html#18001">left</a>;</span>
<a name="1162"><font size=-1>1162     </font></a><span class="default">				--<a href="dictionary_R.html#18002">right</a>;</span>
<a name="1163"><font size=-1>1163     </font></a><span class="default">			}</span>
<a name="1164"><font size=-1>1164     </font></a><span class="default">			</span><span class="comment">/* If either list is empty, it means that all remaining features</span>
<a name="1165"><font size=-1>1165     </font></a><span class="comment">			 * are identical. Split in the middle to maintain a balanced tree.</span>
<a name="1166"><font size=-1>1166     </font></a><span class="comment">			 */</span>
<a name="1167"><font size=-1>1167     </font></a><span class="comment">			<a href="dictionary_L.html#17939">lim1</a> </span><span class="default">= <a href="dictionary_L.html#18001">left</a>;</span>
<a name="1168"><font size=-1>1168     </font></a><span class="default">			<a href="dictionary_R.html#18002">right</a> = <a href="dictionary_C.html#17936">count</a>-</span><span class="number">1</span><span class="default">;</span>
<a name="1169"><font size=-1>1169     </font></a><span class="default">			</span><span class="keyword">for </span><span class="default">(;; ) {</span>
<a name="1170"><font size=-1>1170     </font></a><span class="default">				</span><span class="keyword">while </span><span class="default">(<a href="dictionary_L.html#18001">left</a>&lt;=<a href="dictionary_R.html#18002">right</a> &amp;&amp; <a href="dictionary_N.html#17906">dataset_get</a>(<a href="dictionary_I.html#17935">ind</a>[<a href="dictionary_L.html#18001">left</a>],<a href="dictionary_C.html#17937">cutfeat</a>)&lt;=<a href="dictionary_C.html#17938">cutval</a>) ++<a href="dictionary_L.html#18001">left</a>;</span>
<a name="1171"><font size=-1>1171     </font></a><span class="default">				</span><span class="keyword">while </span><span class="default">(<a href="dictionary_R.html#18002">right</a> &amp;&amp; <a href="dictionary_L.html#18001">left</a>&lt;=<a href="dictionary_R.html#18002">right</a> &amp;&amp; <a href="dictionary_N.html#17906">dataset_get</a>(<a href="dictionary_I.html#17935">ind</a>[<a href="dictionary_R.html#18002">right</a>],<a href="dictionary_C.html#17937">cutfeat</a>)&gt;<a href="dictionary_C.html#17938">cutval</a>) --<a href="dictionary_R.html#18002">right</a>;</span>
<a name="1172"><font size=-1>1172     </font></a><span class="default">				</span><span class="keyword">if </span><span class="default">(<a href="dictionary_L.html#18001">left</a>&gt;<a href="dictionary_R.html#18002">right</a> || !<a href="dictionary_R.html#18002">right</a>) </span><span class="keyword">break</span><span class="default">;  </span><span class="comment">// &quot;!right&quot; was added to support unsigned Index types</span>
<a name="1173"><font size=-1>1173     </font></a><span class="comment">				</span><span class="default">std::<a href="dictionary_S.html#4519">swap</a>(<a href="dictionary_I.html#17935">ind</a>[<a href="dictionary_L.html#18001">left</a>], <a href="dictionary_I.html#17935">ind</a>[<a href="dictionary_R.html#18002">right</a>]);</span>
<a name="1174"><font size=-1>1174     </font></a><span class="default">				++<a href="dictionary_L.html#18001">left</a>;</span>
<a name="1175"><font size=-1>1175     </font></a><span class="default">				--<a href="dictionary_R.html#18002">right</a>;</span>
<a name="1176"><font size=-1>1176     </font></a><span class="default">			}</span>
<a name="1177"><font size=-1>1177     </font></a><span class="default">			<a href="dictionary_L.html#17940">lim2</a> = <a href="dictionary_L.html#18001">left</a>;</span>
<a name="1178"><font size=-1>1178     </font></a><span class="default">		}</span>
<a name="1179"><font size=-1>1179     </font></a><span class="default"></span>
<a name="1180"><font size=-1>1180     </font></a><span class="default">		<a href="dictionary_N.html#17842">DistanceType</a> <a href="dictionary_N.html#17941">computeInitialDistances</a>(</span><span class="keyword">const <a href="dictionary_N.html#17841">ElementType</a></span><span class="default">* <a href="dictionary_V.html#17942">vec</a>, <a href="dictionary_N.html#17869">distance_vector_t</a>&amp; <a href="dictionary_D.html#17943">dists</a>) </span><span class="keyword">const</span>
<a name="1181"><font size=-1>1181     </font></a><span class="keyword">		</span><span class="default">{</span>
<a name="1182"><font size=-1>1182     </font></a><span class="default">			<a href="dictionary_A.html#8782">assert</a>(<a href="dictionary_V.html#17942">vec</a>);</span>
<a name="1183"><font size=-1>1183     </font></a><span class="default">			<a href="dictionary_N.html#17842">DistanceType</a> <a href="dictionary_D.html#18003">distsq</a> = <a href="dictionary_N.html#17842">DistanceType</a>();</span>
<a name="1184"><font size=-1>1184     </font></a><span class="default"></span>
<a name="1185"><font size=-1>1185     </font></a><span class="default">			</span><span class="keyword">for </span><span class="default">(</span><span class="keyword">int <a href="dictionary_I.html#18004">i</a> </span><span class="default">= </span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#18004">i</a> &lt; (<a href="dictionary_N.html#17838">DIM</a>&gt;</span><span class="number">0 </span><span class="default">? <a href="dictionary_N.html#17838">DIM</a> : <a href="dictionary_N.html#17849">dim</a>); ++<a href="dictionary_I.html#18004">i</a>) {</span>
<a name="1186"><font size=-1>1186     </font></a><span class="default">				</span><span class="keyword">if </span><span class="default">(<a href="dictionary_V.html#17942">vec</a>[<a href="dictionary_I.html#18004">i</a>] &lt; <a href="dictionary_N.html#17871">root_bbox</a>[<a href="dictionary_I.html#18004">i</a>].<a href="dictionary_L.html#17971">low</a>) {</span>
<a name="1187"><font size=-1>1187     </font></a><span class="default">					<a href="dictionary_D.html#17943">dists</a>[<a href="dictionary_I.html#18004">i</a>] = <a href="dictionary_N.html#17873">distance</a>.<a href="dictionary_A.html#18005">accum_dist</a>(<a href="dictionary_V.html#17942">vec</a>[<a href="dictionary_I.html#18004">i</a>], <a href="dictionary_N.html#17871">root_bbox</a>[<a href="dictionary_I.html#18004">i</a>].<a href="dictionary_L.html#17971">low</a>, <a href="dictionary_I.html#18004">i</a>);</span>
<a name="1188"><font size=-1>1188     </font></a><span class="default">					<a href="dictionary_D.html#18003">distsq</a> += <a href="dictionary_D.html#17943">dists</a>[<a href="dictionary_I.html#18004">i</a>];</span>
<a name="1189"><font size=-1>1189     </font></a><span class="default">				}</span>
<a name="1190"><font size=-1>1190     </font></a><span class="default">				</span><span class="keyword">if </span><span class="default">(<a href="dictionary_V.html#17942">vec</a>[<a href="dictionary_I.html#18004">i</a>] &gt; <a href="dictionary_N.html#17871">root_bbox</a>[<a href="dictionary_I.html#18004">i</a>].<a href="dictionary_H.html#17970">high</a>) {</span>
<a name="1191"><font size=-1>1191     </font></a><span class="default">					<a href="dictionary_D.html#17943">dists</a>[<a href="dictionary_I.html#18004">i</a>] = <a href="dictionary_N.html#17873">distance</a>.<a href="dictionary_A.html#18005">accum_dist</a>(<a href="dictionary_V.html#17942">vec</a>[<a href="dictionary_I.html#18004">i</a>], <a href="dictionary_N.html#17871">root_bbox</a>[<a href="dictionary_I.html#18004">i</a>].<a href="dictionary_H.html#17970">high</a>, <a href="dictionary_I.html#18004">i</a>);</span>
<a name="1192"><font size=-1>1192     </font></a><span class="default">					<a href="dictionary_D.html#18003">distsq</a> += <a href="dictionary_D.html#17943">dists</a>[<a href="dictionary_I.html#18004">i</a>];</span>
<a name="1193"><font size=-1>1193     </font></a><span class="default">				}</span>
<a name="1194"><font size=-1>1194     </font></a><span class="default">			}</span>
<a name="1195"><font size=-1>1195     </font></a><span class="default"></span>
<a name="1196"><font size=-1>1196     </font></a><span class="default">			</span><span class="keyword">return <a href="dictionary_D.html#18003">distsq</a></span><span class="default">;</span>
<a name="1197"><font size=-1>1197     </font></a><span class="default">		}</span>
<a name="1198"><font size=-1>1198     </font></a><span class="default"></span>
<a name="1199"><font size=-1>1199     </font></a><span class="default">		</span><span class="comment">/**</span>
<a name="1200"><font size=-1>1200     </font></a><span class="comment">		 * Performs an exact search in the tree starting from a node.</span>
<a name="1201"><font size=-1>1201     </font></a><span class="comment">		 * \tparam RESULTSET Should be any ResultSet&lt;DistanceType&gt;</span>
<a name="1202"><font size=-1>1202     </font></a><span class="comment">		 */</span>
<a name="1203"><font size=-1>1203     </font></a><span class="comment">		</span><span class="keyword">template </span><span class="default">&lt;</span><span class="keyword">class <a href="dictionary_R.html#17945">RESULTSET</a></span><span class="default">&gt;</span>
<a name="1204"><font size=-1>1204     </font></a><span class="default">		</span><span class="keyword">void <a href="dictionary_N.html#17944">searchLevel</a></span><span class="default">(<a href="dictionary_R.html#17945">RESULTSET</a>&amp; <a href="dictionary_R.html#17946">result_set</a>, </span><span class="keyword">const <a href="dictionary_N.html#17841">ElementType</a></span><span class="default">* <a href="dictionary_V.html#17947">vec</a>, </span><span class="keyword">const <a href="dictionary_N.html#17864">NodePtr</a> <a href="dictionary_N.html#17948">node</a></span><span class="default">, <a href="dictionary_N.html#17842">DistanceType</a> <a href="dictionary_M.html#17949">mindistsq</a>,</span>
<a name="1205"><font size=-1>1205     </font></a><span class="default">						 <a href="dictionary_N.html#17869">distance_vector_t</a>&amp; <a href="dictionary_D.html#17950">dists</a>, </span><span class="keyword">const float <a href="dictionary_E.html#17951">epsError</a></span><span class="default">) </span><span class="keyword">const</span>
<a name="1206"><font size=-1>1206     </font></a><span class="keyword">		</span><span class="default">{</span>
<a name="1207"><font size=-1>1207     </font></a><span class="default">			</span><span class="comment">/* If this is a leaf node, then do check and return. */</span>
<a name="1208"><font size=-1>1208     </font></a><span class="comment">			</span><span class="keyword">if </span><span class="default">((<a href="dictionary_N.html#17948">node</a>-&gt;<a href="dictionary_N.html#17862">child1</a> == <a href="dictionary_N.html#439">NULL</a>)&amp;&amp;(<a href="dictionary_N.html#17948">node</a>-&gt;<a href="dictionary_N.html#17863">child2</a> == <a href="dictionary_N.html#439">NULL</a>)) {</span>
<a name="1209"><font size=-1>1209     </font></a><span class="default">				</span><span class="comment">//count_leaf += (node-&gt;lr.right-node-&gt;lr.left);  // Removed since was neither used nor returned to the user.</span>
<a name="1210"><font size=-1>1210     </font></a><span class="comment">				<a href="dictionary_N.html#17842">DistanceType</a> <a href="dictionary_W.html#18006">worst_dist</a> </span><span class="default">= <a href="dictionary_R.html#17946">result_set</a>.<a href="dictionary_W.html#18007">worstDist</a>();</span>
<a name="1211"><font size=-1>1211     </font></a><span class="default">				</span><span class="keyword">for </span><span class="default">(<a href="dictionary_N.html#17839">IndexType</a> <a href="dictionary_I.html#18008">i</a>=<a href="dictionary_N.html#17948">node</a>-&gt;<a href="dictionary_N.html#17861">node_type</a>.<a href="dictionary_L.html#17855">lr</a>.<a href="dictionary_L.html#17853">left</a>; <a href="dictionary_I.html#18008">i</a>&lt;<a href="dictionary_N.html#17948">node</a>-&gt;<a href="dictionary_N.html#17861">node_type</a>.<a href="dictionary_L.html#17855">lr</a>.<a href="dictionary_L.html#17854">right</a>; ++<a href="dictionary_I.html#18008">i</a>) {</span>
<a name="1212"><font size=-1>1212     </font></a><span class="default">					</span><span class="keyword">const <a href="dictionary_N.html#17839">IndexType</a> <a href="dictionary_I.html#18009">index</a> </span><span class="default">= <a href="dictionary_N.html#17843">vind</a>[<a href="dictionary_I.html#18008">i</a>];</span><span class="comment">// reorder... : i;</span>
<a name="1213"><font size=-1>1213     </font></a><span class="comment">					<a href="dictionary_N.html#17842">DistanceType</a> <a href="dictionary_D.html#18010">dist</a> </span><span class="default">= <a href="dictionary_N.html#17873">distance</a>(<a href="dictionary_V.html#17947">vec</a>, <a href="dictionary_I.html#18009">index</a>, (<a href="dictionary_N.html#17838">DIM</a>&gt;</span><span class="number">0 </span><span class="default">? <a href="dictionary_N.html#17838">DIM</a> : <a href="dictionary_N.html#17849">dim</a>));</span>
<a name="1214"><font size=-1>1214     </font></a><span class="default">					</span><span class="keyword">if </span><span class="default">(<a href="dictionary_D.html#18010">dist</a>&lt;<a href="dictionary_W.html#18006">worst_dist</a>) {</span>
<a name="1215"><font size=-1>1215     </font></a><span class="default">						<a href="dictionary_R.html#17946">result_set</a>.<a href="dictionary_A.html#18011">addPoint</a>(<a href="dictionary_D.html#18010">dist</a>,<a href="dictionary_N.html#17843">vind</a>[<a href="dictionary_I.html#18008">i</a>]);</span>
<a name="1216"><font size=-1>1216     </font></a><span class="default">					}</span>
<a name="1217"><font size=-1>1217     </font></a><span class="default">				}</span>
<a name="1218"><font size=-1>1218     </font></a><span class="default">				</span><span class="keyword">return</span><span class="default">;</span>
<a name="1219"><font size=-1>1219     </font></a><span class="default">			}</span>
<a name="1220"><font size=-1>1220     </font></a><span class="default"></span>
<a name="1221"><font size=-1>1221     </font></a><span class="default">			</span><span class="comment">/* Which child branch should be taken first? */</span>
<a name="1222"><font size=-1>1222     </font></a><span class="comment">			</span><span class="keyword">int <a href="dictionary_I.html#18012">idx</a> </span><span class="default">= <a href="dictionary_N.html#17948">node</a>-&gt;<a href="dictionary_N.html#17861">node_type</a>.<a href="dictionary_S.html#17860">sub</a>.<a href="dictionary_N.html#17857">divfeat</a>;</span>
<a name="1223"><font size=-1>1223     </font></a><span class="default">			<a href="dictionary_N.html#17841">ElementType</a> <a href="dictionary_V.html#18013">val</a> = <a href="dictionary_V.html#17947">vec</a>[<a href="dictionary_I.html#18012">idx</a>];</span>
<a name="1224"><font size=-1>1224     </font></a><span class="default">			<a href="dictionary_N.html#17842">DistanceType</a> <a href="dictionary_D.html#18014">diff1</a> = <a href="dictionary_V.html#18013">val</a> - <a href="dictionary_N.html#17948">node</a>-&gt;<a href="dictionary_N.html#17861">node_type</a>.<a href="dictionary_S.html#17860">sub</a>.<a href="dictionary_N.html#17858">divlow</a>;</span>
<a name="1225"><font size=-1>1225     </font></a><span class="default">			<a href="dictionary_N.html#17842">DistanceType</a> <a href="dictionary_D.html#18015">diff2</a> = <a href="dictionary_V.html#18013">val</a> - <a href="dictionary_N.html#17948">node</a>-&gt;<a href="dictionary_N.html#17861">node_type</a>.<a href="dictionary_S.html#17860">sub</a>.<a href="dictionary_N.html#17859">divhigh</a>;</span>
<a name="1226"><font size=-1>1226     </font></a><span class="default"></span>
<a name="1227"><font size=-1>1227     </font></a><span class="default">			<a href="dictionary_N.html#17864">NodePtr</a> <a href="dictionary_B.html#18016">bestChild</a>;</span>
<a name="1228"><font size=-1>1228     </font></a><span class="default">			<a href="dictionary_N.html#17864">NodePtr</a> <a href="dictionary_O.html#18017">otherChild</a>;</span>
<a name="1229"><font size=-1>1229     </font></a><span class="default">			<a href="dictionary_N.html#17842">DistanceType</a> <a href="dictionary_C.html#18018">cut_dist</a>;</span>
<a name="1230"><font size=-1>1230     </font></a><span class="default">			</span><span class="keyword">if </span><span class="default">((<a href="dictionary_D.html#18014">diff1</a>+<a href="dictionary_D.html#18015">diff2</a>)&lt;</span><span class="number">0</span><span class="default">) {</span>
<a name="1231"><font size=-1>1231     </font></a><span class="default">				<a href="dictionary_B.html#18016">bestChild</a> = <a href="dictionary_N.html#17948">node</a>-&gt;<a href="dictionary_N.html#17862">child1</a>;</span>
<a name="1232"><font size=-1>1232     </font></a><span class="default">				<a href="dictionary_O.html#18017">otherChild</a> = <a href="dictionary_N.html#17948">node</a>-&gt;<a href="dictionary_N.html#17863">child2</a>;</span>
<a name="1233"><font size=-1>1233     </font></a><span class="default">				<a href="dictionary_C.html#18018">cut_dist</a> = <a href="dictionary_N.html#17873">distance</a>.<a href="dictionary_A.html#18005">accum_dist</a>(<a href="dictionary_V.html#18013">val</a>, <a href="dictionary_N.html#17948">node</a>-&gt;<a href="dictionary_N.html#17861">node_type</a>.<a href="dictionary_S.html#17860">sub</a>.<a href="dictionary_N.html#17859">divhigh</a>, <a href="dictionary_I.html#18012">idx</a>);</span>
<a name="1234"><font size=-1>1234     </font></a><span class="default">			}</span>
<a name="1235"><font size=-1>1235     </font></a><span class="default">			</span><span class="keyword">else </span><span class="default">{</span>
<a name="1236"><font size=-1>1236     </font></a><span class="default">				<a href="dictionary_B.html#18016">bestChild</a> = <a href="dictionary_N.html#17948">node</a>-&gt;<a href="dictionary_N.html#17863">child2</a>;</span>
<a name="1237"><font size=-1>1237     </font></a><span class="default">				<a href="dictionary_O.html#18017">otherChild</a> = <a href="dictionary_N.html#17948">node</a>-&gt;<a href="dictionary_N.html#17862">child1</a>;</span>
<a name="1238"><font size=-1>1238     </font></a><span class="default">				<a href="dictionary_C.html#18018">cut_dist</a> = <a href="dictionary_N.html#17873">distance</a>.<a href="dictionary_A.html#18005">accum_dist</a>( <a href="dictionary_V.html#18013">val</a>, <a href="dictionary_N.html#17948">node</a>-&gt;<a href="dictionary_N.html#17861">node_type</a>.<a href="dictionary_S.html#17860">sub</a>.<a href="dictionary_N.html#17858">divlow</a>, <a href="dictionary_I.html#18012">idx</a>);</span>
<a name="1239"><font size=-1>1239     </font></a><span class="default">			}</span>
<a name="1240"><font size=-1>1240     </font></a><span class="default"></span>
<a name="1241"><font size=-1>1241     </font></a><span class="default">			</span><span class="comment">/* Call recursively to search next level down. */</span>
<a name="1242"><font size=-1>1242     </font></a><span class="comment">			<a href="dictionary_N.html#17944">searchLevel</a></span><span class="default">(<a href="dictionary_R.html#17946">result_set</a>, <a href="dictionary_V.html#17947">vec</a>, <a href="dictionary_B.html#18016">bestChild</a>, <a href="dictionary_M.html#17949">mindistsq</a>, <a href="dictionary_D.html#17950">dists</a>, <a href="dictionary_E.html#17951">epsError</a>);</span>
<a name="1243"><font size=-1>1243     </font></a><span class="default"></span>
<a name="1244"><font size=-1>1244     </font></a><span class="default">			<a href="dictionary_N.html#17842">DistanceType</a> <a href="dictionary_D.html#18019">dst</a> = <a href="dictionary_D.html#17950">dists</a>[<a href="dictionary_I.html#18012">idx</a>];</span>
<a name="1245"><font size=-1>1245     </font></a><span class="default">			<a href="dictionary_M.html#17949">mindistsq</a> = <a href="dictionary_M.html#17949">mindistsq</a> + <a href="dictionary_C.html#18018">cut_dist</a> - <a href="dictionary_D.html#18019">dst</a>;</span>
<a name="1246"><font size=-1>1246     </font></a><span class="default">			<a href="dictionary_D.html#17950">dists</a>[<a href="dictionary_I.html#18012">idx</a>] = <a href="dictionary_C.html#18018">cut_dist</a>;</span>
<a name="1247"><font size=-1>1247     </font></a><span class="default">			</span><span class="keyword">if </span><span class="default">(<a href="dictionary_M.html#17949">mindistsq</a>*<a href="dictionary_E.html#17951">epsError</a>&lt;=<a href="dictionary_R.html#17946">result_set</a>.<a href="dictionary_W.html#18007">worstDist</a>()) {</span>
<a name="1248"><font size=-1>1248     </font></a><span class="default">				<a href="dictionary_N.html#17944">searchLevel</a>(<a href="dictionary_R.html#17946">result_set</a>, <a href="dictionary_V.html#17947">vec</a>, <a href="dictionary_O.html#18017">otherChild</a>, <a href="dictionary_M.html#17949">mindistsq</a>, <a href="dictionary_D.html#17950">dists</a>, <a href="dictionary_E.html#17951">epsError</a>);</span>
<a name="1249"><font size=-1>1249     </font></a><span class="default">			}</span>
<a name="1250"><font size=-1>1250     </font></a><span class="default">			<a href="dictionary_D.html#17950">dists</a>[<a href="dictionary_I.html#18012">idx</a>] = <a href="dictionary_D.html#18019">dst</a>;</span>
<a name="1251"><font size=-1>1251     </font></a><span class="default">		}</span>
<a name="1252"><font size=-1>1252     </font></a><span class="default"></span>
<a name="1253"><font size=-1>1253     </font></a><span class="default">	</span><span class="keyword">public</span><span class="default">:</span>
<a name="1254"><font size=-1>1254     </font></a><span class="default">		</span><span class="comment">/**  Stores the index in a binary file.</span>
<a name="1255"><font size=-1>1255     </font></a><span class="comment">		  *   IMPORTANT NOTE: The set of data points is NOT stored in the file, so when loading the index object it must be constructed associated to the same source of data points used while building it.</span>
<a name="1256"><font size=-1>1256     </font></a><span class="comment">		  * See the example: examples/saveload_example.cpp</span>
<a name="1257"><font size=-1>1257     </font></a><span class="comment">		  * \sa loadIndex  */</span>
<a name="1258"><font size=-1>1258     </font></a><span class="comment">		</span><span class="keyword">void <a href="dictionary_N.html#17952">saveIndex</a></span><span class="default">(<a href="dictionary_F.html#2277">FILE</a>* <a href="dictionary_S.html#17953">stream</a>)</span>
<a name="1259"><font size=-1>1259     </font></a><span class="default">		{</span>
<a name="1260"><font size=-1>1260     </font></a><span class="default">			<a href="dictionary_N.html#17608">save_value</a>(<a href="dictionary_S.html#17953">stream</a>, <a href="dictionary_N.html#17847">m_size</a>);</span>
<a name="1261"><font size=-1>1261     </font></a><span class="default">			<a href="dictionary_N.html#17608">save_value</a>(<a href="dictionary_S.html#17953">stream</a>, <a href="dictionary_N.html#17849">dim</a>);</span>
<a name="1262"><font size=-1>1262     </font></a><span class="default">			<a href="dictionary_N.html#17608">save_value</a>(<a href="dictionary_S.html#17953">stream</a>, <a href="dictionary_N.html#17871">root_bbox</a>);</span>
<a name="1263"><font size=-1>1263     </font></a><span class="default">			<a href="dictionary_N.html#17608">save_value</a>(<a href="dictionary_S.html#17953">stream</a>, <a href="dictionary_N.html#17844">m_leaf_max_size</a>);</span>
<a name="1264"><font size=-1>1264     </font></a><span class="default">			<a href="dictionary_N.html#17608">save_value</a>(<a href="dictionary_S.html#17953">stream</a>, <a href="dictionary_N.html#17843">vind</a>);</span>
<a name="1265"><font size=-1>1265     </font></a><span class="default">			<a href="dictionary_N.html#17909">save_tree</a>(<a href="dictionary_S.html#17953">stream</a>, <a href="dictionary_N.html#17870">root_node</a>);</span>
<a name="1266"><font size=-1>1266     </font></a><span class="default">		}</span>
<a name="1267"><font size=-1>1267     </font></a><span class="default"></span>
<a name="1268"><font size=-1>1268     </font></a><span class="default">		</span><span class="comment">/**  Loads a previous index from a binary file.</span>
<a name="1269"><font size=-1>1269     </font></a><span class="comment">		  *   IMPORTANT NOTE: The set of data points is NOT stored in the file, so the index object must be constructed associated to the same source of data points used while building the index.</span>
<a name="1270"><font size=-1>1270     </font></a><span class="comment">		  * See the example: examples/saveload_example.cpp</span>
<a name="1271"><font size=-1>1271     </font></a><span class="comment">		  * \sa loadIndex  */</span>
<a name="1272"><font size=-1>1272     </font></a><span class="comment">		</span><span class="keyword">void <a href="dictionary_N.html#17954">loadIndex</a></span><span class="default">(<a href="dictionary_F.html#2277">FILE</a>* <a href="dictionary_S.html#17955">stream</a>)</span>
<a name="1273"><font size=-1>1273     </font></a><span class="default">		{</span>
<a name="1274"><font size=-1>1274     </font></a><span class="default">			<a href="dictionary_N.html#17619">load_value</a>(<a href="dictionary_S.html#17955">stream</a>, <a href="dictionary_N.html#17847">m_size</a>);</span>
<a name="1275"><font size=-1>1275     </font></a><span class="default">			<a href="dictionary_N.html#17619">load_value</a>(<a href="dictionary_S.html#17955">stream</a>, <a href="dictionary_N.html#17849">dim</a>);</span>
<a name="1276"><font size=-1>1276     </font></a><span class="default">			<a href="dictionary_N.html#17619">load_value</a>(<a href="dictionary_S.html#17955">stream</a>, <a href="dictionary_N.html#17871">root_bbox</a>);</span>
<a name="1277"><font size=-1>1277     </font></a><span class="default">			<a href="dictionary_N.html#17619">load_value</a>(<a href="dictionary_S.html#17955">stream</a>, <a href="dictionary_N.html#17844">m_leaf_max_size</a>);</span>
<a name="1278"><font size=-1>1278     </font></a><span class="default">			<a href="dictionary_N.html#17619">load_value</a>(<a href="dictionary_S.html#17955">stream</a>, <a href="dictionary_N.html#17843">vind</a>);</span>
<a name="1279"><font size=-1>1279     </font></a><span class="default">			<a href="dictionary_N.html#17912">load_tree</a>(<a href="dictionary_S.html#17955">stream</a>, <a href="dictionary_N.html#17870">root_node</a>);</span>
<a name="1280"><font size=-1>1280     </font></a><span class="default">		}</span>
<a name="1281"><font size=-1>1281     </font></a><span class="default"></span>
<a name="1282"><font size=-1>1282     </font></a><span class="default">	};   </span><span class="comment">// class KDTree</span>
<a name="1283"><font size=-1>1283     </font></a><span class="comment"></span>
<a name="1284"><font size=-1>1284     </font></a><span class="comment"></span>
<a name="1285"><font size=-1>1285     </font></a><span class="comment">	/** An L2-metric KD-tree adaptor for working with data directly stored in an Eigen Matrix, without duplicating the data storage.</span>
<a name="1286"><font size=-1>1286     </font></a><span class="comment">	  *  Each row in the matrix represents a point in the state space.</span>
<a name="1287"><font size=-1>1287     </font></a><span class="comment">	  *</span>
<a name="1288"><font size=-1>1288     </font></a><span class="comment">	  *  Example of usage:</span>
<a name="1289"><font size=-1>1289     </font></a><span class="comment">	  * \code</span>
<a name="1290"><font size=-1>1290     </font></a><span class="comment">	  * 	Eigen::Matrix&lt;num_t,Dynamic,Dynamic&gt;  mat;</span>
<a name="1291"><font size=-1>1291     </font></a><span class="comment">	  * 	// Fill out &quot;mat&quot;...</span>
<a name="1292"><font size=-1>1292     </font></a><span class="comment">	  *</span>
<a name="1293"><font size=-1>1293     </font></a><span class="comment">	  * 	typedef KDTreeEigenMatrixAdaptor&lt; Eigen::Matrix&lt;num_t,Dynamic,Dynamic&gt; &gt;  my_kd_tree_t;</span>
<a name="1294"><font size=-1>1294     </font></a><span class="comment">	  * 	const int max_leaf = 10;</span>
<a name="1295"><font size=-1>1295     </font></a><span class="comment">	  * 	my_kd_tree_t   mat_index(dimdim, mat, max_leaf );</span>
<a name="1296"><font size=-1>1296     </font></a><span class="comment">	  * 	mat_index.index-&gt;buildIndex();</span>
<a name="1297"><font size=-1>1297     </font></a><span class="comment">	  * 	mat_index.index-&gt;...</span>
<a name="1298"><font size=-1>1298     </font></a><span class="comment">	  * \endcode</span>
<a name="1299"><font size=-1>1299     </font></a><span class="comment">	  *</span>
<a name="1300"><font size=-1>1300     </font></a><span class="comment">	  *  \tparam DIM If set to &gt;0, it specifies a compile-time fixed dimensionality for the points in the data set, allowing more compiler optimizations.</span>
<a name="1301"><font size=-1>1301     </font></a><span class="comment">	  *  \tparam Distance The distance metric to use: nanoflann::metric_L1, nanoflann::metric_L2, nanoflann::metric_L2_Simple, etc.</span>
<a name="1302"><font size=-1>1302     </font></a><span class="comment">	  */</span>
<a name="1303"><font size=-1>1303     </font></a><span class="comment">	</span><span class="keyword">template </span><span class="default">&lt;</span><span class="keyword">class <a href="dictionary_N.html#18021">MatrixType</a></span><span class="default">, </span><span class="keyword">int <a href="dictionary_N.html#18022">DIM</a> </span><span class="default">= -</span><span class="number">1</span><span class="default">, </span><span class="keyword">class <a href="dictionary_N.html#18023">Distance</a> </span><span class="default">= nanoflann::metric_L2&gt;</span>
<a name="1304"><font size=-1>1304     </font></a><span class="default">	</span><span class="keyword">struct <a href="dictionary_N.html#18020">KDTreeEigenMatrixAdaptor</a></span>
<a name="1305"><font size=-1>1305     </font></a><span class="keyword">	</span><span class="default">{</span>
<a name="1306"><font size=-1>1306     </font></a><span class="default">		</span><span class="keyword">typedef <a href="dictionary_N.html#18020">KDTreeEigenMatrixAdaptor</a></span><span class="default">&lt;MatrixType,DIM,Distance&gt; <a href="dictionary_N.html#18024">self_t</a>;</span>
<a name="1307"><font size=-1>1307     </font></a><span class="default">		</span><span class="keyword">typedef typename <a href="dictionary_N.html#18021">MatrixType</a></span><span class="default">::<a href="dictionary_M.html#3522">Scalar</a>              <a href="dictionary_N.html#18025">num_t</a>;</span>
<a name="1308"><font size=-1>1308     </font></a><span class="default">		</span><span class="keyword">typedef typename <a href="dictionary_N.html#18021">MatrixType</a></span><span class="default">::<a href="dictionary_C.html#15607">Index</a> <a href="dictionary_N.html#18027">IndexType</a>;</span>
<a name="1309"><font size=-1>1309     </font></a><span class="default">		</span><span class="keyword">typedef typename </span><span class="default">Distance::</span><span class="keyword">template <a href="dictionary_T.html#18029">traits</a></span><span class="default">&lt;num_t,self_t&gt;::<a href="dictionary_T.html#18030">distance_t</a> metric_t;</span>
<a name="1310"><font size=-1>1310     </font></a><span class="default">		</span><span class="keyword">typedef <a href="dictionary_N.html#17835">KDTreeSingleIndexAdaptor</a></span><span class="default">&lt; metric_t,self_t,DIM,IndexType&gt;  <a href="dictionary_N.html#18032">index_t</a>;</span>
<a name="1311"><font size=-1>1311     </font></a><span class="default"></span>
<a name="1312"><font size=-1>1312     </font></a><span class="default">		<a href="dictionary_N.html#18032">index_t</a>* <a href="dictionary_N.html#18033">index</a>; </span><span class="comment">//! The kd-tree index for the user to call its methods as usual with any other FLANN index.</span>
<a name="1313"><font size=-1>1313     </font></a><span class="comment"></span>
<a name="1314"><font size=-1>1314     </font></a><span class="comment">		/// Constructor: takes a const ref to the matrix object with the data points</span>
<a name="1315"><font size=-1>1315     </font></a><span class="comment">		<a href="dictionary_N.html#18034">KDTreeEigenMatrixAdaptor</a></span><span class="default">(</span><span class="keyword">const int <a href="dictionary_D.html#18035">dimensionality</a></span><span class="default">, </span><span class="keyword">const <a href="dictionary_N.html#18021">MatrixType</a> </span><span class="default">&amp;<a href="dictionary_M.html#18036">mat</a>, </span><span class="keyword">const int <a href="dictionary_L.html#18037">leaf_max_size</a> </span><span class="default">= </span><span class="number">10</span><span class="default">) : <a href="dictionary_N.html#18040">m_data_matrix</a>(<a href="dictionary_M.html#18036">mat</a>)</span>
<a name="1316"><font size=-1>1316     </font></a><span class="default">		{</span>
<a name="1317"><font size=-1>1317     </font></a><span class="default">			</span><span class="keyword">const <a href="dictionary_N.html#18027">IndexType</a> <a href="dictionary_D.html#18060">dims</a> </span><span class="default">= <a href="dictionary_M.html#18036">mat</a>.<a href="dictionary_C.html#10259">cols</a>();</span>
<a name="1318"><font size=-1>1318     </font></a><span class="default">			</span><span class="keyword">if </span><span class="default">(<a href="dictionary_D.html#18060">dims</a>!=<a href="dictionary_D.html#18035">dimensionality</a>) </span><span class="keyword">throw </span><span class="default">std::<a href="dictionary_S.html#713">runtime_error</a>(</span><span class="string">&quot;Error: 'dimensionality' must match column count in data matrix&quot;</span><span class="default">);</span>
<a name="1319"><font size=-1>1319     </font></a><span class="default">			</span><span class="keyword">if </span><span class="default">(<a href="dictionary_N.html#18022">DIM</a>&gt;</span><span class="number">0 </span><span class="default">&amp;&amp; </span><span class="keyword">static_cast</span><span class="default">&lt;</span><span class="keyword">int</span><span class="default">&gt;(<a href="dictionary_D.html#18060">dims</a>)!=<a href="dictionary_N.html#18022">DIM</a>)</span>
<a name="1320"><font size=-1>1320     </font></a><span class="default">				</span><span class="keyword">throw </span><span class="default">std::<a href="dictionary_S.html#713">runtime_error</a>(</span><span class="string">&quot;Data set dimensionality does not match the 'DIM' template argument&quot;</span><span class="default">);</span>
<a name="1321"><font size=-1>1321     </font></a><span class="default">			<a href="dictionary_N.html#18033">index</a> = </span><span class="keyword">new <a href="dictionary_N.html#18032">index_t</a></span><span class="default">( <a href="dictionary_D.html#18060">dims</a>, *</span><span class="keyword">this </span><span class="comment">/* adaptor */</span><span class="default">, nanoflann::<a href="dictionary_N.html#17726">KDTreeSingleIndexAdaptorParams</a>(<a href="dictionary_L.html#18037">leaf_max_size</a> ) );</span>
<a name="1322"><font size=-1>1322     </font></a><span class="default">			<a href="dictionary_N.html#18033">index</a>-&gt;<a href="dictionary_N.html#17880">buildIndex</a>();</span>
<a name="1323"><font size=-1>1323     </font></a><span class="default">		}</span>
<a name="1324"><font size=-1>1324     </font></a><span class="default">	</span><span class="keyword">private</span><span class="default">:</span>
<a name="1325"><font size=-1>1325     </font></a><span class="default">		</span><span class="comment">/** Hidden copy constructor, to disallow copying this class (Not implemented) */</span>
<a name="1326"><font size=-1>1326     </font></a><span class="comment">		<a href="dictionary_N.html#18038">KDTreeEigenMatrixAdaptor</a></span><span class="default">(</span><span class="keyword">const <a href="dictionary_N.html#18024">self_t</a></span><span class="default">&amp;);</span>
<a name="1327"><font size=-1>1327     </font></a><span class="default">	</span><span class="keyword">public</span><span class="default">:</span>
<a name="1328"><font size=-1>1328     </font></a><span class="default"></span>
<a name="1329"><font size=-1>1329     </font></a><span class="default">		~<a href="dictionary_N.html#18039">KDTreeEigenMatrixAdaptor</a>() {</span>
<a name="1330"><font size=-1>1330     </font></a><span class="default">			</span><span class="keyword">delete <a href="dictionary_N.html#18033">index</a></span><span class="default">;</span>
<a name="1331"><font size=-1>1331     </font></a><span class="default">		}</span>
<a name="1332"><font size=-1>1332     </font></a><span class="default"></span>
<a name="1333"><font size=-1>1333     </font></a><span class="default">		</span><span class="keyword">const <a href="dictionary_N.html#18021">MatrixType</a> </span><span class="default">&amp;<a href="dictionary_N.html#18040">m_data_matrix</a>;</span>
<a name="1334"><font size=-1>1334     </font></a><span class="default"></span>
<a name="1335"><font size=-1>1335     </font></a><span class="default">		</span><span class="comment">/** Query for the \a num_closest closest points to a given point (entered as query_point[0:dim-1]).</span>
<a name="1336"><font size=-1>1336     </font></a><span class="comment">		  *  Note that this is a short-cut method for index-&gt;findNeighbors().</span>
<a name="1337"><font size=-1>1337     </font></a><span class="comment">		  *  The user can also call index-&gt;... methods as desired.</span>
<a name="1338"><font size=-1>1338     </font></a><span class="comment">		  * \note nChecks_IGNORED is ignored but kept for compatibility with the original FLANN interface.</span>
<a name="1339"><font size=-1>1339     </font></a><span class="comment">		  */</span>
<a name="1340"><font size=-1>1340     </font></a><span class="comment">		</span><span class="keyword">inline void <a href="dictionary_N.html#18041">query</a></span><span class="default">(</span><span class="keyword">const <a href="dictionary_N.html#18025">num_t</a> </span><span class="default">*<a href="dictionary_Q.html#18042">query_point</a>, </span><span class="keyword">const <a href="dictionary_S.html#56">size_t</a> <a href="dictionary_N.html#18043">num_closest</a></span><span class="default">, <a href="dictionary_N.html#18027">IndexType</a> *<a href="dictionary_O.html#18044">out_indices</a>, <a href="dictionary_N.html#18025">num_t</a> *<a href="dictionary_O.html#18045">out_distances_sq</a>, </span><span class="keyword">const int </span><span class="comment">/* nChecks_IGNORED */ </span><span class="default">= </span><span class="number">10</span><span class="default">) </span><span class="keyword">const</span>
<a name="1341"><font size=-1>1341     </font></a><span class="keyword">		</span><span class="default">{</span>
<a name="1342"><font size=-1>1342     </font></a><span class="default">			nanoflann::<a href="dictionary_N.html#17566">KNNResultSet</a>&lt;num_t,IndexType&gt; <a href="dictionary_R.html#18061">resultSet</a>(<a href="dictionary_N.html#18043">num_closest</a>);</span>
<a name="1343"><font size=-1>1343     </font></a><span class="default">			<a href="dictionary_R.html#18061">resultSet</a>.<a href="dictionary_N.html#17568">init</a>(<a href="dictionary_O.html#18044">out_indices</a>, <a href="dictionary_O.html#18045">out_distances_sq</a>);</span>
<a name="1344"><font size=-1>1344     </font></a><span class="default">			<a href="dictionary_N.html#18033">index</a>-&gt;<a href="dictionary_N.html#17884">findNeighbors</a>(<a href="dictionary_R.html#18061">resultSet</a>, <a href="dictionary_Q.html#18042">query_point</a>, nanoflann::<a href="dictionary_N.html#17730">SearchParams</a>());</span>
<a name="1345"><font size=-1>1345     </font></a><span class="default">		}</span>
<a name="1346"><font size=-1>1346     </font></a><span class="default"></span>
<a name="1347"><font size=-1>1347     </font></a><span class="default">		</span><span class="comment">/** @name Interface expected by KDTreeSingleIndexAdaptor</span>
<a name="1348"><font size=-1>1348     </font></a><span class="comment">		  * @{ */</span>
<a name="1349"><font size=-1>1349     </font></a><span class="comment"></span>
<a name="1350"><font size=-1>1350     </font></a><span class="comment">		</span><span class="keyword">const <a href="dictionary_N.html#18024">self_t</a> </span><span class="default">&amp; <a href="dictionary_N.html#18047">derived</a>() </span><span class="keyword">const </span><span class="default">{</span>
<a name="1351"><font size=-1>1351     </font></a><span class="default">			</span><span class="keyword">return </span><span class="default">*</span><span class="keyword">this</span><span class="default">;</span>
<a name="1352"><font size=-1>1352     </font></a><span class="default">		}</span>
<a name="1353"><font size=-1>1353     </font></a><span class="default">		<a href="dictionary_N.html#18024">self_t</a> &amp; <a href="dictionary_N.html#18048">derived</a>()       {</span>
<a name="1354"><font size=-1>1354     </font></a><span class="default">			</span><span class="keyword">return </span><span class="default">*</span><span class="keyword">this</span><span class="default">;</span>
<a name="1355"><font size=-1>1355     </font></a><span class="default">		}</span>
<a name="1356"><font size=-1>1356     </font></a><span class="default"></span>
<a name="1357"><font size=-1>1357     </font></a><span class="default">		</span><span class="comment">// Must return the number of data points</span>
<a name="1358"><font size=-1>1358     </font></a><span class="comment">		</span><span class="keyword">inline <a href="dictionary_S.html#56">size_t</a> <a href="dictionary_N.html#18049">kdtree_get_point_count</a></span><span class="default">() </span><span class="keyword">const </span><span class="default">{</span>
<a name="1359"><font size=-1>1359     </font></a><span class="default">			</span><span class="keyword">return <a href="dictionary_N.html#18040">m_data_matrix</a></span><span class="default">.<a href="dictionary_R.html#10258">rows</a>();</span>
<a name="1360"><font size=-1>1360     </font></a><span class="default">		}</span>
<a name="1361"><font size=-1>1361     </font></a><span class="default"></span>
<a name="1362"><font size=-1>1362     </font></a><span class="default">		</span><span class="comment">// Returns the L2 distance between the vector &quot;p1[0:size-1]&quot; and the data point with index &quot;idx_p2&quot; stored in the class:</span>
<a name="1363"><font size=-1>1363     </font></a><span class="comment">		</span><span class="keyword">inline <a href="dictionary_N.html#18025">num_t</a> <a href="dictionary_N.html#18050">kdtree_distance</a></span><span class="default">(</span><span class="keyword">const <a href="dictionary_N.html#18025">num_t</a> </span><span class="default">*<a href="dictionary_P.html#18051">p1</a>, </span><span class="keyword">const <a href="dictionary_N.html#18027">IndexType</a> <a href="dictionary_I.html#18052">idx_p2</a></span><span class="default">,<a href="dictionary_N.html#18027">IndexType</a> <a href="dictionary_S.html#18053">size</a>) </span><span class="keyword">const</span>
<a name="1364"><font size=-1>1364     </font></a><span class="keyword">		</span><span class="default">{</span>
<a name="1365"><font size=-1>1365     </font></a><span class="default">			<a href="dictionary_N.html#18025">num_t</a> <a href="dictionary_S.html#18062">s</a>=</span><span class="number">0</span><span class="default">;</span>
<a name="1366"><font size=-1>1366     </font></a><span class="default">			</span><span class="keyword">for </span><span class="default">(<a href="dictionary_N.html#18027">IndexType</a> <a href="dictionary_I.html#18063">i</a>=</span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#18063">i</a>&lt;<a href="dictionary_S.html#18053">size</a>; <a href="dictionary_I.html#18063">i</a>++) {</span>
<a name="1367"><font size=-1>1367     </font></a><span class="default">				</span><span class="keyword">const <a href="dictionary_N.html#18025">num_t</a> <a href="dictionary_D.html#18064">d</a></span><span class="default">= <a href="dictionary_P.html#18051">p1</a>[<a href="dictionary_I.html#18063">i</a>]-<a href="dictionary_N.html#18040">m_data_matrix</a>.<a href="dictionary_C.html#10122">coeff</a>(<a href="dictionary_I.html#18052">idx_p2</a>,<a href="dictionary_I.html#18063">i</a>);</span>
<a name="1368"><font size=-1>1368     </font></a><span class="default">				<a href="dictionary_S.html#18062">s</a>+=<a href="dictionary_D.html#18064">d</a>*<a href="dictionary_D.html#18064">d</a>;</span>
<a name="1369"><font size=-1>1369     </font></a><span class="default">			}</span>
<a name="1370"><font size=-1>1370     </font></a><span class="default">			</span><span class="keyword">return <a href="dictionary_S.html#18062">s</a></span><span class="default">;</span>
<a name="1371"><font size=-1>1371     </font></a><span class="default">		}</span>
<a name="1372"><font size=-1>1372     </font></a><span class="default"></span>
<a name="1373"><font size=-1>1373     </font></a><span class="default">		</span><span class="comment">// Returns the dim'th component of the idx'th point in the class:</span>
<a name="1374"><font size=-1>1374     </font></a><span class="comment">		</span><span class="keyword">inline <a href="dictionary_N.html#18025">num_t</a> <a href="dictionary_N.html#18054">kdtree_get_pt</a></span><span class="default">(</span><span class="keyword">const <a href="dictionary_N.html#18027">IndexType</a> <a href="dictionary_I.html#18055">idx</a></span><span class="default">, </span><span class="keyword">int <a href="dictionary_D.html#18056">dim</a></span><span class="default">) </span><span class="keyword">const </span><span class="default">{</span>
<a name="1375"><font size=-1>1375     </font></a><span class="default">			</span><span class="keyword">return <a href="dictionary_N.html#18040">m_data_matrix</a></span><span class="default">.<a href="dictionary_C.html#10122">coeff</a>(<a href="dictionary_I.html#18055">idx</a>,<a href="dictionary_N.html#18027">IndexType</a>(<a href="dictionary_D.html#18056">dim</a>));</span>
<a name="1376"><font size=-1>1376     </font></a><span class="default">		}</span>
<a name="1377"><font size=-1>1377     </font></a><span class="default"></span>
<a name="1378"><font size=-1>1378     </font></a><span class="default">		</span><span class="comment">// Optional bounding-box computation: return false to default to a standard bbox computation loop.</span>
<a name="1379"><font size=-1>1379     </font></a><span class="comment">		//   Return true if the BBOX was already computed by the class and returned in &quot;bb&quot; so it can be avoided to redo it again.</span>
<a name="1380"><font size=-1>1380     </font></a><span class="comment">		//   Look at bb.size() to find out the expected dimensionality (e.g. 2 or 3 for point clouds)</span>
<a name="1381"><font size=-1>1381     </font></a><span class="comment">		</span><span class="keyword">template </span><span class="default">&lt;</span><span class="keyword">class <a href="dictionary_B.html#18058">BBOX</a></span><span class="default">&gt;</span>
<a name="1382"><font size=-1>1382     </font></a><span class="default">		</span><span class="keyword">bool <a href="dictionary_N.html#18057">kdtree_get_bbox</a></span><span class="default">(<a href="dictionary_B.html#18058">BBOX</a>&amp; </span><span class="comment">/*bb*/</span><span class="default">) </span><span class="keyword">const </span><span class="default">{</span>
<a name="1383"><font size=-1>1383     </font></a><span class="default">			</span><span class="keyword">return false</span><span class="default">;</span>
<a name="1384"><font size=-1>1384     </font></a><span class="default">		}</span>
<a name="1385"><font size=-1>1385     </font></a><span class="default"></span>
<a name="1386"><font size=-1>1386     </font></a><span class="default">		</span><span class="comment">/** @} */</span>
<a name="1387"><font size=-1>1387     </font></a><span class="comment"></span>
<a name="1388"><font size=-1>1388     </font></a><span class="comment">	</span><span class="default">}; </span><span class="comment">// end of KDTreeEigenMatrixAdaptor</span>
<a name="1389"><font size=-1>1389     </font></a><span class="comment">	/** @} */</span>
<a name="1390"><font size=-1>1390     </font></a><span class="comment"></span>
<a name="1391"><font size=-1>1391     </font></a><span class="comment">/** @} */ // end of grouping</span>
<a name="1392"><font size=-1>1392     </font></a><span class="comment"></span><span class="default">} </span><span class="comment">// end of NS</span>
<a name="1393"><font size=-1>1393     </font></a><span class="comment"></span>
<a name="1394"><font size=-1>1394     </font></a><span class="comment"></span>
<a name="1395"><font size=-1>1395     </font></a><span class="comment"></span><span class="preproc">#endif </span><span class="comment">/* NANOFLANN_HPP_ */</span>
<a name="1396"><font size=-1>1396     </font></a><span class="comment"></span>
</pre></body></html>
